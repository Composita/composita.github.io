!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=21)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return I})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"p",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"m",(function(){return y})),n.d(t,"f",(function(){return b})),n.d(t,"q",(function(){return k})),n.d(t,"i",(function(){return w})),n.d(t,"k",(function(){return E})),n.d(t,"j",(function(){return O})),n.d(t,"n",(function(){return x})),n.d(t,"g",(function(){return j})),n.d(t,"l",(function(){return C})),n.d(t,"o",(function(){return S}));var i,r=n(0);!function(e){e[e.Tag=0]="Tag"}(i||(i={}));var a,s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r.a)(this,e),this._integerDescriptorTag=i.Tag,this.initialValue=Math.trunc(t)};!function(e){e[e.Tag=0]="Tag"}(a||(a={}));var o,c=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r.a)(this,e),this._floatDescriptorTag=a.Tag,this.initialValue=t};!function(e){e[e.Tag=0]="Tag"}(o||(o={}));var u,l=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(r.a)(this,e),this._TextDescriptorTag=o.Tag,this.initialValue=t};!function(e){e[e.Tag=0]="Tag"}(u||(u={}));var h,f=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(Object(r.a)(this,e),this._characterDescriptorTag=u.Tag,t.length>1)throw new Error("CharacterDescriptor initialValue lenght > 1");this.initialValue=t};!function(e){e[e.Tag=0]="Tag"}(h||(h={}));var v,p=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(r.a)(this,e),this._booleanDescriptorTag=h.Tag,this.initialValue=t},g=n(7),d=function e(){Object(r.a)(this,e),this.init=new T,this.variables=new Array,this.procedures=new Array,this.components=new Array},m=function e(t){Object(r.a)(this,e),this.identifier=t,this.offers=new Array,this.requires=new Array,this.declarations=new d,this.implementations=new Array,this.begin=new T,this.activity=new T,this.finally=new T},y=function e(t,n){Object(r.a)(this,e),this.identifier=t,this.returnType=n,this.parameters=new Array,this.declarations=new d,this.begin=new T},b=function e(t){Object(r.a)(this,e),this.reference=t,this.declarations=new d,this.begin=new T},k=function e(t,n,i){Object(r.a)(this,e),this.identifier=t,this.type=n,this.mutable=i,this.indexTypes=new Array},T=function e(){Object(r.a)(this,e),this.instructions=new Array},w=function e(t){Object(r.a)(this,e),this.identifier=t,this.protocols=new Array},E=function e(t){Object(r.a)(this,e),this.identifier=t,this.data=new Array},O=function e(t){Object(r.a)(this,e),this.offset=t},x=function e(t){Object(r.a)(this,e),this.systemCall=t;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this.arguments=Object(g.a)(Array,i)};!function(e){e[e.Once=0]="Once",e[e.Optional=1]="Optional",e[e.Repeating=2]="Repeating"}(v||(v={}));var C,S,j=function e(t){Object(r.a)(this,e),this.code=t;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this.arguments=Object(g.a)(Array,i)};!function(e){e[e.Add=0]="Add",e[e.Subtract=1]="Subtract",e[e.Multiply=2]="Multiply",e[e.Divide=3]="Divide",e[e.Negate=4]="Negate",e[e.Modulo=5]="Modulo",e[e.Equal=6]="Equal",e[e.Less=7]="Less",e[e.LessEqual=8]="LessEqual",e[e.Greater=9]="Greater",e[e.GreaterEqual=10]="GreaterEqual",e[e.NotEqual=11]="NotEqual",e[e.Not=12]="Not",e[e.LogicOr=13]="LogicOr",e[e.LogicAnd=14]="LogicAnd",e[e.New=15]="New",e[e.Delete=16]="Delete",e[e.Send=17]="Send",e[e.Receive=18]="Receive",e[e.Connect=19]="Connect",e[e.Disconnect=20]="Disconnect",e[e.ReceiveTest=21]="ReceiveTest",e[e.InputTest=22]="InputTest",e[e.SystemCall=23]="SystemCall",e[e.ProcedureCall=24]="ProcedureCall",e[e.Return=25]="Return",e[e.LoadConstantBoolean=26]="LoadConstantBoolean",e[e.LoadConstantText=27]="LoadConstantText",e[e.LoadConstantCharacter=28]="LoadConstantCharacter",e[e.LoadConstantFloat=29]="LoadConstantFloat",e[e.LoadConstantInteger=30]="LoadConstantInteger",e[e.Move=31]="Move",e[e.StoreVariable=32]="StoreVariable",e[e.LoadVariable=33]="LoadVariable",e[e.LoadService=34]="LoadService",e[e.LoadThis=35]="LoadThis",e[e.AcquireShared=36]="AcquireShared",e[e.ReleaseShared=37]="ReleaseShared",e[e.AcquireExclusive=38]="AcquireExclusive",e[e.ReleaseExclusive=39]="ReleaseExclusive",e[e.Branch=40]="Branch",e[e.BranchTrue=41]="BranchTrue",e[e.BranchFalse=42]="BranchFalse",e[e.IsType=43]="IsType",e[e.ExistsTest=44]="ExistsTest"}(C||(C={})),function(e){e[e.Write=0]="Write",e[e.WriteLine=1]="WriteLine",e[e.WriteHex=2]="WriteHex",e[e.Assert=3]="Assert",e[e.Halt=4]="Halt",e[e.Inc=5]="Inc",e[e.Dec=6]="Dec",e[e.Passivate=7]="Passivate",e[e.Count=8]="Count",e[e.Length=9]="Length",e[e.Sqrt=10]="Sqrt",e[e.Sin=11]="Sin",e[e.Cos=12]="Cos",e[e.Tan=13]="Tan",e[e.ArcSin=14]="ArcSin",e[e.ArcCos=15]="ArcCos",e[e.ArcTan=16]="ArcTan",e[e.Random=17]="Random",e[e.Min=18]="Min",e[e.Max=19]="Max",e[e.ToCharacter=20]="ToCharacter",e[e.ToInteger=21]="ToInteger",e[e.ToReal=22]="ToReal",e[e.ToText=23]="ToText",e[e.LoadForEachDesignators=24]="LoadForEachDesignators"}(S||(S={}));var I=function e(){Object(r.a)(this,e),this.entryPoints=new Array,this.components=new Array,this.interfaces=new Array}},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return d})),n.d(t,"e",(function(){return y})),n.d(t,"m",(function(){return b})),n.d(t,"j",(function(){return k})),n.d(t,"h",(function(){return T})),n.d(t,"p",(function(){return w})),n.d(t,"a",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"g",(function(){return j})),n.d(t,"f",(function(){return L})),n.d(t,"n",(function(){return P})),n.d(t,"c",(function(){return N})),n.d(t,"b",(function(){return R}));var i,r,a=n(4),s=n(5),o=n(3),c=n(0);!function(e){e[e.Init=0]="Init",e[e.Begin=1]="Begin",e[e.Activity=2]="Activity",e[e.Finally=3]="Finally",e[e.Procedure=4]="Procedure"}(i||(i={})),function(e){e[e.Tag=0]="Tag"}(r||(r={}));var u,l=function e(t,n){Object(c.a)(this,e),this.address=t,this.type=n,this._componentPointerTag=r.Tag};!function(e){e[e.Tag=0]="Tag"}(u||(u={}));var h,f=function e(t,n){Object(c.a)(this,e),this.address=t,this.type=n,this._servicePointerTag=u.Tag};!function(e){e[e.Tag=0]="Tag"}(h||(h={}));var v,p=function e(t,n){Object(c.a)(this,e),this.address=t,this.type=n,this._procedurePointerTag=h.Tag};!function(e){e[e.Tag=0]="Tag"}(v||(v={}));var g,d=function e(){Object(c.a)(this,e),this._rootPointerTag=v.Tag},m=function(){function e(t,n){Object(c.a)(this,e),this.declarations=t,this.parent=n,this.variables=new Array,this.procedures=new Array,this.done=!1,this.activeCode=i.Init,this.lastActiveCode=i.Init,this.instructionPointer=new Map([[i.Init,0],[i.Begin,0],[i.Activity,0],[i.Finally,0],[i.Procedure,0]])}return Object(o.a)(e,[{key:"fetch",value:function(){var e;if(this.updateActiveSection(),!this.isDone())switch(this.activeCode){case i.Init:return this.declarations.init.instructions[this.loadAndAdvanceIP()];case i.Procedure:return null===(e=this.procedures[this.loadIP()])||void 0===e?void 0:e.fetch();default:return this.fetchNext()}}},{key:"jump",value:function(e){if(!this.isDone()){var t=this.instructionPointer.get(this.activeCode)+e.offset;if(t<0)throw new Error("Invalid jump.");this.instructionPointer.set(this.activeCode,t)}}},{key:"call",value:function(e,t){var n,r=this;if(t.length!==e.parameters.length)throw new Error("Procedurecall: Number of parameters do not match.");if(this.activeCode===i.Procedure)return null===(n=this.procedures[this.activeCode])||void 0===n||n.call(e,t),!1;this.lastActiveCode=this.activeCode,this.activeCode=i.Procedure;var a=this.procedures.findIndex((function(t){return t.descriptor===e}));if(-1===a)throw new Error("Unkonwn procedure, hierarchical calls are not yet supported.");return this.instructionPointer.set(this.activeCode,a),t.forEach((function(t,n){if(void 0!==t){var i=e.parameters[n],s=new w(i,t);s.fixAccessModifier(),r.procedures[a].parameters.push(s)}})),!0}},{key:"procedureReturned",value:function(){var e;if(this.activeCode!==i.Procedure)throw new Error("Return is only supported in a procedure.");null===(e=this.procedures[this.loadIP()])||void 0===e||e.markReturned()}},{key:"currentState",value:function(){return this.activeCode}},{key:"finalize",value:function(){this.lastActiveCode===i.Finally&&this.activeCode===i.Procedure||(this.lastActiveCode=this.activeCode,this.activeCode=i.Finally)}},{key:"isDone",value:function(){return this.done}},{key:"loadIP",value:function(){return this.instructionPointer.get(this.activeCode)}},{key:"loadAndAdvanceIP",value:function(){var e=this.loadIP();return this.activeCode!==i.Procedure&&this.instructionPointer.set(this.activeCode,e+1),e}},{key:"updateActiveSection",value:function(){if(!this.isDone()&&this.activeDone()&&this.isReady())return this.activeCode===i.Init?(this.lastActiveCode=this.activeCode,this.activeCode=i.Begin,this.variables.forEach((function(e){e instanceof w&&e.fixAccessModifier()})),void this.updateActiveSection()):this.activeCode===i.Begin?(this.lastActiveCode=this.activeCode,this.activeCode=i.Activity,void this.updateActiveSection()):this.activeCode===i.Activity?(this.lastActiveCode=this.activeCode,this.activeCode=i.Finally,void this.updateActiveSection()):this.activeCode===i.Procedure?(this.activeCode=this.lastActiveCode,this.lastActiveCode=i.Procedure,void this.updateActiveSection()):this.activeCode===i.Finally?(this.lastActiveCode=this.activeCode,void(this.done=!0)):void 0}},{key:"activeDone",value:function(){var e=this.loadIP();return this.initActive()?e>=this.declarations.init.instructions.length:this.procedureActive()?void 0===this.procedures[e]||this.procedures[e].isDone():this.activeCodeDone()}},{key:"initActive",value:function(){return this.activeCode===i.Init}},{key:"procedureActive",value:function(){return this.activeCode===i.Procedure}},{key:"resetActive",value:function(){this.done=!1,this.activeCode=i.Init,this.lastActiveCode=i.Init,this.instructionPointer=new Map([[i.Init,0],[i.Begin,0],[i.Activity,0],[i.Finally,0],[i.Procedure,0]])}}]),e}(),y=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e,i){var r;return Object(c.a)(this,n),(r=t.call(this,e.declarations,i)).descriptor=e,r.offerConnections=new Map,r.requiredConnections=new Map,e.offers.forEach((function(e){return r.offerConnections.set(e,[])})),e.requires.forEach((function(e){return r.requiredConnections.set(e,[])})),r}return Object(o.a)(n,[{key:"fetchNext",value:function(){switch(this.activeCode){case i.Begin:return this.loadIP()<this.descriptor.begin.instructions.length?this.descriptor.begin.instructions[this.loadAndAdvanceIP()]:void 0;case i.Activity:return this.loadIP()<this.descriptor.activity.instructions.length?this.descriptor.activity.instructions[this.loadAndAdvanceIP()]:void 0;case i.Finally:return this.descriptor.finally.instructions[this.loadAndAdvanceIP()];default:return}}},{key:"isReady",value:function(){var e=!0;return this.requiredConnections.forEach((function(t){e=e&&t.length>0})),e}},{key:"activeCodeDone",value:function(){var e=this.loadIP();switch(this.activeCode){case i.Begin:return e>=this.descriptor.begin.instructions.length;case i.Activity:return e>=this.descriptor.activity.instructions.length;case i.Finally:return e>=this.descriptor.finally.instructions.length;default:return!0}}}]),n}(m),b=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e,i){var r;return Object(c.a)(this,n),(r=t.call(this,e.declarations,i)).descriptor=e,r.messageQueue=new Array,r}return Object(o.a)(n,[{key:"isReady",value:function(){return!0}},{key:"fetchNext",value:function(){switch(this.activeCode){case i.Begin:return this.descriptor.begin.instructions[this.loadAndAdvanceIP()];default:return}}},{key:"activeCodeDone",value:function(){var e=this.loadIP();switch(this.activeCode){case i.Begin:return this.descriptor.begin.instructions.length<=e;default:return!0}}}]),n}(m),k=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e,i){var r;return Object(c.a)(this,n),(r=t.call(this,e.declarations,i)).descriptor=e,r.hasReturned=!1,r.parameters=new Array,r}return Object(o.a)(n,[{key:"isReady",value:function(){return!0}},{key:"findConnectedService",value:function(){}},{key:"markReturned",value:function(){var e;return this.activeCode===i.Procedure?(null!==(e=this.procedures[this.loadIP()])&&void 0!==e&&e.markReturned()&&(this.activeCode=this.lastActiveCode,this.lastActiveCode=i.Procedure),!1):(this.resetActive(),this.parameters=new Array,!0)}},{key:"fetchNext",value:function(){switch(this.activeCode){case i.Begin:return this.descriptor.begin.instructions[this.loadAndAdvanceIP()];default:return}}},{key:"activeCodeDone",value:function(){var e=this.loadIP();switch(this.activeCode){case i.Begin:return!this.hasReturned&&this.descriptor.begin.instructions.length<=e;default:return!0}}}]),n}(m),T=function e(t){Object(c.a)(this,e),this.descriptor=t,this.fields=new Array},w=function(){function e(t,n){Object(c.a)(this,e),this.descriptor=t,this.value=n,this.mutable=!0}return Object(o.a)(e,[{key:"isMutabled",value:function(){return this.mutable}},{key:"fixAccessModifier",value:function(){this.mutable=this.descriptor.mutable}}]),e}();!function(e){e[e.Tag=0]="Tag"}(g||(g={}));var E,O=function e(t,n){Object(c.a)(this,e),this.descriptor=t,this.value=n,this._arrayVariableTag=g.Tag};!function(e){e[e.Tag=0]="Tag"}(E||(E={}));var x,C=function e(t){Object(c.a)(this,e),this.type=t,this._integerTag=E.Tag};!function(e){e[e.Tag=0]="Tag"}(x||(x={}));var S,j=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(c.a)(this,e),this.value=t,this._integerTag=x.Tag};!function(e){e[e.Tag=0]="Tag"}(S||(S={}));var I,L=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(c.a)(this,e),this.value=t,this._floatTag=S.Tag};!function(e){e[e.Tag=0]="Tag"}(I||(I={}));var A,P=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(c.a)(this,e),this.value=t,this._textTag=I.Tag};!function(e){e[e.Tag=0]="Tag"}(A||(A={}));var F,N=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\0";Object(c.a)(this,e),this.value=t,this._characterTag=A.Tag};!function(e){e[e.Tag=0]="Tag"}(F||(F={}));var R=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(c.a)(this,e),this.value=t,this._booleanTag=F.Tag}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(11);function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(i.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(12),r=n(13);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){var t=Object(r.a)();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s(this,n)}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return p}));var i=n(4),r=n(5),a=n(12),s=n(11);var o=n(7);function c(e){var t="function"===typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return Object(o.a)(e,arguments,Object(a.a)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Object(s.a)(i,e)})(e)}n(8),n(10);var u,l=n(0),h=n(3);function f(e){if(void 0===e)throw new Error("Optional value not defined.");return e}function v(e){if(e.length<1)throw Error("Array contained no element.");if(e.length>1)throw Error("Array contained more than one element.");return e[0]}!function(e){e[e.Tag=0]="Tag"}(u||(u={}));var p,g=function(e){Object(i.a)(n,e);var t=Object(r.a)(n);function n(e){var i;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return(i=t.call.apply(t,[this,e].concat(a)))._tag=u.Tag,i}return Object(h.a)(n,null,[{key:"fromArray",value:function(e){if(!(e.length<1)){var t=e.shift();if(void 0!==t){var i=new n(t);return e.forEach((function(e){i.push(e)})),i}}}}]),n}(c(Array));!function(e){e[e.LT=-1]="LT",e[e.EQ=0]="EQ",e[e.GT=1]="GT"}(p||(p={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(11),r=n(13);function a(e,t,n){return(a=Object(r.a)()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&Object(i.a)(a,n.prototype),a}).apply(null,arguments)}},function(e,t,n){e.exports=n(19)},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,a;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!==r--;)if(!Object.prototype.hasOwnProperty.call(n,a[r]))return!1;for(r=i;0!==r--;){var s=a[r];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n}},function(e,t,n){"use strict";function i(e,t,n,i,r,a,s){try{var o=e[a](s),c=o.value}catch(u){return void n(u)}o.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){i(s,r,a,o,c,"next",e)}function c(e){i(s,r,a,o,c,"throw",e)}o(void 0)}))}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(8),r=n.n(i),a=n(10),s=n(0),o=n(3),c=n(17),u=n(1),l=n(2),h=n(15),f=n(18),v=n(9),p=n.n(v),g=function(){function t(){Object(s.a)(this,t),this.scheduler=new c.a,this.nextTaskId=0,this.stop=!1,this.memory=new Map,this.objectDependency=new Map,this.out=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){return e.stdout.write(t)}))},this.isRunning=function(){},this.exclusiveLock=void 0,this.interfaceToService=new Map,this.serviceToComponent=new Map,this.clientToServer=new Map}return Object(o.a)(t,[{key:"halt",value:function(){this.stop=!0}},{key:"changeOutput",value:function(e){this.out=e}},{key:"isRunningUpdate",value:function(e){this.isRunning=e}},{key:"run",value:function(){var e=Object(a.a)(r.a.mark((function e(t){var n,i=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.stop=!1,this.isRunning(!0),t.entryPoints.forEach((function(e){i.createComponent(e,new l.k)})),n=this.scheduler.getNextTask();case 4:if(void 0===n||this.stop){e.next=10;break}return e.next=7,n.execute();case 7:n=this.scheduler.getNextTask(),e.next=4;break;case 10:this.isRunning(!1);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireExclusive",value:function(e){return this.exclusiveLock===e&&void 0!==e?e:void 0===this.exclusiveLock?(this.exclusiveLock=t.holderId,t.holderId++,this.exclusiveLock):void 0}},{key:"releaseExclusive",value:function(e){return(void 0===this.exclusiveLock||void 0!==e)&&(this.exclusiveLock===e&&(this.exclusiveLock=void 0,!0))}},{key:"print",value:function(){this.out.apply(this,arguments)}},{key:"time",value:function(){return(new Date).getMilliseconds()}},{key:"load",value:function(e){var t=this.tryLoad(e);if(void 0===t)throw new Error("Failed to load value.");return t}},{key:"tryLoad",value:function(e){return this.memory.get(e)}},{key:"getDefaultVariableValue",value:function(e){return e instanceof u.h?new l.g:e instanceof u.d?new l.f:e instanceof u.p?new l.n:e instanceof u.b?new l.c:e instanceof u.a?new l.b:new l.o(e)}},{key:"createComponent",value:function(e,t){var n=this,i=new l.d(this.nextTaskId++,e),r=new l.e(e,t);return this.objectDependency.set(i,t),this.memory.set(i,r),this.registerTask(i),this.prepareDeclarations(e.declarations,r,i),e.offers.forEach((function(e){n.interfaceToService.has(e)||n.interfaceToService.set(e,new Map)})),e.requires.forEach((function(e){n.interfaceToService.has(e)||n.interfaceToService.set(e,new Map)})),i}},{key:"registerTask",value:function(e){var t=new f.a(this,e),n=new h.a(e,t);this.scheduler.enqueue(n)}},{key:"getService",value:function(e,t){var n=this.interfaceToService.get(e);if(void 0===n)throw new Error("Interface not defined for service.");if(!(this.memory.get(t)instanceof l.e))throw new Error("Component not in memory.");if(n.has(t))return n.get(t);var i=new l.l(this.nextTaskId++,e);return this.serviceToComponent.set(i,t),n.set(t,i),i}},{key:"send",value:function(e,t){var n=this.memory.get(e);if(void 0===n||!(n instanceof l.m))throw new Error("No service found to send to.");n.messageQueue.push(t)}},{key:"receive",value:function(e,n){var i=this.memory.get(e);if(void 0===i||!(i instanceof l.m))throw new Error("No service found to send to.");var r=i.messageQueue;if(void 0!==r&&0!==r.length){var a=r[0].descriptor;return p()(a,n)||p()(n,t.anyMessage)||p()(a,t.finishMessage)?r.shift():void 0}}},{key:"receiveTest",value:function(e){var t=this.memory.get(e);if(void 0===t||!(t instanceof l.m))throw new Error("No service found to send to.");var n=t.messageQueue;if(void 0!==n&&0!==n.length)return n[0]}},{key:"connect",value:function(e,t){var n=this.memory.get(e),i=this.serviceToComponent.get(t);if(!(i instanceof l.d))throw new Error("From does not point to valid component.");var r=this.memory.get(i);if(!(r instanceof l.e))throw new Error('connect: "From" must be a component value.');if(!(n instanceof l.e))throw new Error('connect: "To" must be a component value.');var a=n.descriptor.implementations.find((function(e){return p()(e.reference,t.type)})),s=r.descriptor.implementations.find((function(e){return p()(e.reference,t.type)})),o=void 0===a?s:a;if(this.memory.has(t))throw new Error("Service already connected.");if(void 0===o)throw new Error("Implementation undefined.");var c=this.interfaceToService.get(t.type);if(void 0===c)throw new Error("Interface not defined for service.");var u,h,f,v,g=void 0;void 0!==a&&(null===(u=n.offerConnections.get(t.type))||void 0===u||u.push(t),null===(h=r.requiredConnections.get(t.type))||void 0===h||h.push(t),g=e);void 0!==s&&(null===(f=r.offerConnections.get(t.type))||void 0===f||f.push(t),null===(v=n.requiredConnections.get(t.type))||void 0===v||v.push(t),g=i);if(void 0===g)throw new Error("Unknown service parent!");var d=new l.m(o,g);this.prepareDeclarations(o.declarations,d,t),this.memory.set(t,d),c.set(e,t),c.set(i,t),this.registerTask(t)}},{key:"createProcedure",value:function(e,t){var n=new l.j(e,t);return this.prepareDeclarations(e.declarations,n,t),n}},{key:"prepareDeclarations",value:function(e,t,n){var i=this;e.variables.forEach((function(e){e.indexTypes.length>0&&!(e.type instanceof u.p)?t.variables.push(new l.a(e,new Map)):t.variables.push(new l.p(e,i.getDefaultVariableValue(e.type)))})),e.procedures.forEach((function(e){var r=new l.i(i.nextTaskId++,e),a=i.createProcedure(e,n);i.memory.set(r,a),i.objectDependency.set(r,n),t.procedures.push(a)}))}},{key:"disconnect",value:function(e,t){var n,i=null===(n=this.clientToServer.get(e))||void 0===n?void 0:n.filter((function(e){return!p()(e,t)}));void 0!==i&&this.clientToServer.set(e,i)}}]),t}();g.finishMessage=new l.h(new u.k("FINISH")),g.anyMessage=new l.h(new u.k("ANY")),g.holderId=0}).call(this,n(20))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}));var i,r=n(8),a=n.n(r),s=n(10),o=n(0),c=n(3);!function(e){e[e.Ready=0]="Ready",e[e.Running=1]="Running",e[e.Paused=2]="Paused",e[e.Done=3]="Done"}(i||(i={}));var u=function(){function e(t,n){Object(o.a)(this,e),this.value=t,this.interpreter=n,this.state=i.Ready}return Object(c.a)(e,[{key:"execute",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDone()&&!this.interpreter.isDone()){e.next=3;break}return this.state=i.Done,e.abrupt("return");case 3:this.state=i.Running,this.interpreter.processNext();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){this.isDone()||(this.state=i.Paused)}},{key:"isDone",value:function(){return this.state===i.Done}},{key:"getState",value:function(){return this.state}}]),e}()},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!==typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!==typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(3),a=n(15),s=function(){function e(){Object(i.a)(this,e),this.activeTask=void 0,this.readyTasks=new Array}return Object(r.a)(e,[{key:"enqueue",value:function(e){this.readyTasks.push(e)}},{key:"getNextTask",value:function(){return this.scheduleNext(),this.activeTask}},{key:"getActiveTask",value:function(){return this.activeTask}},{key:"scheduleNext",value:function(){var e;void 0!==this.activeTask&&this.activeTask.getState()!==a.b.Done&&this.readyTasks.push(this.activeTask),null===(e=this.activeTask)||void 0===e||e.pause(),this.activeTask=this.readyTasks.shift()}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(0),r=n(3),a=n(1),s=n(6),o=n(2),c=function(){function e(){Object(i.a)(this,e),this.stack=new Array}return Object(r.a)(e,[{key:"pop",value:function(){if(0===this.stack.length)throw new Error("Pop called on empty evaluation stack.");var e=this.stack.pop();if(void 0===e)throw new Error("Undefined value on stack.");return e}},{key:"popVariable",value:function(){var e=this.pop();return e instanceof o.p?e.value:e}},{key:"push",value:function(e){this.stack.push(e)}}]),e}(),u=n(14),l=function(){function e(t,n){Object(i.a)(this,e),this.system=t,this.evalStack=n}return Object(r.a)(e,[{key:"handleNoArg",value:function(e){switch(e){case a.o.WriteLine:return void this.system.print("\n")}throw new Error("Failed system call '".concat(a.o[e],"' and zero argumentss. Operation not supported."))}},{key:"handleSingleArg",value:function(t,n){switch(t){case a.o.Write:if((n=e.toValue(n))instanceof o.n||n instanceof o.c||n instanceof o.f||n instanceof o.g)return void this.system.print(n.value.toString());break;case a.o.WriteHex:if((n=e.toValue(n))instanceof o.g)return void this.system.print(n.value.toString(16));break;case a.o.Assert:if((n=e.toValue(n))instanceof o.b){if(!n.value)throw new Error("Assertion failed.");return}break;case a.o.Halt:if((n=e.toValue(n))instanceof o.g)throw new Error("Halt called. Id: ".concat(n.value));break;case a.o.Inc:if(n instanceof o.p){var i=n.value;if(i instanceof o.g)return void(n.value=new o.g(i.value+1))}break;case a.o.Dec:if(n instanceof o.p){var r=n.value;if(r instanceof o.g)return void(n.value=new o.g(r.value-1))}break;case a.o.Passivate:return void console.warn("PASSIVATE syscall not supported");case a.o.Count:return void console.warn("COUNT syscall not supported");case a.o.Length:if((n=e.toValue(n))instanceof o.n)return void this.evalStack.push(new o.g(n.value.length));break;case a.o.Sqrt:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.sqrt(n.value)));break;case a.o.Sin:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.sin(n.value)));break;case a.o.Cos:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.cos(n.value)));break;case a.o.Tan:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.tan(n.value)));break;case a.o.ArcSin:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.asin(n.value)));break;case a.o.ArcCos:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.acos(n.value)));break;case a.o.ArcTan:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.f(Math.atan(n.value)));break;case a.o.Min:return console.warn("MIN call currently only supported for float"),void this.evalStack.push(new o.f(Number.MIN_VALUE));case a.o.Max:return console.warn("MAX call currently only supported for float"),void this.evalStack.push(new o.f(Number.MAX_VALUE));case a.o.ToCharacter:if((n=e.toValue(n))instanceof o.g)return void this.evalStack.push(new o.c(String.fromCharCode(n.value)));break;case a.o.ToText:if((n=e.toValue(n))instanceof o.c)return void this.evalStack.push(new o.n(n.value));break;case a.o.ToInteger:if((n=e.toValue(n))instanceof o.f)return void this.evalStack.push(new o.g(Math.trunc(n.value)));if(n instanceof o.c)return void this.evalStack.push(new o.g(Number.parseInt(n.value)));break;case a.o.ToReal:if((n=e.toValue(n))instanceof o.g)return void this.evalStack.push(new o.f(n.value))}throw new Error("Failed system call '".concat(a.o[t],"' and one argument. Operation not supported."))}},{key:"handleDoubleArg",value:function(t,n,i){switch(t){case a.o.Assert:if(n=e.toValue(n),(i=e.toValue(i))instanceof o.b&&n instanceof o.g&&!i.value)throw new Error("Assertion failed. Code ".concat(n,"."));break;case a.o.Inc:if(n=e.toValue(n),i instanceof o.p){var r=i.value;if(r instanceof o.g&&n instanceof o.g)return void(i.value=new o.g(r.value+n.value))}break;case a.o.Dec:if(n=e.toValue(n),i instanceof o.p){var s=i.value;if(s instanceof o.g&&n instanceof o.g)return void(i.value=new o.g(s.value-n.value))}break;case a.o.Random:n=e.toValue(n),(i=e.toValue(i))instanceof o.g&&n instanceof o.g&&this.evalStack.push(new o.g(Math.trunc(Math.random()*n.value)+i.value))}throw new Error("Failed system call '".concat(a.o[t],"' and two arguments. Operation not supported."))}},{key:"handleForEachCall",value:function(e){throw new Error("Runtime: Foreach not yet supported.")}},{key:"handle",value:function(e){if(1!==e.arguments.length)throw new Error("SystemCall requires the number of arguments to be passed. Something must have failed during code gen.");if(!(e.arguments[0]instanceof a.h))throw new Error("SystemCall expects to be passed an IntegerDescriptor argument. Something must have failed during code gen.");for(var t=e.systemCall,n=new Array,i=0;i<e.arguments[0].initialValue;++i)n.push(this.evalStack.pop());if(t!==a.o.LoadForEachDesignators)switch(n.length){case 0:this.handleNoArg(t);break;case 1:this.handleSingleArg(t,n[0]);break;case 2:this.handleDoubleArg(t,n[0],n[1]);break;default:throw new Error("Failed system call '".concat(t,"' with ").concat(n.length," arguments. Operation not supported."))}else this.handleForEachCall(n)}}],[{key:"toValue",value:function(e){return e instanceof o.p?e.value:e}}]),e}(),h=n(9),f=n.n(h),v=function(){function e(t,n){Object(i.a)(this,e),this.system=t,this.valuePointer=n,this.evalStack=new c,this.systemCallHandler=new l(this.system,this.evalStack),this.wait=void 0,this.lock=void 0}return Object(r.a)(e,[{key:"isDone",value:function(){return this.loadValue().isDone()}},{key:"loadValue",value:function(){return this.system.load(this.valuePointer)}},{key:"loadParentValue",value:function(e){return this.system.tryLoad(e.parent)}},{key:"add",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(e instanceof o.n&&t instanceof o.n)this.evalStack.push(new o.n(t.value+e.value));else if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.f(t.value+e.value));else{if(!(e instanceof o.g&&t instanceof o.g))throw new Error("Add operation failed.");this.evalStack.push(new o.g(Math.trunc(t.value+e.value)))}}},{key:"sub",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.f(t.value-e.value));else{if(!(e instanceof o.g&&t instanceof o.g))throw new Error("Sub operation failed.");this.evalStack.push(new o.g(Math.trunc(t.value-e.value)))}}},{key:"mul",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.f(t.value*e.value));else{if(!(e instanceof o.g&&t instanceof o.g))throw new Error("Mul operation failed.");this.evalStack.push(new o.g(Math.trunc(t.value*e.value)))}}},{key:"div",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.f(t.value/e.value));else{if(!(e instanceof o.g&&t instanceof o.g))throw new Error("Div operation failed.");this.evalStack.push(new o.g(Math.trunc(t.value/e.value)))}}},{key:"negate",value:function(){var e=this.evalStack.popVariable();if(e instanceof o.f)this.evalStack.push(new o.f(-e.value));else{if(!(e instanceof o.g))throw new Error("Negate operation failed.");this.evalStack.push(new o.g(-e.value))}}},{key:"mod",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.f(t.value%e.value));else{if(!(e instanceof o.g&&t instanceof o.g))throw new Error("Mod operation failed.");this.evalStack.push(new o.g(Math.trunc(t.value%e.value)))}}},{key:"handleComparable",value:function(e,t,n){if(e instanceof o.g&&t instanceof o.g)this.evalStack.push(new o.b(n(e.value,t.value)));else if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.b(n(e.value,t.value)));else if(e instanceof o.n&&t instanceof o.n)this.evalStack.push(new o.b(n(e.value,t.value)));else{if(!(e instanceof o.c&&t instanceof o.c))throw new Error("Unsupported less/greater comparison.");this.evalStack.push(new o.b(n(e.value,t.value)))}}},{key:"handleEquatable",value:function(e,t,n){if(e instanceof o.b&&t instanceof o.b)this.evalStack.push(new o.b(n(e.value,t.value)));else if(e instanceof o.g&&t instanceof o.g)this.evalStack.push(new o.b(n(e.value,t.value)));else if(e instanceof o.f&&t instanceof o.f)this.evalStack.push(new o.b(n(e.value,t.value)));else if(e instanceof o.n&&t instanceof o.n)this.evalStack.push(new o.b(n(e.value,t.value)));else{if(!(e instanceof o.c&&t instanceof o.c))throw new Error("Unsupported equality comparison.");this.evalStack.push(new o.b(n(e.value,t.value)))}}},{key:"handleCompareOp",value:function(e){var t=this.evalStack.popVariable();if(void 0===t)throw new Error("Unknown right compare argument.");var n=this.evalStack.popVariable();if(void 0===n)throw new Error("Unknown left compare argument.");switch(e){case a.l.Equal:return void this.handleEquatable(n,t,(function(e,t){return e===t}));case a.l.NotEqual:return void this.handleEquatable(n,t,(function(e,t){return e!==t}));case a.l.Less:return void this.handleComparable(n,t,(function(e,t){return e<t}));case a.l.LessEqual:return void this.handleComparable(n,t,(function(e,t){return e<=t}));case a.l.Greater:return void this.handleComparable(n,t,(function(e,t){return e>t}));case a.l.GreaterEqual:return void this.handleComparable(n,t,(function(e,t){return e>=t}))}throw new Error("Unsupprted compare op.")}},{key:"not",value:function(){var e=this.evalStack.popVariable();if(!(e instanceof o.b))throw new Error("Not operation failed.");this.evalStack.push(new o.b(!e.value))}},{key:"or",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(!(e instanceof o.b&&t instanceof o.b))throw new Error("Or operation failed.");this.evalStack.push(new o.b(t.value||e.value))}},{key:"and",value:function(){var e=this.evalStack.popVariable(),t=this.evalStack.popVariable();if(!(e instanceof o.b&&t instanceof o.b))throw new Error("And operation failed.");this.evalStack.push(new o.b(t.value&&e.value))}},{key:"handleNewVariable",value:function(e,t){if(!e.isMutabled())throw new Error("Cannot NEW instanciate a constant value.");if(t instanceof a.c){e.value instanceof o.e&&e.value.finalize();var n=this.system.createComponent(t,this.valuePointer);e.value=n}else{if(!(t instanceof a.p))throw new Error("NEW built in variable not yet supported.");e.value=new o.n("")}}},{key:"handleNew",value:function(t){var n=t[0];if(1!==t.length||!(n instanceof a.c||e.isBuiltInTypeDescriptor(n)))throw new Error("Unsupported NEW call, check your code generator.");var i=this.evalStack.pop();if(!(i instanceof o.p))throw new Error("Unsupported NEW. NEW target must be a variable.");this.handleNewVariable(i,n)}},{key:"loadIndexVariable",value:function(t){var n=this,i=new Array;return t.indexTypes.forEach((function(){var t=n.evalStack.popVariable();if(t instanceof o.o)throw new Error("Load index value undefined!");if(e.isBuiltInValue(t))i.push(t.value);else{if(!(t instanceof o.d||t instanceof o.l))throw new Error("Illegal Variable Index.");i.push(t.address)}})),i.join("::")}},{key:"handleDelete",value:function(){var e=this.evalStack.pop();if(!(e instanceof o.p||e instanceof o.a))throw new Error("Only variables can be deleted.");if(e instanceof o.p)return e.value instanceof o.e?void e.value.finalize():void(e.value=new o.o(e.descriptor.type));var t=this.loadIndexVariable(e.descriptor),n=e.value.get(t);n instanceof o.e?n.finalize():e.value.delete(t)}},{key:"loadMessage",value:function(t){var n=this,i=new o.h(t);return t.data.forEach((function(t){var r=n.evalStack.popVariable();if(!e.isBuiltInValue(r))throw new Error("Message can only contain built in values: TEXT, CHARACTER INTEGER, REAL, BOOLEAN");if(!e.descriptorMatchBuiltIn(t,r))throw new Error("Message param does not match stack value");i.fields.push(r)})),i}},{key:"handleSend",value:function(e){if(1!==e.length||!(e[0]instanceof a.k))throw new Error("MessageDescriptor required for sending.");var t=this.evalStack.popVariable();if(!(t instanceof o.l))throw new Error("Expected target service to send to.");var n=this.loadMessage(e[0]);this.system.send(t,n)}},{key:"handleReceive",value:function(e){var t=this;if(1!==e.length||!(e[0]instanceof a.k))throw new Error("MessageDescriptor required for receiving.");var n=e[0],i=this.evalStack.popVariable();if(!(i instanceof o.l))throw new Error("Receiver must be a service.");this.wait=function(){var e=t.system.receive(i,n);return e!==u.a.finishMessage&&(void 0===e||(e.fields.forEach((function(e){t.evalStack.push(e),t.storeVariable()})),!1))},this.wait()||(this.wait=void 0)}},{key:"handleConnect",value:function(){var e=this.evalStack.popVariable();if(!(e instanceof o.d))throw new Error("Connect target needs to be either a component.");var t=this.evalStack.popVariable();if(!(t instanceof o.l))throw new Error("Service required for from.");this.system.connect(e,t)}},{key:"handleDisconnect",value:function(){var e=this.evalStack.popVariable();if(!(e instanceof o.d))throw new Error("Need to know from component.");var t=this.evalStack.popVariable();if(!(t instanceof o.l))throw new Error("Service required for disconnecting.");this.system.disconnect(e,t)}},{key:"handleReceiveCheck",value:function(e){var t=this;if(1!==e.length||!(e[0]instanceof a.k))throw new Error("MessageDescriptor required for receiving.");var n=e[0],i=this.evalStack.popVariable();if(!(i instanceof o.l))throw new Error("Receiver must be a component or service.");this.wait=function(){var e=t.system.receiveTest(i);return void 0===e||(f()(e.descriptor,n)?(t.evalStack.push(new o.b(!0)),!1):(t.evalStack.push(new o.b(!1)),!1))},this.wait()||(this.wait=void 0)}},{key:"handleInputCheck",value:function(e){if(1!==e.length||!(e[0]instanceof a.k))throw new Error("MessageDescriptor required for receiving.");var t=e[0],n=this.evalStack.popVariable();if(!(n instanceof o.l))throw new Error("Receiver must be a component or service.");var i=this.system.receiveTest(n);void 0!==i&&f()(i.descriptor,t)?this.evalStack.push(new o.b(!0)):this.evalStack.push(new o.b(!1))}},{key:"handleSystemCall",value:function(e){if(1!==e.length||!(e[0]instanceof a.n))throw new Error("Invalid system call.");this.systemCallHandler.handle(e[0])}},{key:"handleProcedurecall",value:function(t){var n=this;if(1!==t.length||!(t[0]instanceof a.m))throw new Error("Invalid procedure call.");var i=new Array;t[0].parameters.forEach((function(){var t=n.evalStack.popVariable();if(!(t instanceof o.d||e.isBuiltInValue(t)))throw new Error("Failed to pass value to procedure.");i.push(t)})),this.loadValue().call(t[0],i)}},{key:"handleReturn",value:function(){this.loadValue().procedureReturned()}},{key:"loadBoolean",value:function(e){if(!(e.length>0&&e[0]instanceof a.a))throw new Error("Boolean load operation failed.");this.evalStack.push(new o.b(e[0].initialValue))}},{key:"loadText",value:function(e){if(!(e.length>=1&&e[0]instanceof a.p))throw new Error("Text load operation failed.");this.evalStack.push(new o.n(e[0].initialValue))}},{key:"loadCharacter",value:function(e){if(!(e.length>=1&&e[0]instanceof a.b))throw new Error("Character load operation failed.");this.evalStack.push(new o.c(e[0].initialValue))}},{key:"loadFloat",value:function(e){if(!(e.length>0&&e[0]instanceof a.d))throw new Error("Float load operation failed.");this.evalStack.push(new o.f(e[0].initialValue))}},{key:"loadInteger",value:function(e){if(!(e.length>0&&e[0]instanceof a.h))throw new Error("Integer load operation failed.");this.evalStack.push(new o.g(e[0].initialValue))}},{key:"storeVariable",value:function(){var t=this.evalStack.popVariable(),n=this.evalStack.pop();if(n instanceof o.p){if(!n.isMutabled())throw new Error("Cannot assign value to a constant.");var i=n.value;if(i instanceof o.o&&(e.isBuiltInValue(t)||t instanceof o.d))return void(n.value=t);if(t instanceof o.g&&i instanceof o.g||t instanceof o.f&&i instanceof o.f||t instanceof o.b&&i instanceof o.b||t instanceof o.c&&i instanceof o.c||t instanceof o.n&&i instanceof o.n||t instanceof o.d&&i instanceof o.d)return void(n.value=t)}if(!(n instanceof o.a))throw new Error("Unsupported Variable Store.");n.value.set(this.loadIndexVariable(n.descriptor),t)}},{key:"loadVariable",value:function(e){if(1!==e.length)throw new Error("Expected single argument for variable load only.");if(e[0]instanceof a.q){for(var t=this.loadValue(),n=this.loadParentValue(t),i=t.variables.find((function(t){return t.descriptor===e[0]}));void 0===i&&void 0!==n;)t=n,n=this.loadParentValue(t),i=t.variables.find((function(t){return f()(t.descriptor,e[0])}));if(i instanceof o.p)return void this.evalStack.push(i);if(i instanceof o.a){var r=this.loadIndexVariable(i.descriptor);return i.value.has(r)||i.value.set(r,new o.p(i.descriptor,new o.o(i.descriptor.type))),void this.evalStack.push(Object(s.d)(i.value.get(r)))}}throw new Error("Unsupported Variable Load.")}},{key:"loadService",value:function(e){if(1===e.length&&e[0]instanceof a.i){var t=this.evalStack.popVariable();if(t instanceof o.d){var n=this.system.getService(e[0],t);return void this.evalStack.push(n)}}throw new Error("Unsupported Service Load.")}},{key:"loadThis",value:function(){if(!(this.valuePointer instanceof o.l||this.valuePointer instanceof o.d))throw new Error("Load this only for services supported.");this.evalStack.push(this.valuePointer)}},{key:"handleAcquireExclusive",value:function(){var e=this;this.wait=function(){var t=e.system.acquireExclusive(e.lock);return void 0===t||(e.lock=t,!1)},this.wait()||(this.wait=void 0)}},{key:"handleReleaseExclusive",value:function(){var e=this;this.wait=function(){var t=e.system.releaseExclusive(e.lock);return t&&(e.lock=void 0),!t},this.wait()||(this.wait=void 0)}},{key:"branch",value:function(e){if(1!==e.length)throw new Error("Branch conditions must have one operand.");var t=e[0];if(!(t instanceof a.j))throw new Error("Failed jump.");this.loadValue().jump(t)}},{key:"branchConditionally",value:function(e,t){var n=this.evalStack.popVariable();if(1!==t.length)throw new Error("Branch conditions only have one operand.");if(n instanceof o.b&&t[0]instanceof a.j)return n.value===e?void this.branch(t):void 0;throw new Error("Conditional jump failed.")}},{key:"processNext",value:function(){if(!this.loadValue().isDone()){if(void 0!==this.wait){if(this.wait())return;this.wait=void 0}var e=this.loadValue().fetch();if(void 0!==e)switch(e.code){case a.l.Add:this.add();break;case a.l.Subtract:this.sub();break;case a.l.Multiply:this.mul();break;case a.l.Divide:this.div();break;case a.l.Negate:this.negate();break;case a.l.Modulo:this.mod();break;case a.l.Equal:case a.l.Less:case a.l.LessEqual:case a.l.Greater:case a.l.GreaterEqual:case a.l.NotEqual:this.handleCompareOp(e.code);break;case a.l.Not:this.not();break;case a.l.LogicOr:this.or();break;case a.l.LogicAnd:this.and();break;case a.l.New:this.handleNew(e.arguments);break;case a.l.Delete:this.handleDelete();break;case a.l.Send:this.handleSend(e.arguments);break;case a.l.Receive:this.handleReceive(e.arguments);break;case a.l.Connect:this.handleConnect();break;case a.l.Disconnect:this.handleDisconnect();break;case a.l.ReceiveTest:this.handleReceiveCheck(e.arguments);break;case a.l.InputTest:this.handleInputCheck(e.arguments);break;case a.l.SystemCall:this.handleSystemCall(e.arguments);break;case a.l.ProcedureCall:this.handleProcedurecall(e.arguments);break;case a.l.Return:this.handleReturn();break;case a.l.LoadConstantBoolean:this.loadBoolean(e.arguments);break;case a.l.LoadConstantText:this.loadText(e.arguments);break;case a.l.LoadConstantCharacter:this.loadCharacter(e.arguments);break;case a.l.LoadConstantFloat:this.loadFloat(e.arguments);break;case a.l.LoadConstantInteger:this.loadInteger(e.arguments);break;case a.l.Move:throw new Error("MOVE is not yet supported.");case a.l.StoreVariable:this.storeVariable();break;case a.l.LoadVariable:this.loadVariable(e.arguments);break;case a.l.LoadService:this.loadService(e.arguments);break;case a.l.LoadThis:this.loadThis();break;case a.l.AcquireShared:console.warn("Acquire SHARED ignored.");break;case a.l.ReleaseShared:console.warn("Release SHARED ignored.");break;case a.l.AcquireExclusive:this.handleAcquireExclusive();break;case a.l.ReleaseExclusive:this.handleReleaseExclusive();break;case a.l.Branch:this.branch(e.arguments);break;case a.l.BranchTrue:this.branchConditionally(!0,e.arguments);break;case a.l.BranchFalse:this.branchConditionally(!1,e.arguments);break;case a.l.IsType:throw new Error("IS typecheck is not yet supported.");case a.l.ExistsTest:throw new Error("EXISTSW check is not yet supported.")}}}}],[{key:"isBuiltInTypeDescriptor",value:function(e){return e instanceof a.h||e instanceof a.d||e instanceof a.p||e instanceof a.b||e instanceof a.a}},{key:"isBuiltInValue",value:function(e){return e instanceof o.g||e instanceof o.f||e instanceof o.n||e instanceof o.c||e instanceof o.b}},{key:"descriptorMatchBuiltIn",value:function(e,t){return e instanceof a.h&&t instanceof o.g||e instanceof a.d&&t instanceof o.f||e instanceof a.b&&t instanceof o.c||e instanceof a.p&&t instanceof o.n||e instanceof a.a&&t instanceof o.b}}]),e}()},function(e,t,n){var i=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(A){c=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var r=t&&t.prototype instanceof d?t:d,a=Object.create(r.prototype),s=new j(i||[]);return a._invoke=function(e,t,n){var i=h;return function(r,a){if(i===v)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw a;return L()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var o=x(s,n);if(o){if(o===g)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=v;var c=l(e,t,n);if("normal"===c.type){if(i=n.done?p:f,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=p,n.method="throw",n.arg=c.arg)}}}(e,n,s),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(A){return{type:"throw",arg:A}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",v="executing",p="completed",g={};function d(){}function m(){}function y(){}var b={};b[a]=function(){return this};var k=Object.getPrototypeOf,T=k&&k(k(I([])));T&&T!==n&&i.call(T,a)&&(b=T);var w=y.prototype=d.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(r,a,s,o){var c=l(e[r],e,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"===typeof h&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,o)}))}o(c.arg)}var r;this._invoke=function(e,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}}function x(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=l(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;var a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function I(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:L}}function L(){return{value:t,done:!0}}return m.prototype=w.constructor=y,y.constructor=m,m.displayName=c(y,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,o,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},E(O.prototype),O.prototype[s]=function(){return this},e.AsyncIterator=O,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new O(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(w),c(w,o,"Generator"),w[a]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=I,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:I(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=i}catch(r){Function("r","regeneratorRuntime = r")(i)}},function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"===typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&v())}function v(){if(!l){var e=o(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||o(v)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var i=n(8),r=n.n(i),a=n(10),s=n(0),o=n(3),c=n(7);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h,f=n(6),v=function(){function e(t,n){Object(s.a)(this,e),this.line=t,this.character=n}return Object(o.a)(e,[{key:"compareTo",value:function(e){return this.line<e.line||this.line===e.line&&this.character<e.character?f.a.LT:this.line>e.line||this.line===e.line&&this.character>e.character?f.a.GT:f.a.EQ}}],[{key:"from",value:function(t){return t instanceof e?t:new e(t.line,t.character)}}]),e}(),p=function(){function e(t,n){Object(s.a)(this,e),this.start=t,this.end=n}return Object(o.a)(e,null,[{key:"merge",value:function(t,n){var i=v.from(t.start).compareTo(n.start),r=v.from(t.end).compareTo(n.end);return new e(i===f.a.LT?t.start:i===f.a.GT?n.start:t.start,r===f.a.LT?n.end:r===f.a.GT?t.end:n.end)}}]),e}(),g=function(){function e(t,n){Object(s.a)(this,e),this.uri=t,this.range=n}return Object(o.a)(e,null,[{key:"merge",value:function(t,n){if(t.uri!==n.uri)throw Error("Source location URI missmatch.");return new e(t.uri,p.merge(t.range,n.range))}}]),e}(),d=n(4),m=n(5);function y(e){switch(e){case h.Begin:return h.Begin;case h.Activity:return h.Activity;case h.Finally:return h.Finally;case h.End:return h.End;case h.Constant:return h.Constant;case h.Variable:return h.Variable;case h.In:return h.In;case h.Out:return h.Out;case h.Is:return h.Is;case h.Type:return h.Type;case h.Any:return h.Any;case h.Finish:return h.Finish;case h.Component:return h.Component;case h.Interface:return h.Interface;case h.Procedure:return h.Procedure;case h.Implementation:return h.Implementation;case h.Offers:return h.Offers;case h.Requires:return h.Requires;case h.OpenBrace:return h.OpenBrace;case h.CloseBrace:return h.CloseBrace;case h.OpenSquareBracket:return h.OpenSquareBracket;case h.CloseSquareBracket:return h.CloseSquareBracket;case h.OpenParentheses:return h.OpenParentheses;case h.CloseParentheses:return h.CloseParentheses;case h.Semicolon:return h.Semicolon;case h.Colon:return h.Colon;case h.Comma:return h.Comma;case h.Asterisk:return h.Asterisk;case h.Pipe:return h.Pipe;case h.For:return h.For;case h.To:return h.To;case h.By:return h.By;case h.Do:return h.Do;case h.Foreach:return h.Foreach;case h.Of:return h.Of;case h.While:return h.While;case h.Repeat:return h.Repeat;case h.Until:return h.Until;case h.If:return h.If;case h.Then:return h.Then;case h.Elsif:return h.Elsif;case h.Else:return h.Else;case h.Return:return h.Return;case h.NumberSign:return h.NumberSign;case h.Equal:return h.Equal;case h.Less:return h.Less;case h.LessEqual:return h.LessEqual;case h.Greater:return h.Greater;case h.GreaterEqual:return h.GreaterEqual;case h.ColonEqual:return h.ColonEqual;case h.Ellipsis:return h.Ellipsis;case h.Plus:return h.Plus;case h.Minus:return h.Minus;case h.Tilde:return h.Tilde;case h.Slash:return h.Slash;case h.Div:return h.Div;case h.Mod:return h.Mod;case h.And:return h.And;case h.Or:return h.Or;case h.ExclamationMark:return h.ExclamationMark;case h.QuestionMark:return h.QuestionMark;default:return}}!function(e){e.EOT="EOT",e.Begin="BEGIN",e.Activity="ACTIVITY",e.Finally="FINALLY",e.End="END",e.Constant="CONSTANT",e.Variable="VARIABLE",e.In="IN",e.Out="OUT",e.Is="IS",e.Type="TYPE",e.Any="ANY",e.Finish="FINISH",e.Component="COMPONENT",e.Interface="INTERFACE",e.Procedure="PROCEDURE",e.Implementation="IMPLEMENTATION",e.Offers="OFFERS",e.Requires="REQUIRES",e.OpenBrace="{",e.CloseBrace="}",e.OpenSquareBracket="[",e.CloseSquareBracket="]",e.OpenParentheses="(",e.CloseParentheses=")",e.Semicolon=";",e.Colon=":",e.Comma=",",e.Asterisk="*",e.Pipe="|",e.For="FOR",e.To="TO",e.By="BY",e.Do="DO",e.Foreach="FOREACH",e.Of="OF",e.While="WHILE",e.Repeat="REPEAT",e.Until="UNTIL",e.If="IF",e.Then="THEN",e.Elsif="ELSIF",e.Else="ELSE",e.Return="RETURN",e.NumberSign="#",e.Equal="=",e.Less="<",e.LessEqual="<=",e.Greater=">",e.GreaterEqual=">=",e.ColonEqual=":=",e.Ellipsis="..",e.Plus="+",e.Minus="-",e.Tilde="~",e.Slash="/",e.Div="DIV",e.Mod="MOD",e.And="AND",e.Or="OR",e.ExclamationMark="!",e.QuestionMark="?"}(h||(h={}));var b,k=function(){function e(t){Object(s.a)(this,e),this.location=t}return Object(o.a)(e,[{key:"getLocation",value:function(){return this.location}}]),e}();!function(e){e[e.Tag=0]="Tag"}(b||(b={}));var T,w=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e))._errorTag=b.Tag,i}return n}(k),E=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).tag=i,r}return Object(o.a)(n,[{key:"getTag",value:function(){return this.tag}}]),n}(k),O=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).identifier=i,r}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}}]),n}(k),x=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).value=i,r}return Object(o.a)(n,[{key:"getNumber",value:function(){return this.value}}]),n}(k);!function(e){e[e.Tag=0]="Tag"}(T||(T={}));var C,S=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=T.Tag,e}return n}(x);!function(e){e[e.Tag=0]="Tag"}(C||(C={}));var j,I=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=C.Tag,e}return n}(x);!function(e){e[e.Tag=0]="Tag"}(j||(j={}));var L,A,P,F,N,R,D,M,B,V,q,_,U,W,G,H,X,Q,z,Y,J,K,$,Z,ee,te,ne=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,i*Math.pow(10,r))).mantissa=i,a.exponent=r,a._tag=j.Tag,a}return Object(o.a)(n,[{key:"getMantissa",value:function(){return this.mantissa}},{key:"getExponent",value:function(){return this.exponent}}]),n}(x),ie=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).text=i,r}return Object(o.a)(n,[{key:"getText",value:function(){return this.text}}]),n}(k);!function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(L||(L={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(A||(A={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=A.MAX_VALUE),t===Number.MAX_VALUE&&(t=A.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return Me.objectLiteral(t)&&Me.uinteger(t.line)&&Me.uinteger(t.character)}}(P||(P={})),function(e){e.create=function(e,t,n,i){if(Me.uinteger(e)&&Me.uinteger(t)&&Me.uinteger(n)&&Me.uinteger(i))return{start:P.create(e,t),end:P.create(n,i)};if(P.is(e)&&P.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return Me.objectLiteral(t)&&P.is(t.start)&&P.is(t.end)}}(F||(F={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Me.defined(t)&&F.is(t.range)&&(Me.string(t.uri)||Me.undefined(t.uri))}}(N||(N={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return Me.defined(t)&&F.is(t.targetRange)&&Me.string(t.targetUri)&&(F.is(t.targetSelectionRange)||Me.undefined(t.targetSelectionRange))&&(F.is(t.originSelectionRange)||Me.undefined(t.originSelectionRange))}}(R||(R={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return Me.numberRange(t.red,0,1)&&Me.numberRange(t.green,0,1)&&Me.numberRange(t.blue,0,1)&&Me.numberRange(t.alpha,0,1)}}(D||(D={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return F.is(t.range)&&D.is(t.color)}}(M||(M={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return Me.string(t.label)&&(Me.undefined(t.textEdit)||Q.is(t))&&(Me.undefined(t.additionalTextEdits)||Me.typedArray(t.additionalTextEdits,Q.is))}}(B||(B={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(V||(V={})),function(e){e.create=function(e,t,n,i,r){var a={startLine:e,endLine:t};return Me.defined(n)&&(a.startCharacter=n),Me.defined(i)&&(a.endCharacter=i),Me.defined(r)&&(a.kind=r),a},e.is=function(e){var t=e;return Me.uinteger(t.startLine)&&Me.uinteger(t.startLine)&&(Me.undefined(t.startCharacter)||Me.uinteger(t.startCharacter))&&(Me.undefined(t.endCharacter)||Me.uinteger(t.endCharacter))&&(Me.undefined(t.kind)||Me.string(t.kind))}}(q||(q={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Me.defined(t)&&N.is(t.location)&&Me.string(t.message)}}(_||(_={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(U||(U={})),function(e){e.Unnecessary=1,e.Deprecated=2}(W||(W={})),function(e){e.is=function(e){var t=e;return void 0!==t&&null!==t&&Me.string(t.href)}}(G||(G={})),function(e){e.create=function(e,t,n,i,r,a){var s={range:e,message:t};return Me.defined(n)&&(s.severity=n),Me.defined(i)&&(s.code=i),Me.defined(r)&&(s.source=r),Me.defined(a)&&(s.relatedInformation=a),s},e.is=function(e){var t,n=e;return Me.defined(n)&&F.is(n.range)&&Me.string(n.message)&&(Me.number(n.severity)||Me.undefined(n.severity))&&(Me.integer(n.code)||Me.string(n.code)||Me.undefined(n.code))&&(Me.undefined(n.codeDescription)||Me.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(Me.string(n.source)||Me.undefined(n.source))&&(Me.undefined(n.relatedInformation)||Me.typedArray(n.relatedInformation,_.is))}}(H||(H={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={title:e,command:t};return Me.defined(n)&&n.length>0&&(r.arguments=n),r},e.is=function(e){var t=e;return Me.defined(t)&&Me.string(t.title)&&Me.string(t.command)}}(X||(X={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Me.objectLiteral(t)&&Me.string(t.newText)&&F.is(t.range)}}(Q||(Q={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return void 0!==t&&Me.objectLiteral(t)&&Me.string(t.label)&&(Me.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(Me.string(t.description)||void 0===t.description)}}(z||(z={})),function(e){e.is=function(e){return"string"===typeof e}}(Y||(Y={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return Q.is(t)&&(z.is(t.annotationId)||Y.is(t.annotationId))}}(J||(J={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Me.defined(t)&&se.is(t.textDocument)&&Array.isArray(t.edits)}}(K||(K={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&Me.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Me.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Me.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||Y.is(t.annotationId))}}($||($={})),function(e){e.create=function(e,t,n,i){var r={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(r.options=n),void 0!==i&&(r.annotationId=i),r},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Me.string(t.oldUri)&&Me.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Me.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Me.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||Y.is(t.annotationId))}}(Z||(Z={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Me.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Me.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Me.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||Y.is(t.annotationId))}}(ee||(ee={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Me.string(e.kind)?$.is(e)||Z.is(e)||ee.is(e):K.is(e)})))}}(te||(te={}));var re,ae,se,oe,ce,ue,le,he,fe,ve,pe,ge,de,me,ye,be,ke,Te,we,Ee,Oe,xe,Ce,Se,je,Ie,Le,Ae,Pe,Fe,Ne=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,r;if(void 0===n?i=Q.insert(e,t):Y.is(n)?(r=n,i=J.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=J.insert(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.replace=function(e,t,n){var i,r;if(void 0===n?i=Q.replace(e,t):Y.is(n)?(r=n,i=J.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=J.replace(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=Q.del(e):Y.is(t)?(i=t,n=J.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=J.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),Re=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(Y.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}();!function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new Re(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(K.is(e)){var n=new Ne(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new Ne(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(se.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:r=[]};this._workspaceEdit.documentChanges.push(n),i=new Ne(r,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var r=[];this._workspaceEdit.changes[e]=r,i=new Ne(r),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new Re,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,a;if(z.is(t)||Y.is(t)?i=t:n=t,void 0===i?r=$.create(e,n):(a=Y.is(i)?i:this._changeAnnotations.manage(i),r=$.create(e,n,a)),this._workspaceEdit.documentChanges.push(r),void 0!==a)return a},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,a,s;if(z.is(n)||Y.is(n)?r=n:i=n,void 0===r?a=Z.create(e,t,i):(s=Y.is(r)?r:this._changeAnnotations.manage(r),a=Z.create(e,t,i,s)),this._workspaceEdit.documentChanges.push(a),void 0!==s)return s},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,a;if(z.is(t)||Y.is(t)?i=t:n=t,void 0===i?r=ee.create(e,n):(a=Y.is(i)?i:this._changeAnnotations.manage(i),r=ee.create(e,n,a)),this._workspaceEdit.documentChanges.push(r),void 0!==a)return a}}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Me.defined(t)&&Me.string(t.uri)}}(re||(re={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Me.defined(t)&&Me.string(t.uri)&&Me.integer(t.version)}}(ae||(ae={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Me.defined(t)&&Me.string(t.uri)&&(null===t.version||Me.integer(t.version))}}(se||(se={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return Me.defined(t)&&Me.string(t.uri)&&Me.string(t.languageId)&&Me.integer(t.version)&&Me.string(t.text)}}(oe||(oe={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(ce||(ce={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(ce||(ce={})),function(e){e.is=function(e){var t=e;return Me.objectLiteral(e)&&ce.is(t.kind)&&Me.string(t.value)}}(ue||(ue={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(le||(le={})),function(e){e.PlainText=1,e.Snippet=2}(he||(he={})),function(e){e.Deprecated=1}(fe||(fe={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&Me.string(t.newText)&&F.is(t.insert)&&F.is(t.replace)}}(ve||(ve={})),function(e){e.asIs=1,e.adjustIndentation=2}(pe||(pe={})),function(e){e.create=function(e){return{label:e}}}(ge||(ge={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(de||(de={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Me.string(t)||Me.objectLiteral(t)&&Me.string(t.language)&&Me.string(t.value)}}(me||(me={})),function(e){e.is=function(e){var t=e;return!!t&&Me.objectLiteral(t)&&(ue.is(t.contents)||me.is(t.contents)||Me.typedArray(t.contents,me.is))&&(void 0===e.range||F.is(e.range))}}(ye||(ye={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(be||(be={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={label:e};return Me.defined(t)&&(r.documentation=t),Me.defined(n)?r.parameters=n:r.parameters=[],r}}(ke||(ke={})),function(e){e.Text=1,e.Read=2,e.Write=3}(Te||(Te={})),function(e){e.create=function(e,t){var n={range:e};return Me.number(t)&&(n.kind=t),n}}(we||(we={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(Ee||(Ee={})),function(e){e.Deprecated=1}(Oe||(Oe={})),function(e){e.create=function(e,t,n,i,r){var a={name:e,kind:t,location:{uri:i,range:n}};return r&&(a.containerName=r),a}}(xe||(xe={})),function(e){e.create=function(e,t,n,i,r,a){var s={name:e,detail:t,kind:n,range:i,selectionRange:r};return void 0!==a&&(s.children=a),s},e.is=function(e){var t=e;return t&&Me.string(t.name)&&Me.number(t.kind)&&F.is(t.range)&&F.is(t.selectionRange)&&(void 0===t.detail||Me.string(t.detail))&&(void 0===t.deprecated||Me.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Ce||(Ce={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Se||(Se={})),function(e){e.create=function(e,t){var n={diagnostics:e};return void 0!==t&&null!==t&&(n.only=t),n},e.is=function(e){var t=e;return Me.defined(t)&&Me.typedArray(t.diagnostics,H.is)&&(void 0===t.only||Me.typedArray(t.only,Me.string))}}(je||(je={})),function(e){e.create=function(e,t,n){var i={title:e},r=!0;return"string"===typeof t?(r=!1,i.kind=t):X.is(t)?i.command=t:i.edit=t,r&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&Me.string(t.title)&&(void 0===t.diagnostics||Me.typedArray(t.diagnostics,H.is))&&(void 0===t.kind||Me.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||X.is(t.command))&&(void 0===t.isPreferred||Me.boolean(t.isPreferred))&&(void 0===t.edit||te.is(t.edit))}}(Ie||(Ie={})),function(e){e.create=function(e,t){var n={range:e};return Me.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return Me.defined(t)&&F.is(t.range)&&(Me.undefined(t.command)||X.is(t.command))}}(Le||(Le={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Me.defined(t)&&Me.uinteger(t.tabSize)&&Me.boolean(t.insertSpaces)}}(Ae||(Ae={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return Me.defined(t)&&F.is(t.range)&&(Me.undefined(t.target)||Me.string(t.target))}}(Pe||(Pe={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&F.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(Fe||(Fe={}));var De;!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,r=e.slice(0,i),a=e.slice(i);t(r,n),t(a,n);for(var s=0,o=0,c=0;s<r.length&&o<a.length;){var u=n(r[s],a[o]);e[c++]=u<=0?r[s++]:a[o++]}for(;s<r.length;)e[c++]=r[s++];for(;o<a.length;)e[c++]=a[o++];return e}e.create=function(e,t,n,i){return new Be(e,t,n,i)},e.is=function(e){var t=e;return!!(Me.defined(t)&&Me.string(t.uri)&&(Me.undefined(t.languageId)||Me.string(t.languageId))&&Me.uinteger(t.lineCount)&&Me.func(t.getText)&&Me.func(t.positionAt)&&Me.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),r=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),a=i.length,s=r.length-1;s>=0;s--){var o=r[s],c=e.offsetAt(o.range.start),u=e.offsetAt(o.range.end);if(!(u<=a))throw new Error("Overlapping edit");i=i.substring(0,c)+o.newText+i.substring(u,i.length),a=c}return i}}(De||(De={}));var Me,Be=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var r=t.charAt(i);n="\r"===r||"\n"===r,"\r"===r&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return P.create(0,e);for(;n<i;){var r=Math.floor((n+i)/2);t[r]>e?i=r:n=r+1}var a=n-1;return P.create(a,e-t[a])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return"undefined"!==typeof e},e.undefined=function(e){return"undefined"===typeof e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"===typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Me||(Me={}));var Ve,qe=function e(t,n,i,r,a,o,c){Object(s.a)(this,e),this.range=t,this.severity=n,this.message=i,this.code=r,this.source=a,this.tags=o,this.relatedInformation=c},_e=function(){function e(){Object(s.a)(this,e),this.diagnostics=new Array,this.warning=!1,this.error=!1}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e;return t.diagnostics=Object(c.a)(Array,l(this.diagnostics)),t.warning=this.warning,t.error=this.error,t}}]),e}(),Ue=function(){function e(){Object(s.a)(this,e),this.state=new _e,this.stateStack=new Array}return Object(o.a)(e,[{key:"log",value:function(e){this.state.diagnostics.push(e),e.severity===U.Warning&&(this.state.warning=!0),e.severity===U.Error&&(this.state.error=!0)}},{key:"saveState",value:function(){this.stateStack.push(this.state.copy())}},{key:"restoreState",value:function(){var e=this.stateStack.pop();void 0!==e?this.state=e:console.warn("Failed to restore diagnosis state, no state saved.")}},{key:"hasErrors",value:function(){return this.state.error}},{key:"hasWarnings",value:function(){return this.state.warning}},{key:"getDiagnostics",value:function(){return this.state.diagnostics}},{key:"print",value:function(e){var t=this;this.state.diagnostics.forEach((function(n){e("[".concat(n.range.start.line,":").concat(n.range.start.character,"]: ").concat(t.toString(n.severity),": ").concat(n.message,"."))}))}},{key:"toString",value:function(e){switch(e){case U.Error:return"Error";case U.Warning:return"Warning";case U.Information:return"Information";case U.Hint:return"Hint";default:return"undefined"}}}]),e}();!function(e){e.Null="\0",e.Backspace="\b",e.Space=" ",e.HorizontalTab="\t",e.VerticalTab="\v",e.FormFeed="\f",e.CarriageReturn="\r",e.LineFeed="\n",e.Backslash="\\",e.SingleQuote="'",e.DoubleQuote='"'}(Ve||(Ve={}));var We,Ge=function(){function e(){Object(s.a)(this,e),this.tokenCache=new Array,this.currentPosition=0,this.currentLinePosition=0,this.currentLine=0}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e;return t.tokenCache=Object(c.a)(Array,l(this.tokenCache)),t.currentPosition=this.currentPosition,t.currentLinePosition=this.currentLinePosition,t.currentLine=this.currentLine,t}}]),e}(),He=function(){function e(t,n,i){Object(s.a)(this,e),this.diagnosis=t,this.uri=n,this.code=Array.from(i),this.state=new Ge,this.stateStack=new Array}return Object(o.a)(e,[{key:"advance",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e>0&&!this.isEOT();)this.isLineFeed()?(this.state.currentLine=this.state.currentLine+1,this.state.currentLinePosition=0):this.state.currentLinePosition=this.state.currentLinePosition+1,this.state.currentPosition=this.state.currentPosition+1,e-=1}},{key:"getCurrentCharacter",value:function(){return this.isEOT()?void 0:this.code[this.state.currentPosition]}},{key:"createSourceLocation",value:function(e){return new g(this.uri,e)}},{key:"createSourcePosition",value:function(){return new v(this.state.currentLine,this.state.currentLinePosition)}},{key:"createEOTToken",value:function(){var e=this.createSourcePosition();return new E(this.createSourceLocation(new p(e,e)),h.EOT)}},{key:"isSpace",value:function(){return this.getCurrentCharacter()===Ve.Space}},{key:"isTab",value:function(){var e=this.getCurrentCharacter();return e===Ve.HorizontalTab||e===Ve.VerticalTab}},{key:"isFormFeed",value:function(){return this.getCurrentCharacter()===Ve.FormFeed}},{key:"isLineFeed",value:function(){return this.getCurrentCharacter()===Ve.LineFeed}},{key:"isCarriageReturn",value:function(){return this.getCurrentCharacter()===Ve.CarriageReturn}},{key:"isBackslash",value:function(){return this.getCurrentCharacter()===Ve.Backslash}},{key:"isLetter",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&(e>="a"&&e<="z"||e>="A"&&e<="Z")}},{key:"isDot",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&"."===e}},{key:"isEllipsis",value:function(){return this.isDot()&&this.state.currentPosition+1<this.code.length&&"."===this.code[this.state.currentPosition+1]}},{key:"isNumber",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&e>="0"&&e<="9"}},{key:"isHexCharacter",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&(e>="a"&&e<="f"||e>="A"&&e<="F")}},{key:"isDoubleQuote",value:function(){return this.getCurrentCharacter()===Ve.DoubleQuote}},{key:"isWhitespace",value:function(){return this.isSpace()||this.isTab()||this.isLineFeed()||this.isCarriageReturn()||this.isFormFeed()}},{key:"isEOT",value:function(){return this.state.currentPosition>=this.code.length}},{key:"isCommentStart",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&y(e)===h.OpenParentheses&&this.state.currentPosition+1<this.code.length&&y(this.code[this.state.currentPosition+1])===h.Asterisk}},{key:"isCommentEnd",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&y(e)===h.Asterisk&&this.state.currentPosition+1<this.code.length&&y(this.code[this.state.currentPosition+1])===h.CloseParentheses}},{key:"skipWhitespace",value:function(){for(var e=!1;this.isWhitespace();)e=!0,this.advance();return e}},{key:"skipComment",value:function(){var e=!1;if(this.isCommentStart()){for(e=!0,this.advance(2);!this.isEOT()&&!this.isCommentEnd();)this.advance();this.isEOT()||this.advance(2)}return e}},{key:"skipUntilWhitespace",value:function(){for(;!this.isWhitespace()&&!this.isEOT();)this.advance()}},{key:"readCharacter",value:function(){var e=this.getCurrentCharacter();if(this.isBackslash()){this.advance();var t=function(e){switch(e){case"0":return Ve.Null;case"b":return Ve.Backspace;case"t":return Ve.HorizontalTab;case"v":return Ve.VerticalTab;case"f":return Ve.FormFeed;case"r":return Ve.CarriageReturn;case"n":return Ve.LineFeed;case"\\":return Ve.Backslash;case"'":return Ve.SingleQuote;case'"':return Ve.DoubleQuote;default:return}}(this.getCurrentCharacter());if(void 0!==t)return this.advance(),t}return this.advance(),e}},{key:"readText",value:function(){var e="",t=this.createSourcePosition();for(this.advance();!this.isDoubleQuote();){var n=this.readCharacter();if(void 0===n)return new w(this.createSourceLocation(new p(t,this.createSourcePosition())));e+=n}if(this.isDoubleQuote()){this.advance();var i=this.createSourcePosition();return new ie(this.createSourceLocation(new p(t,i)),e)}return new w(this.createSourceLocation(new p(t,this.createSourcePosition())))}},{key:"readIdentifier",value:function(){for(var e="",t=this.createSourcePosition();!this.isEOT()&&(this.isLetter()||this.isNumber());)e+=this.getCurrentCharacter(),this.advance();var n=this.createSourceLocation(new p(t,this.createSourcePosition())),i=y(e);return void 0!==i?new E(n,i):new O(n,e)}},{key:"readFixToken",value:function(){var e=this.createSourcePosition(),t=this.getCurrentCharacter();if(void 0!==t){var n=y(t);if(this.advance(),void 0!==n){var i=this.getCurrentCharacter();if(void 0!==i)if(y(i)===h.Equal)switch(n){case h.Less:return this.advance(),new E(this.createSourceLocation(new p(e,this.createSourcePosition())),h.LessEqual);case h.Greater:return this.advance(),new E(this.createSourceLocation(new p(e,this.createSourcePosition())),h.GreaterEqual);case h.Colon:return this.advance(),new E(this.createSourceLocation(new p(e,this.createSourcePosition())),h.ColonEqual)}return new E(this.createSourceLocation(new p(e,this.createSourcePosition())),n)}}return new w(this.createSourceLocation(new p(e,this.createSourcePosition())))}},{key:"readScaleFactor",value:function(){var e=0;for(this.isNumber()||this.diagnosis.log(new qe(new p(this.createSourcePosition(),this.createSourcePosition()),U.Error,"Scale factor must be at least one digit long."));this.isNumber();){var t=this.getCurrentCharacter();void 0!==t&&(e=10*e+Number.parseInt(t),this.advance())}return e}},{key:"readNumber",value:function(){for(var e=this.createSourcePosition(),t=void 0,n=!1,i=!1,r=0;this.isNumber()||this.isHexCharacter();){if(this.isHexCharacter()&&(n=!0),t=void 0===t?this.getCurrentCharacter():t+this.getCurrentCharacter(),this.advance(),i&&n){this.skipUntilWhitespace(),this.diagnosis.log(new qe(new p(e,this.createSourcePosition()),U.Error,"Floating point hex numbers are not supported."));break}if(i&&(r-=1),this.isEllipsis())break;if(this.isDot()&&(this.advance(),i=!0),i&&"E"===this.getCurrentCharacter()){this.advance();var a=this.getCurrentCharacter(),s=1;"-"!==a&&"+"!==a||(s="-"===a?-1:1,this.advance()),r=s*this.readScaleFactor();break}}if(void 0===t)return new I(this.createSourceLocation(new p(e,this.createSourcePosition())),0);var o="H"===this.getCurrentCharacter()||"X"===this.getCurrentCharacter();return o&&this.advance(),n&&!o&&(this.skipUntilWhitespace(),this.diagnosis.log(new qe(new p(e,this.createSourcePosition()),U.Error,'Missing "H" or "X" after hex number'))),n||o?new S(this.createSourceLocation(new p(e,this.createSourcePosition())),Number.parseInt("0x"+t)):i?new ne(this.createSourceLocation(new p(e,this.createSourcePosition())),Number.parseInt(t),r):new I(this.createSourceLocation(new p(e,this.createSourcePosition())),Number.parseInt(t))}},{key:"readEllipsis",value:function(){var e=this.createSourcePosition();return this.advance(),this.advance(),new E(this.createSourceLocation(new p(e,this.createSourcePosition())),h.Ellipsis)}},{key:"read",value:function(){for(;!this.isEOT()&&(this.skipWhitespace()||this.skipComment()););return this.isEOT()?this.createEOTToken():this.isDoubleQuote()?this.readText():this.isLetter()?this.readIdentifier():this.isNumber()?this.readNumber():this.isEllipsis()?this.readEllipsis():this.readFixToken()}},{key:"getUri",value:function(){return this.uri}},{key:"saveState",value:function(){this.stateStack.push(this.state.copy())}},{key:"popSaveState",value:function(){this.stateStack.pop()}},{key:"restoreState",value:function(){var e=this.stateStack.pop();void 0!==e?this.state=e:console.warn("No lexer state to restore.")}},{key:"peek",value:function(e){if(e<1)throw RangeError("peek range must be greater than 0.");var t=this.state.tokenCache.length;if(e<=t)return this.state.tokenCache[e-1];do{if(t>0){var n=this.state.tokenCache[t-1];if(n instanceof E&&n.getTag()===h.EOT)return n}t=this.state.tokenCache.push(this.read())}while(e>t);return this.state.tokenCache[e-1]}},{key:"next",value:function(){var e=this.peek(1);return this.state.tokenCache.shift(),e}}]),e}(),Xe=function(){function e(t){Object(s.a)(this,e),this.location=t}return Object(o.a)(e,[{key:"getLocation",value:function(){return this.location}}]),e}(),Qe=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).name=i,r}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitAttribute(this)}}]),n}(Xe),ze=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).min=i,a.max=r,a}return Object(o.a)(n,[{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"accept",value:function(e){e.visitCardinality(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(We||(We={}));var Ye,Je=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=We.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitDeclaration(this)}}]),n}(Xe),Ke=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).name=i,u.attributes=r,u.offers=a,u.requires=o,u.body=c,u}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getOffers",value:function(){return this.offers}},{key:"getRequires",value:function(){return this.requires}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitComponent(this)}}]),n}(Je),$e=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).declarations=i,u.implementations=r,u.beginBlock=a,u.activityBlock=o,u.finallyBlock=c,u}return Object(o.a)(n,[{key:"getDeclarations",value:function(){return this.declarations}},{key:"getImplementations",value:function(){return this.implementations}},{key:"getBeginBlock",value:function(){return this.beginBlock}},{key:"getActivityBlock",value:function(){return this.activityBlock}},{key:"getFinallyBlock",value:function(){return this.finallyBlock}},{key:"accept",value:function(e){e.visitComponentBody(this)}}]),n}(Xe),Ze=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.expression=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitConstant(this)}}]),n}(Xe),et=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expression=i,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitConstantExpression(this)}}]),n}(Xe),tt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).constants=i,r}return Object(o.a)(n,[{key:"getConstants",value:function(){return this.constants}},{key:"accept",value:function(e){e.visitConstantList(this)}}]),n}(Je);!function(e){e[e.Tag=0]="Tag"}(Ye||(Ye={}));var nt,it=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._expressionTag=Ye.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitExpression(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(nt||(nt={}));var rt,at=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).attributes=i,r._attributedExpressionTag=nt.Tag,r}return Object(o.a)(n,[{key:"getAttributes",value:function(){return this.attributes}},{key:"accept",value:function(e){e.visitAttributedExpression(this)}}]),n}(it),st=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,i)).expression=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitUnaryExpression(this)}}]),n}(at);!function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.Less=2]="Less",e[e.LessEqual=3]="LessEqual",e[e.More=4]="More",e[e.MoreEqual=5]="MoreEqual"}(rt||(rt={}));var ot,ct=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o){var c;return Object(s.a)(this,n),(c=t.call(this,e,i)).left=r,c.op=a,c.right=o,c}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitBinaryExpression(this)}}]),n}(at);!function(e){e[e.Offers=0]="Offers",e[e.Requires=1]="Requires"}(ot||(ot={}));var ut,lt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).op=r,o.interfaces=a,o}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getInterfaces",value:function(){return this.interfaces}},{key:"accept",value:function(e){e.visitOffersRequiresExpression(this)}}]),n}(at),ht=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).designator=r,o.type=a,o}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitTypeCheck(this)}}]),n}(at);!function(e){e[e.Tag=0]="Tag"}(ut||(ut={}));var ft,vt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e))._simpleExpressionTag=ut.Tag,i}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitSimpleExpression(this)}}]),n}(it);!function(e){e[e.Plus=0]="Plus",e[e.Minus=1]="Minus"}(ft||(ft={}));var pt,gt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).op=i,a.term=r,a}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getTerm",value:function(){return this.term}},{key:"accept",value:function(e){e.visitUnaryTermNode(this)}}]),n}(vt);!function(e){e[e.Plus=0]="Plus",e[e.Minus=1]="Minus",e[e.Or=2]="Or"}(pt||(pt={}));var dt,mt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).left=i,a.right=r,a}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitTermChain(this)}}]),n}(vt),yt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).op=i,a.right=r,a}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitRightTerm(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(dt||(dt={}));var bt,kt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e))._termTag=dt.Tag,i}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitTerm(this)}}]),n}(vt),Tt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).left=i,a.right=r,a}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitFactorChain(this)}}]),n}(kt);!function(e){e[e.Times=0]="Times",e[e.Div=1]="Div",e[e.DivText=2]="DivText",e[e.ModText=3]="ModText",e[e.AndText=4]="AndText"}(bt||(bt={}));var wt,Et=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).op=i,a.right=r,a}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitRightFactor(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(wt||(wt={}));var Ot,xt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e))._factorTag=wt.Tag,i}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitFactor(this)}}]),n}(kt);!function(e){e[e.Not=0]="Not"}(Ot||(Ot={}));var Ct,St=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).prefix=i,a.factor=r,a}return Object(o.a)(n,[{key:"getPrefix",value:function(){return this.prefix}},{key:"getFactor",value:function(){return this.factor}},{key:"accept",value:function(e){e.visitUnaryFactor(this)}}]),n}(xt),jt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expresion=i,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expresion}},{key:"accept",value:function(e){e.visitExpressionFactor(this)}}]),n}(xt),It=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOperand(this)}}]),n}(xt),Lt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).value=i,r}return Object(o.a)(n,[{key:"getValue",value:function(){return this.value}},{key:"accept",value:function(e){e.visitNumber(this)}}]),n}(It);!function(e){e[e.Tag=0]="Tag"}(Ct||(Ct={}));var At,Pt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._integerNumberTag=Ct.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitIntegerNumber(this)}}]),n}(Lt);!function(e){e[e.Tag=0]="Tag"}(At||(At={}));var Ft,Nt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._realNumberTag=At.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRealNumber(this)}}]),n}(Lt),Rt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).character=i,r}return Object(o.a)(n,[{key:"getCharacter",value:function(){return this.character}},{key:"accept",value:function(e){e.visitConstantCharacter(this)}}]),n}(It),Dt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).text=i,r}return Object(o.a)(n,[{key:"getText",value:function(){return this.text}},{key:"accept",value:function(e){e.visitText(this)}}]),n}(It);!function(e){e[e.Any=0]="Any",e[e.Finish=1]="Finish"}(Ft||(Ft={}));var Mt,Bt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).designator=i,a.pattern=r,a}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getPattern",value:function(){return this.pattern}}]),n}(It);!function(e){e[e.Tag=0]="Tag"}(Mt||(Mt={}));var Vt,qt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Mt.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitReceiveTest(this)}}]),n}(Bt);!function(e){e[e.Tag=0]="Tag"}(Vt||(Vt={}));var _t,Ut=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Vt.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitInputTest(this)}}]),n}(Bt),Wt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).designator=i,r}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"accept",value:function(e){e.visitExistsTest(this)}}]),n}(It),Gt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.args=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getArguments",value:function(){return this.args}},{key:"accept",value:function(e){e.visitFunctionCall(this)}}]),n}(It);!function(e){e[e.Tag=0]="Tag"}(_t||(_t={}));var Ht,Xt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=_t.Tag,e}return n}(It),Qt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).name=i,r}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitBasicDesignator(this)}}]),n}(Xt),zt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.expressions=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getExpressions",value:function(){return this.expressions}},{key:"accept",value:function(e){e.visitBasicExpressionDesignator(this)}}]),n}(Xt),Yt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).base=i,a.target=r,a}return Object(o.a)(n,[{key:"getBase",value:function(){return this.base}},{key:"getTarget",value:function(){return this.target}},{key:"accept",value:function(e){e.visitBaseTargetDesignator(this)}}]),n}(Xt),Jt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).designator=i,a.type=r,a}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitDesignatorType(this)}}]),n}(Xt),Kt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).name=i,o.declarations=r,o.statements=a,o}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getDeclarations",value:function(){return this.declarations}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitImplementation(this)}}]),n}(Xe),$t=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.protocol=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getProtocol",value:function(){return this.protocol}},{key:"accept",value:function(e){e.visitInterface(this)}}]),n}(Je),Zt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expression=i,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitProtocol(this)}}]),n}(Xe),en=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).terms=i,r}return Object(o.a)(n,[{key:"getTerms",value:function(){return this.terms}},{key:"accept",value:function(e){e.visitProtocolExpression(this)}}]),n}(Xe),tn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).factors=i,r}return Object(o.a)(n,[{key:"getFactors",value:function(){return this.factors}},{key:"accept",value:function(e){e.visitProtocolTerm(this)}}]),n}(Xe),nn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.cardinality=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getCardinality",value:function(){return this.cardinality}},{key:"accept",value:function(e){e.visitInterfaceDeclaration(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(Ht||(Ht={}));var rn,an=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Ht.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOfferedInterface(this)}}]),n}(nn);!function(e){e[e.Tag=0]="Tag"}(rn||(rn={}));var sn,on=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=rn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRequiredInterfface(this)}}]),n}(nn),cn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).name=i,r}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitName(this)}}]),n}(Xe),un=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.params=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitIndexedName(this)}}]),n}(Xe),ln=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).names=i,a.type=r,a}return Object(o.a)(n,[{key:"getNames",value:function(){return this.names}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitParameter(this)}}]),n}(Xe),hn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).name=i,u.params=r,u.type=a,u.declarations=o,u.statements=c,u}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"getType",value:function(){return this.type}},{key:"getDeclarations",value:function(){return this.declarations}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitProcedure(this)}}]),n}(Je),fn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).mutable=i,a.parameter=r,a}return Object(o.a)(n,[{key:"isMutable",value:function(){return this.mutable}},{key:"getParameter",value:function(){return this.parameter}},{key:"accept",value:function(e){e.visitProcedureParameter(this)}}]),n}(Xe),vn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).components=i,a.interfaces=r,a}return Object(o.a)(n,[{key:"getComponents",value:function(){return this.components}},{key:"getInterfaces",value:function(){return this.interfaces}},{key:"accept",value:function(e){e.visitProgram(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(sn||(sn={}));var pn,gn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e))._protocolFactorTag=sn.Tag,i}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitProtocolFactor(this)}}]),n}(Xe);!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(pn||(pn={}));var dn,mn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).direction=i,o.name=r,o.params=a,o}return Object(o.a)(n,[{key:"getDirection",value:function(){return this.direction}},{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitMessageDeclaration(this)}}]),n}(gn);!function(e){e[e.Tag=0]="Tag"}(dn||(dn={}));var yn,bn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expression=i,r._protocolFactorExpressionTag=dn.Tag,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitProtocolFactorExpression(this)}}]),n}(gn);!function(e){e[e.Tag=0]="Tag"}(yn||(yn={}));var kn,Tn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=yn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOptionalProtocolFactorExpression(this)}}]),n}(bn);!function(e){e[e.Tag=0]="Tag"}(kn||(kn={}));var wn,En=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=kn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRepeatingProtocolFactorExpression(this)}}]),n}(bn);!function(e){e[e.Tag=0]="Tag"}(wn||(wn={}));var On,xn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=wn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitGroupProtocolFactorExpression(this)}}]),n}(bn);!function(e){e[e.Tag=0]="Tag"}(On||(On={}));var Cn,Sn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._statementTag=On.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitStatement(this)}}]),n}(Xe),jn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=i,a.params=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitProcedureCall(this)}}]),n}(Sn),In=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).designator=i,a.expression=r,a}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitAssignment(this)}}]),n}(Sn),Ln=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).designator=i,a.args=r,a}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getArgs",value:function(){return this.args}},{key:"accept",value:function(e){e.visitNew(this)}}]),n}(Sn),An=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).what=i,a.to=r,a}return Object(o.a)(n,[{key:"getWhat",value:function(){return this.what}},{key:"getTo",value:function(){return this.to}},{key:"accept",value:function(e){e.visitConnect(this)}}]),n}(Sn),Pn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).what=i,r}return Object(o.a)(n,[{key:"getWhat",value:function(){return this.what}},{key:"accept",value:function(e){e.visitDisconnect(this)}}]),n}(Sn),Fn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).from=i,o.target=r,o.args=a,o}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getTarget",value:function(){return this.target}},{key:"getArgs",value:function(){return this.args}},{key:"accept",value:function(e){e.visitSend(this)}}]),n}(Sn),Nn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).from=i,o.receiver=r,o.targets=a,o}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getReceiver",value:function(){return this.receiver}},{key:"getTargets",value:function(){return this.targets}},{key:"accept",value:function(e){e.visitReceive(this)}}]),n}(Sn),Rn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).target=i,r}return Object(o.a)(n,[{key:"getTarget",value:function(){return this.target}},{key:"accept",value:function(e){e.visitDelete(this)}}]),n}(Sn),Dn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).from=i,a.to=r,a}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getTo",value:function(){return this.to}},{key:"accept",value:function(e){e.visitMove(this)}}]),n}(Sn),Mn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expression=i,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitAwait(this)}}]),n}(Sn),Bn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).expression=i,r}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitReturn(this)}}]),n}(Sn),Vn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o){var c;return Object(s.a)(this,n),(c=t.call(this,e)).expression=i,c.then=r,c.elseIfs=a,c.elseNode=o,c}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"getThen",value:function(){return this.then}},{key:"getElseIfs",value:function(){return this.elseIfs}},{key:"getElse",value:function(){return this.elseNode}},{key:"accept",value:function(e){e.visitIf(this)}}]),n}(Sn),qn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=i,a.then=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"getThen",value:function(){return this.then}},{key:"accept",value:function(e){e.visitElseIf(this)}}]),n}(Sn),_n=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=i,a.body=r,a}return Object(o.a)(n,[{key:"getExpresssion",value:function(){return this.expression}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitWhile(this)}}]),n}(Sn),Un=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).body=i,a.expression=r,a}return Object(o.a)(n,[{key:"getBody",value:function(){return this.body}},{key:"getExpresssion",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitRepeat(this)}}]),n}(Sn),Wn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).designator=i,u.expression=r,u.to=a,u.by=o,u.statements=c,u}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getExpression",value:function(){return this.expression}},{key:"getTo",value:function(){return this.to}},{key:"getBy",value:function(){return this.by}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitFor(this)}}]),n}(Sn),Gn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).designators=i,o.of=r,o.body=a,o}return Object(o.a)(n,[{key:"getDesignators",value:function(){return this.designators}},{key:"getOf",value:function(){return this.of}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitForeach(this)}}]),n}(Sn),Hn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).statements=i,r}return Object(o.a)(n,[{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitStatementBlock(this)}}]),n}(Sn),Xn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).attributes=i,a.statements=r,a}return Object(o.a)(n,[{key:"getAttributes",value:function(){return this.attributes}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitStatementSequence(this)}}]),n}(Xe);!function(e){e[e.Tag=0]="Tag"}(Cn||(Cn={}));var Qn,zn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Cn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitType(this)}}]),n}(Xe),Yn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).identifier=i,r}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}},{key:"accept",value:function(e){e.visitBasicType(this)}}]),n}(zn),Jn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).offered=i,a.required=r,a}return Object(o.a)(n,[{key:"getOffered",value:function(){return this.offered}},{key:"getRequired",value:function(){return this.required}},{key:"accept",value:function(e){e.visitAnyType(this)}}]),n}(zn),Kn=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e)).names=i,o.type=r,o.attributes=a,o}return Object(o.a)(n,[{key:"getNames",value:function(){return this.names}},{key:"getType",value:function(){return this.type}},{key:"getAttributes",value:function(){return this.attributes}},{key:"accept",value:function(e){e.visitVariable(this)}}]),n}(Xe),$n=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).variables=i,r}return Object(o.a)(n,[{key:"getVariables",value:function(){return this.variables}},{key:"accept",value:function(e){e.visitVariableList(this)}}]),n}(Je),Zn=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"visitProtocolFactor",value:function(e){e instanceof mn?this.visitMessageDeclaration(e):e instanceof bn&&this.visitProtocolFactorExpression(e)}},{key:"visitMessageDeclaration",value:function(e){}},{key:"visitProtocolFactorExpression",value:function(e){e instanceof Tn?this.visitOptionalProtocolFactorExpression(e):e instanceof En?this.visitRepeatingProtocolFactorExpression(e):e instanceof xn&&this.visitGroupProtocolFactorExpression(e)}},{key:"visitOptionalProtocolFactorExpression",value:function(e){}},{key:"visitGroupProtocolFactorExpression",value:function(e){}},{key:"visitRepeatingProtocolFactorExpression",value:function(e){}},{key:"visitType",value:function(e){e instanceof Yn?this.visitBasicType(e):e instanceof Jn&&this.visitAnyType(e)}},{key:"visitBasicType",value:function(e){}},{key:"visitAnyType",value:function(e){}},{key:"visitDesignator",value:function(e){e instanceof Qt?this.visitBasicDesignator(e):e instanceof zt?this.visitBasicExpressionDesignator(e):e instanceof Yt?this.visitBaseTargetDesignator(e):e instanceof Jt&&this.visitDesignatorType(e)}},{key:"visitBasicDesignator",value:function(e){}},{key:"visitBasicExpressionDesignator",value:function(e){}},{key:"visitBaseTargetDesignator",value:function(e){}},{key:"visitDesignatorType",value:function(e){}},{key:"visitInterfaceDeclaration",value:function(e){e instanceof an?this.visitOfferedInterface(e):e instanceof on&&this.visitRequiredInterfface(e)}},{key:"visitOfferedInterface",value:function(e){}},{key:"visitRequiredInterfface",value:function(e){}},{key:"visitName",value:function(e){}},{key:"visitIndexedName",value:function(e){}},{key:"visitCardinality",value:function(e){}},{key:"visitProgram",value:function(e){}},{key:"visitDeclaration",value:function(e){e instanceof Ke?this.visitComponent(e):e instanceof $t?this.visitInterface(e):e instanceof tt?this.visitConstantList(e):e instanceof $n?this.visitVariableList(e):e instanceof hn&&this.visitProcedure(e)}},{key:"visitComponent",value:function(e){}},{key:"visitInterface",value:function(e){}},{key:"visitConstantList",value:function(e){}},{key:"visitVariableList",value:function(e){}},{key:"visitProcedure",value:function(e){}},{key:"visitProcedureParameter",value:function(e){}},{key:"visitComponentBody",value:function(e){}},{key:"visitImplementation",value:function(e){}},{key:"visitProtocol",value:function(e){}},{key:"visitProtocolExpression",value:function(e){}},{key:"visitProtocolTerm",value:function(e){}},{key:"visitAttribute",value:function(e){}},{key:"visitStatementSequence",value:function(e){}},{key:"visitParameter",value:function(e){}},{key:"visitConstant",value:function(e){}},{key:"visitConstantExpression",value:function(e){}},{key:"visitVariable",value:function(e){}},{key:"visitStatement",value:function(e){e instanceof jn?this.visitProcedureCall(e):e instanceof In?this.visitAssignment(e):e instanceof Ln?this.visitNew(e):e instanceof An?this.visitConnect(e):e instanceof Pn?this.visitDisconnect(e):e instanceof Fn?this.visitSend(e):e instanceof Nn?this.visitReceive(e):e instanceof Rn?this.visitDelete(e):e instanceof Dn?this.visitMove(e):e instanceof Mn?this.visitAwait(e):e instanceof Bn?this.visitReturn(e):e instanceof Vn?this.visitIf(e):e instanceof qn?this.visitElseIf(e):e instanceof _n?this.visitWhile(e):e instanceof Un?this.visitRepeat(e):e instanceof Wn?this.visitFor(e):e instanceof Gn?this.visitForeach(e):e instanceof Hn&&this.visitStatementBlock(e)}},{key:"visitProcedureCall",value:function(e){}},{key:"visitAssignment",value:function(e){}},{key:"visitNew",value:function(e){}},{key:"visitConnect",value:function(e){}},{key:"visitDisconnect",value:function(e){}},{key:"visitSend",value:function(e){}},{key:"visitReceive",value:function(e){}},{key:"visitDelete",value:function(e){}},{key:"visitMove",value:function(e){}},{key:"visitAwait",value:function(e){}},{key:"visitReturn",value:function(e){}},{key:"visitIf",value:function(e){}},{key:"visitElseIf",value:function(e){}},{key:"visitWhile",value:function(e){}},{key:"visitRepeat",value:function(e){}},{key:"visitFor",value:function(e){}},{key:"visitForeach",value:function(e){}},{key:"visitStatementBlock",value:function(e){}},{key:"visitExpression",value:function(e){e instanceof vt?this.visitSimpleExpression(e):e instanceof at&&this.visitAttributedExpression(e)}},{key:"visitAttributedExpression",value:function(e){e instanceof vt?this.visitSimpleExpression(e):e instanceof st?this.visitUnaryExpression(e):e instanceof ct?this.visitBinaryExpression(e):e instanceof lt?this.visitOffersRequiresExpression(e):e instanceof ht&&this.visitTypeCheck(e)}},{key:"visitUnaryExpression",value:function(e){}},{key:"visitBinaryExpression",value:function(e){}},{key:"visitOffersRequiresExpression",value:function(e){}},{key:"visitTypeCheck",value:function(e){}},{key:"visitSimpleExpression",value:function(e){e instanceof gt?this.visitUnaryTermNode(e):e instanceof mt?this.visitTermChain(e):e instanceof kt&&this.visitTerm(e)}},{key:"visitUnaryTermNode",value:function(e){}},{key:"visitTermChain",value:function(e){}},{key:"visitRightTerm",value:function(e){}},{key:"visitTerm",value:function(e){e instanceof xt?this.visitFactor(e):e instanceof Tt?this.visitFactorChain(e):e instanceof Et&&this.visitRightFactor(e)}},{key:"visitFactorChain",value:function(e){}},{key:"visitRightFactor",value:function(e){}},{key:"visitFactor",value:function(e){e instanceof St?this.visitUnaryFactor(e):e instanceof Rt?this.visitConstantCharacter(e):e instanceof It&&this.visitOperand(e)}},{key:"visitUnaryFactor",value:function(e){}},{key:"visitExpressionFactor",value:function(e){}},{key:"visitOperand",value:function(e){e instanceof Lt?this.visitNumber(e):e instanceof Rt?this.visitConstantCharacter(e):e instanceof Dt?this.visitText(e):e instanceof qt?this.visitReceiveTest(e):e instanceof Ut?this.visitInputTest(e):e instanceof Wt?this.visitExistsTest(e):e instanceof Gt?this.visitFunctionCall(e):e instanceof Xt&&this.visitDesignator(e)}},{key:"visitNumber",value:function(e){e instanceof Pt?this.visitIntegerNumber(e):e instanceof Nt&&this.visitRealNumber(e)}},{key:"visitIntegerNumber",value:function(e){}},{key:"visitRealNumber",value:function(e){}},{key:"visitConstantCharacter",value:function(e){}},{key:"visitText",value:function(e){}},{key:"visitReceiveTest",value:function(e){}},{key:"visitInputTest",value:function(e){}},{key:"visitExistsTest",value:function(e){}},{key:"visitFunctionCall",value:function(e){}}]),e}();!function(e){e.New="NEW",e.Conncet="CONNECT",e.Disconnect="DISCONNECT",e.Delete="DELETE",e.Move="MOVE",e.Await="AWAIT",e.Input="INPUT",e.Exists="EXISTS"}(Qn||(Qn={}));var ei,ti=function(){function e(t,n){Object(s.a)(this,e),this.diagnosis=t,this.lexer=n}return Object(o.a)(e,[{key:"hasTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.lexer.peek(t);return this.isTaggedFixToken(n,e)}},{key:"isTaggedFixToken",value:function(e,t){return e instanceof E&&e.getTag()===t}},{key:"hasIdentifier",value:function(e){var t=this.lexer.peek(1);return t instanceof O&&t.getIdentifier()===e}},{key:"isComponent",value:function(){return this.hasTag(h.Component)}},{key:"isInterface",value:function(){return this.hasTag(h.Interface)}},{key:"isEOT",value:function(){return this.hasTag(h.EOT)}},{key:"error",value:function(e){var t=this.lexer.peek(1).getLocation().range;throw this.diagnosis.log(new qe(t,U.Error,e)),new Error("[".concat(t.start.line,",").concat(t.start.character,":").concat(t.end.line,",").concat(t.end.character,"]: ").concat(e))}},{key:"loop",value:function(e,t){for(;e()&&!this.isEOT();)t()}},{key:"expectConsumeFixToken",value:function(e){if(!this.tryConsumeFixToken(e)){var t="Expected FixToken with Tag ".concat(e);this.error(t)}}},{key:"tryConsumeFixToken",value:function(e){return!!this.hasTag(e)&&(this.lexer.next(),!0)}},{key:"expectConsumeIdentifierToken",value:function(e){if(!this.tryConsumeIdentifierToken(e)){var t="Expected IdentifierToken with Identifier ".concat(e);this.error(t)}}},{key:"tryParse",value:function(e){try{this.diagnosis.saveState(),this.lexer.saveState();var t=e();return this.lexer.popSaveState(),t}catch(n){return this.diagnosis.restoreState(),void this.lexer.restoreState()}}},{key:"tryConsumeIdentifierToken",value:function(e){return!!this.hasIdentifier(e)&&(this.lexer.next(),!0)}},{key:"parseName",value:function(){var e=this.lexer.peek(1);if(e instanceof O)return this.lexer.next(),new cn(e.getLocation(),e.getIdentifier());return this.error("Failed to parse identifier name")}},{key:"parseIndexedName",value:function(){var e=this.lexer.peek(1);if(!(e instanceof O))return this.error("Failed to parse indexed name.");if(this.lexer.next(),this.tryConsumeFixToken(h.OpenSquareBracket)){var t=this.parseParameterList(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseSquareBracket),new un(g.merge(e.getLocation(),n),e.getIdentifier(),t)}return new un(e.getLocation(),e.getIdentifier(),new Array)}},{key:"parseCardinality",value:function(){if(this.hasTag(h.OpenSquareBracket)){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.OpenSquareBracket);var t=this.lexer.next();if(!(t instanceof I))return this.error("Expected number token.");var n=t.getNumber(),i=n;this.tryConsumeFixToken(h.Ellipsis)&&((t=this.lexer.peek(1))instanceof I?(this.lexer.next(),i=t.getNumber()):this.hasTag(h.Asterisk)?(this.lexer.next(),i=1/0):this.error('Expected number or "*".'));var r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseSquareBracket),new ze(g.merge(e,r),n,i)}}},{key:"parseInterfaceDeclaration",value:function(e){var t=this.parseName(),n=this.parseCardinality();return new e(void 0===n?t.getLocation():g.merge(t.getLocation(),n.getLocation()),t,n)}},{key:"parseOfferedInterfaceDeclaration",value:function(){return this.parseInterfaceDeclaration(an)}},{key:"parseRequiredInterfaceDeclaration",value:function(){return this.parseInterfaceDeclaration(on)}},{key:"parseOffers",value:function(){var e=new Array;return this.tryConsumeFixToken(h.Offers)&&e.push.apply(e,l(this.parseOfferedInterfaceDeclarationList())),e}},{key:"parseRequires",value:function(){var e=new Array;return this.tryConsumeFixToken(h.Requires)&&e.push.apply(e,l(this.parseRequiredInterfaceDeclarationList())),e}},{key:"parseFunctionCall",value:function(){var e=this.parseName();this.expectConsumeFixToken(h.OpenParentheses);var t=new Array;this.hasTag(h.CloseParentheses)||t.push.apply(t,l(this.parseExpressionList()));var n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Gt(g.merge(e.getLocation(),n),e,t)}},{key:"parseMessagePattern",value:function(){return this.tryConsumeFixToken(h.Any)?Ft.Any:this.tryConsumeFixToken(h.Finish)?Ft.Finish:this.parseName()}},{key:"tryParseExpression",value:function(){return this.tryParse(this.parseExpression.bind(this))}},{key:"parseReceiveTestExpression",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.QuestionMark);var i=this.lexer.peek(1).getLocation(),r=this.parseMessagePattern();return new qt(g.merge(n,i),e,r)}},{key:"parseInputTestExpression",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Input),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator();if(!this.hasTag(h.Comma)){if(t instanceof Qt){var n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Ut(g.merge(e,n),void 0,t.getName())}this.error("Failed parsing input test node.")}this.expectConsumeFixToken(h.Comma);var i=this.parseMessagePattern(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Ut(g.merge(e,r),t,i)}},{key:"parseExistsExpression",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Exists),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Wt(g.merge(e,n),t)}},{key:"parseOperand",value:function(){var e=this.lexer.peek(1);if(e instanceof ie){this.lexer.next();var t=e.getText();return 1===t.length?new Rt(e.getLocation(),t):new Dt(e.getLocation(),t)}if(e instanceof I)return this.lexer.next(),new Pt(e.getLocation(),e.getNumber());if(e instanceof S)return this.lexer.next(),new Pt(e.getLocation(),e.getNumber());if(e instanceof ne)return this.lexer.next(),new Nt(e.getLocation(),e.getNumber());if(this.hasIdentifier(Qn.Input))return this.parseInputTestExpression();if(this.hasIdentifier(Qn.Exists))return this.parseExistsExpression();var n=this.tryParseDesignator();return this.hasTag(h.QuestionMark)?this.parseReceiveTestExpression(n):void 0===n?this.parseFunctionCall():n}},{key:"parseFactor",value:function(){var e=this.lexer.peek(1).getLocation();if(this.tryConsumeFixToken(h.Tilde)){var t=this.parseFactor();return new St(g.merge(e,t.getLocation()),Ot.Not,t)}if(this.tryConsumeFixToken(h.OpenParentheses)){var n=this.parseExpression(),i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new jt(g.merge(e,i),n)}return this.parseOperand()}},{key:"isFactorInfix",value:function(){return this.hasTag(h.Asterisk)||this.hasTag(h.Slash)||this.hasTag(h.Div)||this.hasTag(h.Mod)||this.hasTag(h.And)}},{key:"parseFactorInfix",value:function(){return this.tryConsumeFixToken(h.Asterisk)?bt.Times:this.tryConsumeFixToken(h.Slash)?bt.Div:this.tryConsumeFixToken(h.Div)?bt.DivText:this.tryConsumeFixToken(h.Mod)?bt.ModText:this.tryConsumeFixToken(h.And)?bt.AndText:this.error("Failed to parse factor infix.")}},{key:"parseRightFactor",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseFactorInfix(),n=this.parseFactor();return new Et(g.merge(e,n.getLocation()),t,n)}},{key:"parseTerm",value:function(){var e=this.parseFactor();if(!this.isFactorInfix())return e;var t=this.parseListWithPredicate(this.parseRightFactor.bind(this),this.isFactorInfix.bind(this));return new Tt(g.merge(e.getLocation(),t[t.length-1].getLocation()),e,t)}},{key:"isTermInfix",value:function(){return this.hasTag(h.Plus)||this.hasTag(h.Minus)||this.hasTag(h.Or)}},{key:"parseTermInfix",value:function(){return this.tryConsumeFixToken(h.Plus)?pt.Plus:this.tryConsumeFixToken(h.Minus)?pt.Minus:this.tryConsumeFixToken(h.Or)?pt.Or:this.error("Failed to parse term infix.")}},{key:"parseRightTerm",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseTermInfix(),n=this.parseTerm();return new yt(g.merge(e,n.getLocation()),t,n)}},{key:"isTermPrefix",value:function(){return this.hasTag(h.Plus)||this.hasTag(h.Minus)}},{key:"parseUnaryPrefix",value:function(){return this.tryConsumeFixToken(h.Plus)?ft.Plus:this.tryConsumeFixToken(h.Minus)?ft.Minus:this.error("Failed to parse prefix operator.")}},{key:"parseUnaryTerm",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseUnaryPrefix(),n=this.parseTerm();return new gt(g.merge(e,n.getLocation()),t,n)}},{key:"parseSimpleExpression",value:function(){var e=this.isTermPrefix()?this.parseUnaryTerm():this.parseTerm();if(!this.isTermInfix())return e;var t=this.parseListWithPredicate(this.parseRightTerm.bind(this),this.isTermInfix.bind(this));return new mt(g.merge(e.getLocation(),t[t.length-1].getLocation()),e,t)}},{key:"isBinaryExpressionOperator",value:function(){return this.hasTag(h.Equal)||this.hasTag(h.NumberSign)||this.hasTag(h.Less)||this.hasTag(h.LessEqual)||this.hasTag(h.Greater)||this.hasTag(h.GreaterEqual)}},{key:"parseBinaryExpressionOperator",value:function(){return this.tryConsumeFixToken(h.Equal)?rt.Equal:this.tryConsumeFixToken(h.NumberSign)?rt.NotEqual:this.tryConsumeFixToken(h.Less)?rt.Less:this.tryConsumeFixToken(h.LessEqual)?rt.LessEqual:this.tryConsumeFixToken(h.Greater)?rt.More:this.tryConsumeFixToken(h.GreaterEqual)?rt.MoreEqual:this.error("Failed to parse term infix.")}},{key:"parseBinaryExpression",value:function(e,t,n){var i=this.parseBinaryExpressionOperator(),r=this.parseSimpleExpression();return new ct(g.merge(e,r.getLocation()),t,n,i,r)}},{key:"parseExpression",value:function(){var e=this.parseAttributeList(),t=this.parseSimpleExpression();if(t instanceof Xt){var n=0===e.length?t.getLocation():e[0].getLocation();if(this.tryConsumeFixToken(h.Offers)){var i=this.parseOfferedInterfaceDeclarationList();return new lt(g.merge(n,i[i.length-1].getLocation()),e,ot.Offers,i)}if(this.tryConsumeFixToken(h.Requires)){var r=this.parseRequiredInterfaceDeclarationList();return new lt(g.merge(n,r[r.length-1].getLocation()),e,ot.Requires,r)}if(this.tryConsumeFixToken(h.Is)){var a=this.parseType();return new ht(g.merge(n,a.getLocation()),e,t,a)}return this.isBinaryExpressionOperator()?this.parseBinaryExpression(n,e,t):t}var s=0===e.length?t.getLocation():e[0].getLocation();return this.isBinaryExpressionOperator()?this.parseBinaryExpression(s,e,t):new st(g.merge(s,t.getLocation()),e,t)}},{key:"parseProcedureCall",value:function(){var e=this.parseName(),t=new Array,n=e.getLocation();return this.tryConsumeFixToken(h.OpenParentheses)&&(t.push.apply(t,l(this.parseExpressionList())),n=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(h.CloseParentheses)),new jn(g.merge(e.getLocation(),n),e,t)}},{key:"parseStatementSequenceBlock",value:function(e){var t=void 0;if(this.hasTag(e)){var n=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(e),t=this.parseStatementSequence(n)}return t}},{key:"parseBasicDesignator",value:function(){var e=this.parseName();if(this.tryConsumeFixToken(h.OpenSquareBracket)){var t=this.parseExpressionList(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseSquareBracket),new zt(g.merge(e.getLocation(),n),e,t)}return new Qt(e.getLocation(),e)}},{key:"parseDesignator",value:function(){var e=this.parseBasicDesignator();if(this.tryConsumeFixToken(h.OpenParentheses)){if(this.hasTag(h.Any)){var t=this.parseType(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Jt(g.merge(e.getLocation(),n),e,t)}var i=this.parseDesignator(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Yt(g.merge(e.getLocation(),r),e,i)}return e}},{key:"tryParseDesignator",value:function(){return this.tryParse(this.parseDesignator.bind(this))}},{key:"parseStatementSequence",value:function(e){var t=this.parseAttributeList(),n=this.parseStatementList(),i=n[n.length-1].getLocation();return new Xn(g.merge(e,i),t,n)}},{key:"parseNewStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.New),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator(),n=new Array;this.tryConsumeFixToken(h.Comma)&&n.push.apply(n,l(this.parseExpressionList()));var i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Ln(g.merge(e,i),t,n)}},{key:"parseDeleteStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Delete),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Rn(g.merge(e,n),t)}},{key:"parseConnectStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Conncet),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator();this.expectConsumeFixToken(h.Comma);var n=this.parseDesignator(),i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new An(g.merge(e,i),t,n)}},{key:"parseDisconnectStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Disconnect),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Pn(g.merge(e,n),t)}},{key:"parseMoveStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Move),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseDesignator();this.expectConsumeFixToken(h.Comma);var n=this.parseDesignator(),i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Dn(g.merge(e,i),t,n)}},{key:"parseAwaitStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(Qn.Await),this.expectConsumeFixToken(h.OpenParentheses);var t=this.parseExpression(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.CloseParentheses),new Mn(g.merge(e,n),t)}},{key:"parseSendStatement",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.ExclamationMark);var i=this.parseName(),r=new Array,a=i.getLocation();return this.tryConsumeFixToken(h.OpenParentheses)&&(r.push.apply(r,l(this.parseExpressionList())),a=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(h.CloseParentheses)),new Fn(g.merge(n,a),e,i,r)}},{key:"parseReceiveStatement",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.QuestionMark);var i=this.parseName(),r=new Array,a=i.getLocation();return this.tryConsumeFixToken(h.OpenParentheses)&&(r.push.apply(r,l(this.parseDesignatorList())),a=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(h.CloseParentheses)),new Nn(g.merge(n,a),e,i,r)}},{key:"parseAssignmentStatement",value:function(e){this.expectConsumeFixToken(h.ColonEqual);var t=this.parseExpression();return new In(g.merge(e.getLocation(),t.getLocation()),e,t)}},{key:"parseReturnStatement",value:function(){var e,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Return);var n=this.tryParseExpression();return new Bn(g.merge(t,null!==(e=null===n||void 0===n?void 0:n.getLocation())&&void 0!==e?e:t),n)}},{key:"parseIfStatement",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.If);var n=this.parseExpression();this.expectConsumeFixToken(h.Then);var i=this.parseStatementSequence(this.lexer.peek(1).getLocation()),r=new Array;this.loop((function(){return e.hasTag(h.Elsif)}),(function(){var t=e.lexer.peek(1).getLocation();e.expectConsumeFixToken(h.Elsif);var n=e.parseExpression();e.expectConsumeFixToken(h.Then);var i=e.parseStatementSequence(e.lexer.peek(1).getLocation());r.push(new qn(g.merge(t,i.getLocation()),n,i))}));var a=void 0;this.tryConsumeFixToken(h.Else)&&(a=this.parseStatementSequence(this.lexer.peek(1).getLocation()));var s=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.End),new Vn(g.merge(t,s),n,i,r,a)}},{key:"parseWhileStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.While);var t=this.parseExpression();this.expectConsumeFixToken(h.Do);var n=this.parseStatementSequence(this.lexer.peek(1).getLocation()),i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.End),new _n(g.merge(e,i),t,n)}},{key:"parseRepeatStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Repeat);var t=this.parseStatementSequence(this.lexer.peek(1).getLocation());this.expectConsumeFixToken(h.Until);var n=this.parseExpression();return new Un(g.merge(e,n.getLocation()),t,n)}},{key:"parseForStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.For);var t=this.parseDesignator();this.expectConsumeFixToken(h.ColonEqual);var n=this.parseExpression();this.expectConsumeFixToken(h.To);var i=this.parseExpression(),r=void 0;this.tryConsumeFixToken(h.By)&&(r=this.parseConstantExpression()),this.expectConsumeFixToken(h.Do);var a=this.parseStatementSequence(this.lexer.peek(1).getLocation()),s=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.End),new Wn(g.merge(e,s),t,n,i,r,a)}},{key:"parseForeachStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Foreach);var t=this.parseDesignatorList();this.expectConsumeFixToken(h.Of);var n=this.parseDesignator();this.expectConsumeFixToken(h.Do);var i=this.parseStatementSequence(this.lexer.peek(1).getLocation()),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.End),new Gn(g.merge(e,r),t,n,i)}},{key:"parseStatementBlock",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Begin);var t=this.parseStatementSequence(this.lexer.peek(1).getLocation()),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.End),new Hn(g.merge(e,n),t)}},{key:"parseStatement",value:function(){if(this.hasIdentifier(Qn.New))return this.parseNewStatement();if(this.hasIdentifier(Qn.Delete))return this.parseDeleteStatement();if(this.hasIdentifier(Qn.Conncet))return this.parseConnectStatement();if(this.hasIdentifier(Qn.Disconnect))return this.parseDisconnectStatement();if(this.hasIdentifier(Qn.Move))return this.parseMoveStatement();if(this.hasIdentifier(Qn.Await))return this.parseAwaitStatement();if(this.hasTag(h.Return))return this.parseReturnStatement();if(this.hasTag(h.If))return this.parseIfStatement();if(this.hasTag(h.While))return this.parseWhileStatement();if(this.hasTag(h.Repeat))return this.parseRepeatStatement();if(this.hasTag(h.For))return this.parseForStatement();if(this.hasTag(h.Foreach))return this.parseForeachStatement();if(this.hasTag(h.Begin))return this.parseStatementBlock();var e=this.tryParseDesignator();if(this.hasTag(h.ExclamationMark))return this.parseSendStatement(e);if(this.hasTag(h.QuestionMark))return this.parseReceiveStatement(e);if(void 0===e)return this.parseProcedureCall();if(this.hasTag(h.ColonEqual))return this.parseAssignmentStatement(e);if(e instanceof Qt)return new jn(e.getLocation(),e.getName(),new Array);if(e instanceof Yt){var t=e.getBase();if(t instanceof Qt)return new jn(e.getLocation(),t.getName(),new Array(e.getTarget()))}return this.error("Failed to parse statement. Unknown statement.")}},{key:"parseConstantExpression",value:function(){var e=this.parseExpression();return new et(e.getLocation(),e)}},{key:"parseConstant",value:function(){var e=this.parseName();this.expectConsumeFixToken(h.Equal);var t=this.parseConstantExpression(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.Semicolon),new Ze(g.merge(e.getLocation(),n),e,t)}},{key:"tryParseConstant",value:function(){return this.tryParse(this.parseConstant.bind(this))}},{key:"parseConstantList",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Constant);var n=new f.b(this.parseConstant()),i=!0;return this.loop((function(){return i}),(function(){var t=e.tryParseConstant();void 0!==t?n.push(t):i=!1})),new tt(g.merge(t,n[n.length-1].getLocation()),n)}},{key:"parseVariable",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseIndexedIdentifierList();this.expectConsumeFixToken(h.Colon);var n=this.parseType(),i=this.parseAttributeList(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.Semicolon),new Kn(g.merge(e,r),t,n,i)}},{key:"tryParseVariable",value:function(){return this.tryParse(this.parseVariable.bind(this))}},{key:"parseVariableList",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Variable);var n=new f.b(this.parseVariable()),i=!0;return this.loop((function(){return i}),(function(){var t=e.tryParseVariable();void 0!==t?n.push(t):i=!1})),new $n(g.merge(t,n[n.length-1].getLocation()),n)}},{key:"parseProcedure",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Procedure);var n=this.parseName(),i=new Array;this.tryConsumeFixToken(h.OpenParentheses)&&(this.hasTag(h.CloseParentheses)||i.push.apply(i,l(this.parseProcedureParameterList())),this.expectConsumeFixToken(h.CloseParentheses));var r=this.tryConsumeFixToken(h.Colon)?this.parseType():void 0;this.expectConsumeFixToken(h.Semicolon);var a=new Array,s=void 0,o=!1;this.loop((function(){return!e.hasTag(h.End)&&!o}),(function(){var t=e.parseDeclaration();void 0===t?void 0!==s?o=!0:s=e.parseStatementSequenceBlock(h.Begin):a.push(t)}));var c=this.consumeEnd(n);return new hn(g.merge(t,c),n,i,r,a,s)}},{key:"parseDeclaration",value:function(){return this.hasTag(h.Component)?this.parseComponent():this.hasTag(h.Interface)?this.parseInterface():this.hasTag(h.Constant)?this.parseConstantList():this.hasTag(h.Variable)?this.parseVariableList():this.hasTag(h.Procedure)?this.parseProcedure():void 0}},{key:"parseComponentBody",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=void 0,i=void 0,r=void 0,a=new Array,s=new Array,o=t,c=!1;return this.loop((function(){return!e.hasTag(h.End)&&!c}),(function(){var t=e.parseDeclaration();if(void 0===t)if(e.hasTag(h.Implementation))s.push(e.parseImplementation());else if(void 0!==n&&e.hasTag(h.Begin)&&e.error("Cannot have more than one begin per component."),void 0===n&&e.hasTag(h.Begin))void 0!==(n=e.parseStatementSequenceBlock(h.Begin))&&(o=n.getLocation());else if(void 0!==i&&e.hasTag(h.Activity)&&e.error("Cannot have more than one activity per component."),void 0===i&&e.hasTag(h.Activity))void 0!==(i=e.parseStatementSequenceBlock(h.Activity))&&(o=i.getLocation());else if(void 0!==r&&e.hasTag(h.Finally)&&e.error("Cannot have more than one finally per component."),void 0===r&&e.hasTag(h.Finally))void 0!==(r=e.parseStatementSequenceBlock(h.Finally))&&(o=r.getLocation());else if(e.hasTag(h.Component)){var u=e.parseComponent();void 0!==u&&a.push(u)}else if(e.hasTag(h.Implementation)){var l=e.parseImplementation();void 0!==l&&s.push(l)}else c=!0;else a.push(t)})),new $e(g.merge(t,o),a,s,n,i,r)}},{key:"consumeEnd",value:function(e){this.expectConsumeFixToken(h.End),this.parseName().getName()!==e.getName()&&this.error("Name missmatch.");var t=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(h.Semicolon),t}},{key:"parseComponent",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Component);var t=this.parseAttributeList(),n=this.parseName(),i=this.parseOffers(),r=this.parseRequires();this.expectConsumeFixToken(h.Semicolon);var a=this.parseComponentBody(),s=this.consumeEnd(n);return new Ke(g.merge(e,s),n,t,i,r,a)}},{key:"parseImplementation",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Implementation);var t=this.parseName();this.expectConsumeFixToken(h.Semicolon);var n=this.parseDeclarationList(),i=this.parseStatementSequenceBlock(h.Begin),r=this.consumeEnd(t);return new Kt(g.merge(e,r),t,n,i)}},{key:"parseListWithPredicate",value:function(e,t){var n=new f.b(e());return this.loop((function(){return t()}),(function(){n.push(e())})),n}},{key:"parseList",value:function(e,t){var n=this,i=new f.b(e());return this.loop((function(){return n.hasTag(t)}),(function(){n.expectConsumeFixToken(t),i.push(e())})),i}},{key:"parseIdentifierList",value:function(){return this.parseList(this.parseName.bind(this),h.Comma)}},{key:"parseParameterList",value:function(){return this.parseList(this.parseParameter.bind(this),h.Semicolon)}},{key:"parseProcedureParameterList",value:function(){return this.parseList(this.parseProcedureParameter.bind(this),h.Semicolon)}},{key:"parseIndexedIdentifierList",value:function(){return this.parseList(this.parseIndexedName.bind(this),h.Comma)}},{key:"parseExpressionList",value:function(){return this.parseList(this.parseExpression.bind(this),h.Comma)}},{key:"parseDesignatorList",value:function(){return this.parseList(this.parseDesignator.bind(this),h.Comma)}},{key:"parseOfferedInterfaceDeclarationList",value:function(){return this.parseList(this.parseOfferedInterfaceDeclaration.bind(this),h.Comma)}},{key:"parseRequiredInterfaceDeclarationList",value:function(){return this.parseList(this.parseRequiredInterfaceDeclaration.bind(this),h.Comma)}},{key:"parseStatementList",value:function(){return this.parseList(this.parseStatement.bind(this),h.Semicolon)}},{key:"parseAttributeList",value:function(){if(!this.hasTag(h.OpenBrace))return new Array;this.expectConsumeFixToken(h.OpenBrace);var e=this.parseIdentifierList();return this.expectConsumeFixToken(h.CloseBrace),e.map((function(e){return new Qe(e.getLocation(),e)}))}},{key:"parseDeclarationList",value:function(){var e=this,t=new Array,n=!0;return this.loop((function(){return n}),(function(){var i=e.parseDeclaration();void 0!==i?t.push(i):n=!1})),t}},{key:"parseType",value:function(){var e=this.lexer.peek(1);if(e instanceof O)return this.lexer.next(),new Yn(e.getLocation(),e.getIdentifier());this.expectConsumeFixToken(h.Any);var t=new Array,n=new Array;return this.tryConsumeFixToken(h.OpenParentheses)&&(t.push.apply(t,l(this.parseOfferedInterfaceDeclarationList())),this.tryConsumeFixToken(h.Pipe)&&n.push.apply(n,l(this.parseRequiredInterfaceDeclarationList())),this.expectConsumeFixToken(h.CloseParentheses)),new Jn(e.getLocation(),t,n)}},{key:"parseParameter",value:function(){var e=this.parseIdentifierList();this.expectConsumeFixToken(h.Colon);var t=this.parseType();return new ln(g.merge(e[0].getLocation(),t.getLocation()),e,t)}},{key:"parseProcedureParameter",value:function(){var e=this.hasTag(h.Variable),t=this.lexer.peek(1).getLocation();e&&this.expectConsumeFixToken(h.Variable);var n=this.parseParameter();return new fn(g.merge(t,n.getLocation()),e,n)}},{key:"parseMessageParameters",value:function(){if(this.tryConsumeFixToken(h.OpenParentheses)){var e=this.parseParameterList();return this.expectConsumeFixToken(h.CloseParentheses),e}return new Array}},{key:"parseMessageDeclaration",value:function(){var e=this.lexer.peek(1).getLocation(),t=void 0;if(this.tryConsumeFixToken(h.In)&&(t=pn.IN),this.tryConsumeFixToken(h.Out)&&(t=pn.OUT),void 0===t)return this.error("Message declarations must have a direction.");var n=this.parseName(),i=this.parseMessageParameters();return new mn(e,t,n,i)}},{key:"parseProtocolTermExpression",value:function(e,t,n){var i=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(t);var r=this.parseProtocolExpression();if(void 0!==r){var a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(n),new e(g.merge(i,a),r)}return this.error("Failed to parse protocol term expression.")}},{key:"parseProtocolTerm",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=new Array;this.loop((function(){return e.hasTag(h.In)||e.hasTag(h.Out)||e.hasTag(h.OpenSquareBracket)||e.hasTag(h.OpenParentheses)||e.hasTag(h.OpenBrace)}),(function(){if(e.hasTag(h.In)||e.hasTag(h.Out))n.push(e.parseMessageDeclaration());else if(e.hasTag(h.OpenSquareBracket)){var t=e.parseProtocolTermExpression(Tn,h.OpenSquareBracket,h.CloseSquareBracket);n.push(t)}else if(e.hasTag(h.OpenParentheses)){var i=e.parseProtocolTermExpression(xn,h.OpenParentheses,h.CloseParentheses);n.push(i)}else if(e.hasTag(h.OpenBrace)){var r=e.parseProtocolTermExpression(En,h.OpenBrace,h.CloseBrace);n.push(r)}else;}));var i=f.b.fromArray(n);return void 0===i?this.error("At least one term factor needed."):new tn(t,i)}},{key:"parseProtocolExpression",value:function(){var e=this,t=this.lexer.peek(1).getLocation();if(!this.hasTag(h.End)){var n=new f.b(this.parseProtocolTerm());return this.loop((function(){return e.hasTag(h.Pipe)}),(function(){e.expectConsumeFixToken(h.Pipe),n.push(e.parseProtocolTerm())})),new en(t,n)}}},{key:"parseProtocol",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseProtocolExpression();return new Zt(void 0===t?e:g.merge(e,t.getLocation()),t)}},{key:"parseInterface",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(h.Interface);var t=this.parseName();this.expectConsumeFixToken(h.Semicolon);var n=this.parseProtocol(),i=this.consumeEnd(t);return new $t(g.merge(e,i),t,n)}},{key:"parse",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=new Array,i=new Array,r=!1;this.loop((function(){return!r}),(function(){if(e.isComponent()){var t=e.parseComponent();void 0!==t&&n.push(t)}else if(e.isInterface()){var a=e.parseInterface();void 0!==a&&i.push(a)}else e.error("Invalid top level node."),r=!0}));var a=this.lexer.peek(1).getLocation();return new vn(g.merge(t,a),n,i)}}]),e}();!function(e){e[e.Tag=0]="Tag"}(ei||(ei={}));var ni,ii=function e(){Object(s.a)(this,e),this._globalScopeSymbolTag=ei.Tag},ri=function e(t){Object(s.a)(this,e),this.scope=t},ai=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).name=i,r}return n}(ri),si=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).identifier=i,r}return n}(ri);!function(e){e[e.Tag=0]="Tag"}(ni||(ni={}));var oi,ci=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._blockScopeSymbolTag=ni.Tag,e}return n}(ri),ui=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e)).interfaceSymbol=i,r}return n}(ri);!function(e){e[e.Tag=0]="Tag"}(oi||(oi={}));var li,hi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._typeSymbolTag=oi.Tag,e}return n}(si),fi=function e(t,n){Object(s.a)(this,e),this.identifier=t,this.type=n},vi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).parameters=r,o.returnType=a,o}return n}(hi);!function(e){e[e.Tag=0]="Tag"}(li||(li={}));var pi,gi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._builtInTypeSymbol=li.Tag,e}return n}(hi);!function(e){e[e.Tag=0]="Tag"}(pi||(pi={}));var di,mi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._interfaceSymbolTag=pi.Tag,e}return n}(hi);!function(e){e[e.Tag=0]="Tag"}(di||(di={}));var yi,bi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).genericType=r,o.isEntryPoint=a,o._componentSymbolTag=di.Tag,o}return n}(hi);!function(e){e[e.Tag=0]="Tag"}(yi||(yi={}));var ki,Ti=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this,e,"@@@__ANY__GENERIC_COMPONENT__@@@",i,!1))._genericComponentSymbolTag=yi.Tag,r}return n}(bi),wi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,i)).parameters=r,a}return n}(hi),Ei=function e(t,n){Object(s.a)(this,e),this.interfaceSymbol=t,this.cardinality=n},Oi=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(Object(s.a)(this,e),this.min=t,this.max=n,t<1)throw new Error("cardinality must be greater 0");if(void 0!==n&&n<t)throw new Error("min ".concat(t," must be greater than max ").concat(n))}return Object(o.a)(e,[{key:"unlimited",value:function(){return this.max===1/0}}]),e}(),xi=function(){function e(t,n){Object(s.a)(this,e),this.offered=t,this.required=n,e.validate(this.offered,"Offered interface defined multiple times."),e.validate(this.required,"Required interface defined multiple times.")}return Object(o.a)(e,[{key:"canBeSubstitutedBy",value:function(t){return e.matchInterfaceDeclarations(this.offered,t.offered,(function(e,t){return e>=t}),(function(e,t){return e>=t}))&&e.matchInterfaceDeclarations(this.required,t.required,(function(e,t){return e<=t}),(function(e,t){return e<=t}))}},{key:"canSubstitute",value:function(e){return e.canBeSubstitutedBy(this)}}],[{key:"validate",value:function(e,t){if(Object(c.a)(Array,l(new Set(e.map((function(e){return e.interfaceSymbol.identifier}))))).length!==e.length)throw new Error(t)}},{key:"matchInterfaceDeclarations",value:function(e,t,n,i){return e.filter((function(e){return void 0!==t.find((function(t){return e.interfaceSymbol===t.interfaceSymbol&&i(e.cardinality.max,t.cardinality.max)&&n(e.cardinality.min,t.cardinality.min)}))})).length===e.length}}]),e}(),Ci=function e(t,n,i){Object(s.a)(this,e),this.scope=t,this.searchGlobalScope=n,this.searchParentScope=i},Si=function(){function e(){Object(s.a)(this,e),this.globalScope=new ii,this.voidType=new gi(this.globalScope,"@@@__VOID__@@@"),this.anyRequiredInterfaceType=new mi(this.globalScope,"@@@__ANY_REQUIRED_INTERFACE__@@@"),this.anyGenericComponentType=new xi([],[]),this.anyComponentType=new bi(this.globalScope,"@@@__ANY_COMPONENT__@@@",this.anyGenericComponentType,!1),this.anyMessage=new wi(this.globalScope,"ANY",[]),this.finishMessage=new wi(this.globalScope,"FINISH",[]),this.symbolToDeclaration=new Map,this.symbolToImplementation=new Map,this.symbolToComponent=new Map,this.symbolToInterface=new Map,this.expressionToSymbol=new Map,this.typeToSymbol=new Map,this.designatorToSymbol=new Map,this.variableToSymbol=new Map,this.callToSymbol=new Map,this.sendReceiveToSymbol=new Map,this.patternToSymbol=new Map,this.componentToSymbol=new Map,this.messageToSymbol=new Map,this.implementationToSymbol=new Map,this.procedureToSymbol=new Map,this.interfaceToSymbol=new Map,this.types=new Array,this.builtins=new Array,this.components=new Array,this.interfaces=new Array,this.messages=new Array,this.constants=new Array,this.procedures=new Array,this.impplementations=new Array,this.variables=new Array,this.collectionVariables=new Array}return Object(o.a)(e,[{key:"getMessages",value:function(e){return this.messages.filter((function(t){return t.scope===e}))}},{key:"getSystemProcedures",value:function(){var e=this;return this.procedures.filter((function(t){return t.scope===e.globalScope}))}},{key:"getProcedures",value:function(e){return this.procedures.filter((function(t){return t.scope===e}))}},{key:"getImplementations",value:function(e){return this.impplementations.filter((function(t){return t.scope===e}))}},{key:"getVariables",value:function(e){return this.variables.filter((function(t){return t.scope===e}))}},{key:"getCollectionVariables",value:function(e){return this.collectionVariables.filter((function(t){return t.scope===e}))}},{key:"registerBuiltIns",value:function(e){this.builtins.push(e),this.types.push(e)}},{key:"registerComponent",value:function(e){this.components.push(e),this.types.push(e)}},{key:"registerInterface",value:function(e){this.interfaces.push(e),this.types.push(e)}},{key:"registerMessage",value:function(e){this.messages.push(e),this.types.push(e)}},{key:"registerProcedure",value:function(e){this.procedures.push(e)}},{key:"registerImplementation",value:function(e){this.impplementations.push(e)}},{key:"registerVariable",value:function(e){this.variables.push(e)}},{key:"registerCollectionVariable",value:function(e){this.collectionVariables.push(e)}},{key:"findBuiltIn",value:function(e){return this.builtins.filter((function(t){return t.identifier===e}))}},{key:"findProcedure",value:function(e,t,n,i){var r=this;return this.findInComponent(this.procedures,function(i,a){return i.identifier===e&&i.parameters.length===t.length&&i.parameters.filter((function(e,n){return r.isAssignable(e,t[n])})).length===t.length&&(void 0===n||i.returnType===n)&&i.scope===a}.bind(this),i)}},{key:"isAssignable",value:function(e,t){return e instanceof bi&&t instanceof bi?e.genericType.canBeSubstitutedBy(t.genericType):e===t}},{key:"findInComponent",value:function(e,t,n){if(!n.searchGlobalScope&&n.scope instanceof ii)return new Array;var i=e.filter((function(e){return t(e,n.scope)}));return i.length>0||n.scope instanceof ii||!n.searchGlobalScope&&n.scope.scope instanceof ii?i:!n.searchParentScope&&(n.scope instanceof bi||n.scope instanceof mi)?n.searchGlobalScope?this.findInComponent(e,t,new Ci(this.globalScope,n.searchGlobalScope,n.searchParentScope)):i:this.findInComponent(e,t,new Ci(n.scope.scope,n.searchGlobalScope,n.searchParentScope))}},{key:"findNameInScope",value:function(e,t,n){return this.findInComponent(e,function(e,n){return e.identifier===t&&e.scope===n}.bind(this),n)}},{key:"findVariable",value:function(e,t){return this.findNameInScope(this.variables,e,t)}},{key:"findMessage",value:function(e,t,n,i){var r=this;return this.findInComponent(this.messages,function(i,a){return i.identifier===e&&i.scope===a&&(t||i.parameters.length===n.length&&i.parameters.filter((function(e,t){return r.isAssignable(e,n[t])})).length===n.length)}.bind(this),i)}},{key:"findCollectionVariable",value:function(e,t,n,i){var r=this;return this.findInComponent(this.collectionVariables,function(i,a){return i.identifier===e&&(t||i.parameters.length===n.length&&i.parameters.filter((function(e,t){return r.isAssignable(e,n[t])})).length===n.length)&&i.scope===a}.bind(this),i)}},{key:"findComponent",value:function(e,t){return this.findNameInScope(this.components,e,t)}},{key:"findInterface",value:function(e,t){return this.findNameInScope(this.interfaces,e,t)}},{key:"findType",value:function(e,t){return this.findNameInScope(this.types,e,t)}},{key:"findImplementation",value:function(e,t){return this.findInComponent(this.impplementations,function(t,n){return t.interfaceSymbol.identifier===e&&t.scope===n}.bind(this),t)}}],[{key:"componentSatisfiesGeneric",value:function(e,t){return 0===t.offered.length&&0===t.required.length||t.canBeSubstitutedBy(e.genericType)}}]),e}(),ji=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).mutable=r,o.type=a,o}return n}(si),Ii=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r,a){var o;return Object(s.a)(this,n),(o=t.call(this,e,i)).type=r,o.parameters=a,o}return n}(si),Li=n(16),Ai=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitBasicType",value:function(e){var t=this.symbolTable.findType(e.getIdentifier(),new Ci(this.scope,!0,!0));if(t.length<1)throw new Error("Failed to find type for basic type: ".concat(e.getIdentifier(),", no type found."));if(t.length>1)throw new Error("Failed to find type for basic type: ".concat(e.getIdentifier(),", multiple definitions found."));this.symbolTable.typeToSymbol.set(e,t[0])}},{key:"visitAnyType",value:function(e){var t=this,n=new Ti(this.scope,new xi(e.getOffered().map((function(e){return Ui.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)})),e.getRequired().map((function(e){return Ui.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)}))));this.symbolTable.typeToSymbol.set(e,n)}}]),n}(Zn),Pi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"getType",value:function(e){var t=this.symbolTable.expressionToSymbol.get(e);return Object(f.d)(t)}},{key:"getBuiltIn",value:function(e){return Object(f.c)(this.symbolTable.findBuiltIn(e))}},{key:"visitAttributes",value:function(e){var t=this;e.forEach((function(e){return e.accept(t)}))}},{key:"visitConstantExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitUnaryExpression",value:function(e){e.getExpression().accept(this),this.symbolTable.expressionToSymbol.set(e,this.getType(e.getExpression()))}},{key:"visitBinaryExpression",value:function(e){e.getLeft().accept(this),e.getRight().accept(this);var t=this.getType(e.getLeft()),n=this.getType(e.getRight());if(this.checkChainMatch(t,n),!(t instanceof gi))throw new Error("Cannot compare non number values.");var i=t.identifier;switch(e.getOp()){case rt.Equal:case rt.NotEqual:if("REAL"!==i&&"INTEGER"!==i&&"BOOLEAN"!==i&&"CHARACTER"!==i&&"TEXT"!==i)throw new Error("Cannot compare non number values.");break;case rt.Less:case rt.LessEqual:case rt.More:case rt.MoreEqual:if("REAL"!==i&&"INTEGER"!==i&&"CHARACTER"!==i&&"TEXT"!==i)throw new Error("Cannot compare non number values.")}this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("BOOLEAN"))}},{key:"visitOffersRequiresExpression",value:function(e){var t=this;this.visitAttributes(e.getAttributes()),e.getInterfaces().forEach((function(e){return e.accept(t)})),this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("BOOLEAN"))}},{key:"visitTypeCheck",value:function(e){this.visitAttributes(e.getAttributes()),e.getDesignator().accept(this),e.getType().accept(this),this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("BOOLEAN"))}},{key:"visitUnaryTermNode",value:function(e){e.getTerm().accept(this);var t=this.getType(e.getTerm());if(!(t instanceof gi))throw new Error("Cannot apply unary + - op to non builtin type.");var n=t.identifier;switch(e.getOp()){case ft.Minus:case ft.Plus:if("REAL"!==n&&"INTEGER"!==n)throw new Error("Cannot apply + - to non numbers types.")}this.symbolTable.expressionToSymbol.set(e,this.getType(e.getTerm()))}},{key:"checkChainMatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=Object(c.a)(Array,l(new Set(n)));if(r.length<1)throw new Error("Failed right factor type lookup.");if(r.length>1)throw new Error("Ambiguous right factor type lookup.");if(r[0]!==e)throw new Error("Factor type missmatch. Left: ".concat(e.identifier,", Right: ").concat(r[0].identifier))}},{key:"getChainTypes",value:function(e){var t=this;return e.getRight().map((function(e){return t.getType(e.getRight())}))}},{key:"visitChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}));var n=this.getType(e.getLeft());this.checkChainMatch.apply(this,[n].concat(l(this.getChainTypes(e)))),this.symbolTable.expressionToSymbol.set(e,n)}},{key:"visitTermChain",value:function(e){this.visitChain(e)}},{key:"visitRightTerm",value:function(e){e.getRight().accept(this)}},{key:"visitFactorChain",value:function(e){this.visitChain(e)}},{key:"visitRightFactor",value:function(e){e.getRight().accept(this)}},{key:"visitUnaryFactor",value:function(e){e.getFactor().accept(this);var t=this.getType(e.getFactor());if(!(t instanceof gi))throw new Error("Cannot apply unary not op to non builtin type.");switch(e.getPrefix()){case Ot.Not:if("BOOLEAN"!==t.identifier)throw new Error("Cannot apply not op to non boolean types.")}this.symbolTable.expressionToSymbol.set(e,this.getType(e.getFactor()))}},{key:"visitExpressionFactor",value:function(e){e.getExpression().accept(this),this.symbolTable.expressionToSymbol.set(e,this.getType(e.getExpression()))}},{key:"visitIntegerNumber",value:function(e){this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("INTEGER"))}},{key:"visitRealNumber",value:function(e){this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("REAL"))}},{key:"visitConstantCharacter",value:function(e){this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("CHARACTER"))}},{key:"visitText",value:function(e){this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("TEXT"))}},{key:"getPatternName",value:function(e){if(e instanceof cn)return e.getName();switch(e){case Ft.Any:return this.symbolTable.anyMessage.identifier;case Ft.Finish:return this.symbolTable.finishMessage.identifier;default:throw new Error("Unknown message!")}}},{key:"visitMessageTest",value:function(e){var t;this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("BOOLEAN")),null===(t=e.getDesignator())||void 0===t||t.accept(this);var n=e.getPattern(),i=Fi.getMessage(this.symbolTable,this.scope,e.getDesignator(),this.getPatternName(n),!0,[]);this.symbolTable.patternToSymbol.set(n,i)}},{key:"visitReceiveTest",value:function(e){this.visitMessageTest(e)}},{key:"visitInputTest",value:function(e){this.visitMessageTest(e)}},{key:"visitExistsTest",value:function(e){var t;this.symbolTable.expressionToSymbol.set(e,this.getBuiltIn("BOOLEAN")),null===(t=e.getDesignator())||void 0===t||t.accept(this)}},{key:"visitFunctionCall",value:function(e){var t=this;e.getArguments().forEach((function(e){return e.accept(t)}));var n=e.getArguments().map((function(e){return t.getType(e)})),i=Object(f.c)(this.symbolTable.findProcedure(e.getName().getName(),n,void 0,new Ci(this.scope,!0,!1)));this.symbolTable.expressionToSymbol.set(e,i.returnType),this.symbolTable.callToSymbol.set(e,i)}},{key:"getProcedureParam",value:function(e){for(var t=this.scope;!(t instanceof vi)&&t instanceof si;)t=t.scope;if(!(t instanceof vi))throw new Error("".concat(e," is not a procedure parameter."));var n=Object(f.c)(this.symbolTable.findVariable(e,new Ci(t,!1,!1)));if(!(n.scope instanceof vi))throw new Error("Found ".concat(e," outside procedure param."));return n}},{key:"visitBasicDesignator",value:function(e){var t=e.getName().getName();try{var n=Fi.getVariable(this.symbolTable,e.getName().getName(),new Ci(this.scope,!1,!0));return this.symbolTable.expressionToSymbol.set(e,n.type),void this.symbolTable.designatorToSymbol.set(e,n)}catch(c){}try{var i=Object(f.c)(this.symbolTable.constants.filter((function(e){return e.identifier===t})));return this.symbolTable.expressionToSymbol.set(e,i.type),void this.symbolTable.designatorToSymbol.set(e,i.type)}catch(c){}try{var r=Object(f.c)(this.symbolTable.findInterface(t,new Ci(this.scope,!0,!0)));return this.symbolTable.expressionToSymbol.set(e,r),void this.symbolTable.designatorToSymbol.set(e,r)}catch(c){}try{var a=Object(f.c)(this.symbolTable.findComponent(t,new Ci(this.scope,!0,!0)));return this.symbolTable.expressionToSymbol.set(e,a),void this.symbolTable.designatorToSymbol.set(e,a)}catch(c){}try{var s=Object(f.c)(this.symbolTable.findCollectionVariable(t,!0,[],new Ci(this.scope,!0,!1)));return this.symbolTable.expressionToSymbol.set(e,s.type),void this.symbolTable.designatorToSymbol.set(e,s)}catch(c){}try{var o=this.getProcedureParam(t);return this.symbolTable.expressionToSymbol.set(e,o.type),void this.symbolTable.designatorToSymbol.set(e,o)}catch(c){}throw new Error("Failed designator type lookup for '".concat(t,"'."))}},{key:"visitBasicExpressionDesignator",value:function(e){var t=this,i=e.getName().getName();try{e.getExpressions().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))}));var r=e.getExpressions().map((function(e){return Object(f.d)(t.symbolTable.expressionToSymbol.get(e))})),a=Object(f.c)(this.symbolTable.findCollectionVariable(i,!1,r,new Ci(this.scope,!1,!0)));return Li.type instanceof gi&&"TEXT"===Li.type.identifier?this.symbolTable.expressionToSymbol.set(e,Object(f.c)(this.symbolTable.findBuiltIn("CHARACTER"))):this.symbolTable.expressionToSymbol.set(e,a.type),void this.symbolTable.designatorToSymbol.set(e,a)}catch(o){}try{var s=Object(f.c)(this.symbolTable.findInterface(i,new Ci(this.scope,!0,!0)));return this.symbolTable.expressionToSymbol.set(e,s),void this.symbolTable.designatorToSymbol.set(e,s)}catch(o){}throw new Error("Failed designator type lookup for '".concat(i,"'."))}},{key:"visitBaseTargetDesignator",value:function(e){var t=e.getBase(),n=e.getTarget();if(n.accept(this),t instanceof Qt){var i=t.getName().getName();try{var r=Fi.getProcedure(i,this.symbolTable,new Array(this.getType(n)),void 0,new Ci(this.scope,!0,!1));return this.symbolTable.expressionToSymbol.set(t,r),this.symbolTable.designatorToSymbol.set(e,r),void this.symbolTable.expressionToSymbol.set(e,r.returnType)}catch(s){}}t.accept(this);var a=this.getType(t);this.symbolTable.expressionToSymbol.set(e,a),this.symbolTable.designatorToSymbol.set(e,a)}},{key:"visitDesignatorType",value:function(e){e.getDesignator().accept(this),e.getType().accept(new Ai(this.symbolTable,this.scope))}}]),n}(Zn),Fi=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,null,[{key:"checkNotConstantSymbol",value:function(e,t){if(0!==t.constants.filter((function(t){return t.identifier===e})).length)throw new Error("".concat(e," is a constant variable!"))}},{key:"getComponent",value:function(e,t,n){this.checkNotConstantSymbol(t,e);var i=e.findComponent(t,n);if(i.length>1)throw new Error("Component ".concat(t," defined ").concat(i.length," times in the same scope."));if(i.length<1)throw new Error("No component ".concat(t," found."));return i[0]}},{key:"getInterface",value:function(e,t,n){this.checkNotConstantSymbol(t,e);var i=e.findInterface(t,n);if(i.length>1)throw new Error("Interface ".concat(t," defined ").concat(i.length," times in the same scope."));if(i.length<1)throw new Error("No interface ".concat(t," found."));return i[0]}},{key:"getImplementation",value:function(e,t,n){if(this.checkNotConstantSymbol(t,e),!(n.scope instanceof bi))throw new Error("Failed to locate ".concat(t,", must be inside a component."));var i=e.findImplementation(t,n);if(i.length>1)throw new Error("Implementaiton ".concat(t," defined ").concat(i.length," times in the same scope."));if(i.length<1)throw new Error("No implementation ".concat(t," found."));return i[0]}},{key:"getConstant",value:function(e,t){var n=e.constants.filter((function(e){return e.identifier===t}));if(n.length>1)throw new Error("Found ".concat(t," multiple times."));if(n.length<1)throw new Error("Failed to find ".concat(t,"."));return n[0]}},{key:"getVariable",value:function(e,t,n){var i=e.findVariable(t,n);if(i.length>1)throw new Error("Found ".concat(t," multiple times."));if(i.length<1)throw new Error("Failed to find ".concat(t,"."));return i[0]}},{key:"getProcedureParam",value:function(e,t,n){for(;!(t instanceof vi)&&t instanceof si;)t=t.scope;if(!(t instanceof vi))throw new Error("".concat(n," is not a procedure parameter."));var i=this.getVariable(e,n,new Ci(t,!1,!1));if(!(i.scope instanceof vi))throw new Error("Found ".concat(n," outside procedure param."));return i}},{key:"getProcedure",value:function(e,t,n,i,r){this.checkNotConstantSymbol(e,t);var a=t.findProcedure(e,n,i,r);if(a.length>1)throw new Error("Procedure ".concat(e," defined ").concat(a.length," times in the same scope."));if(a.length<1)throw new Error("No procedure ".concat(e," found."));return a[0]}},{key:"getProcedureFromNode",value:function(t,n,i){var r=t.getName().getName();this.checkNotConstantSymbol(r,n);var a=n.voidType,s=t.getType();if(void 0!==s){s.accept(new Ai(n,i.scope));var o=n.typeToSymbol.get(s);if(void 0===o)throw new Error("Failed to find procedure ".concat(r," return type."));a=o}var c=e.convertParamTypes(n,i.scope,t.getParams().map((function(e){return e.getParameter()})));return this.getProcedure(r,n,c,a,i)}},{key:"getTypeType",value:function(e,t){var n=e.typeToSymbol.get(t);if(void 0===n)throw new Error("Type node type lookup failed.");return n}},{key:"convertParamTypes",value:function(e,t,n){var i=this;return n.flatMap((function(n){n.getType().accept(new Ai(e,t));var r=i.getTypeType(e,n.getType());return n.getNames().map((function(){return r}))}))}},{key:"getMessageInImplentation",value:function(e,t,n,i,r){for(;!(t instanceof ui);){if(t instanceof ii)throw new Error("Failed message lookup for ".concat(n,"."));t=t.scope}var a=e.findMessage(n,i,r,new Ci(t.interfaceSymbol,!1,!1));if(a.length>1)throw new Error("Ambiguous message lookup for ".concat(n,"."));if(a.length<1)throw new Error("Message lookup failed for ".concat(n,"."));return a[0]}},{key:"getMessage",value:function(e,t,n,i,r,a){var s=a.map((function(n){n.accept(new Pi(e,t));var i=e.expressionToSymbol.get(n);if(void 0===i)throw new Error("Failed argument type lookup.");return i}));if(null===n||void 0===n||n.accept(new Pi(e,t)),void 0!==n){var o=e.expressionToSymbol.get(n),c=new Array;if(o instanceof bi)c.push.apply(c,l(o.genericType.offered.map((function(e){return e.interfaceSymbol})).flatMap((function(t){return e.findMessage(i,r,s,new Ci(t,!1,!1))}))));else{if(!(o instanceof mi))throw new Error("Failed interface lookup for ".concat(i,"."));c.push.apply(c,l(e.findMessage(i,r,s,new Ci(o,!1,!1))))}if(c.length>1)throw new Error("Ambigious message lookup for ".concat(i,"."));if(c.length<1)throw new Error("Message lookup failed for ".concat(i,"."));return c[0]}return this.getMessageInImplentation(e,t,i,r,s)}}]),e}(),Ni=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitComponent",value:function(e){var t=this,n=e.getName().getName(),i=e.getAttributes(),r=new bi(this.scope,n,new xi(e.getOffers().map((function(e){return Ui.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)})),e.getRequires().map((function(e){return Ui.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)}))),i.filter((function(e){return"ENTRYPOINT"===e.getName().getName()})).length>0);try{throw Fi.getComponent(this.symbolTable,n,new Ci(this.scope,!1,!1)),new Error("Duplicate component ".concat(n," detected,"))}catch(a){}if(r.isEntryPoint&&!this.isEntryPoint(r))throw new Error("Marked entrypoint component ".concat(n,", requires at least one non system interfaces to be connected."));this.symbolTable.registerComponent(r),this.symbolTable.symbolToComponent.set(r,e),this.symbolTable.componentToSymbol.set(e,r)}},{key:"isEntryPoint",value:function(e){var t=this,n=e.genericType.required;return 0===n.length||n.map((function(e){return t.isSystemInterface(e.interfaceSymbol.identifier)})).reduce((function(e,t){return e&&t}),!0)}},{key:"isSystemInterface",value:function(e){switch(e){case"SystemTime":case"FileSystem":case"GraphicView":return!0;default:return!1}}}]),n}(Zn),Ri=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitInterface",value:function(e){var t=e.getName().getName(),n=new mi(this.scope,t);try{throw Object(f.c)(this.symbolTable.findInterface(t,new Ci(this.scope,!1,!1))),new Error("Duplicate interface ".concat(t," detected."))}catch(i){}this.symbolTable.registerInterface(n),this.symbolTable.symbolToInterface.set(n,e),this.symbolTable.interfaceToSymbol.set(e,n)}}]),n}(Zn),Di=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitProtocol",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(this)}},{key:"visitProtocolTerm",value:function(e){var t=this;e.getFactors().forEach((function(e){return e.accept(t)}))}},{key:"visitMessageDeclaration",value:function(e){var t=this,n=e.getName().getName(),i=e.getParams().flatMap((function(e){e.getType().accept(new Ai(t.symbolTable,t.scope));var i=t.symbolTable.typeToSymbol.get(e.getType());if(void 0===i)throw new Error("Type lookup for message '".concat(n,"' param failed."));return e.getNames().map((function(){return i}))})),r=new wi(this.scope,n,i);this.symbolTable.registerMessage(r),this.symbolTable.messageToSymbol.set(e,r)}},{key:"visitOptionalProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitGroupProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitRepeatingProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitProtocolExpression",value:function(e){var t=this;e.getTerms().forEach((function(e){return e.accept(t)}))}}]),n}(Zn),Mi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitProcedure",value:function(e){var t=this,n=e.getName().getName(),i=Fi.convertParamTypes(this.symbolTable,this.scope,e.getParams().map((function(e){return e.getParameter()}))),r=this.symbolTable.voidType,a=e.getType();if(void 0!==a){a.accept(new Ai(this.symbolTable,this.scope));var s=this.symbolTable.typeToSymbol.get(a);if(void 0===s)throw new Error("Failed to find procedure return type for ".concat(n,"."));r=s}try{throw Fi.getProcedureFromNode(e,this.symbolTable,new Ci(this.scope,!1,!1)),new Error("Duplicate procedure detected.")}catch(c){}var o=new vi(this.scope,n,i,r);e.getParams().forEach((function(e){var n=e.getParameter();n.getNames().forEach((function(i){return t.symbolTable.registerVariable(new ji(o,i.getName(),e.isMutable(),Fi.getTypeType(t.symbolTable,n.getType())))}))})),this.symbolTable.registerProcedure(o),this.symbolTable.procedureToSymbol.set(e,o)}}]),n}(Zn),Bi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitImplementation",value:function(e){var t=e.getName().getName(),n=this.scope.genericType.offered.filter((function(e){return e.interfaceSymbol.identifier===t})).map((function(e){return e.interfaceSymbol}));if(1!==n.length)throw new Error("Could not find interface for '".concat(t,"' implementation."));try{throw Fi.getImplementation(this.symbolTable,t,new Ci(this.scope,!1,!1)),new Error("Duplicate '".concat(t,"' implementation detected."))}catch(r){}var i=new ui(this.scope,n[0]);this.symbolTable.registerImplementation(i),this.symbolTable.symbolToImplementation.set(i,e),this.symbolTable.implementationToSymbol.set(e,i)}}]),n}(Zn),Vi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitConstant",value:function(e){var t=e.getName().getName();e.getExpression().accept(new Pi(this.symbolTable,this.scope));var n=Object(f.d)(this.symbolTable.expressionToSymbol.get(e.getExpression().getExpression())),i=new ji(this.scope,t,!1,n);this.symbolTable.registerVariable(i),this.symbolTable.variableToSymbol.set(e,i)}},{key:"visitConstantList",value:function(e){var t=this;e.getConstants().forEach((function(e){return e.accept(t)}))}}]),n}(Zn),qi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitVariable",value:function(e){var t=this;e.getType().accept(new Ai(this.symbolTable,this.scope));var n=this.symbolTable.typeToSymbol.get(e.getType());if(void 0===n)throw new Error("".concat(e.getNames()[0].getName(),": Unknown type."));e.getNames().forEach((function(i){var r=i.getName(),a=i.getParams().length;if(n instanceof gi&&"TEXT"===n.identifier)t.symbolTable.registerCollectionVariable(new Ii(t.scope,r,n,new Array(Object(f.c)(t.symbolTable.findBuiltIn("INTEGER")))));else{if(!a){var s=new ji(t.scope,r,!0,n);return t.symbolTable.registerVariable(s),void t.symbolTable.variableToSymbol.set(e,s)}t.symbolTable.registerCollectionVariable(new Ii(t.scope,r,n,Fi.convertParamTypes(t.symbolTable,t.scope,i.getParams())))}}))}},{key:"visitVariableList",value:function(e){var t=this;e.getVariables().forEach((function(e){return e.accept(t)}))}}]),n}(Zn),_i=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"visitProgram",value:function(e){var t=this;e.getInterfaces().forEach((function(e){return e.accept(new Ri(t.symbolTable,t.scope))})),e.getComponents().forEach((function(e){return e.accept(new Ni(t.symbolTable,t.scope))})),e.getInterfaces().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))})),e.getComponents().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))}))}},{key:"visitComponent",value:function(e){var t,i=e.getName().getName(),r=this.symbolTable.findComponent(i,new Ci(this.scope,!1,!1));if(1!==r.length)throw new Error("Failed lookup for component ".concat(i,"."));null===(t=e.getBody())||void 0===t||t.accept(new n(this.symbolTable,r[0]))}},{key:"visitInterface",value:function(e){var t=e.getName().getName(),n=this.symbolTable.findInterface(t,new Ci(this.scope,!1,!1));if(1!==n.length)throw new Error("Failed to lookup interface ".concat(t,"."));e.getProtocol().accept(new Di(this.symbolTable,n[0]))}},{key:"visitProtocol",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(new Di(this.symbolTable,this.scope))}},{key:"visitProcedure",value:function(e){var t=Fi.getProcedureFromNode(e,this.symbolTable,new Ci(this.scope,!1,!1));this.registerLayer(e.getDeclarations(),t)}},{key:"registerLayer",value:function(e,t,i,r){var a=this,s=e.filter((function(e){return e instanceof Ke})).map((function(e){return e})),o=e.filter((function(e){return e instanceof $t})).map((function(e){return e})),c=e.filter((function(e){return e instanceof hn})).map((function(e){return e})),u=e.filter((function(e){return e instanceof $n})).map((function(e){return e})),l=e.filter((function(e){return e instanceof tt})).map((function(e){return e}));o.forEach((function(e){return e.accept(new Ri(a.symbolTable,t))})),s.forEach((function(e){return e.accept(new Ni(a.symbolTable,t))})),c.forEach((function(e){return e.accept(new Mi(a.symbolTable,t))})),u.forEach((function(e){return e.accept(new qi(a.symbolTable,t))})),l.forEach((function(e){return e.accept(new Vi(a.symbolTable,t))})),void 0!==i&&i(),o.forEach((function(e){return e.accept(new n(a.symbolTable,t))})),s.forEach((function(e){return e.accept(new n(a.symbolTable,t))})),c.forEach((function(e){return e.accept(new n(a.symbolTable,t))})),void 0!==r&&r(new n(this.symbolTable,t))}},{key:"visitImplementation",value:function(e){var t=e.getName().getName();if(!(this.scope instanceof bi))throw new Error("Implementation must be in a component scope!");var n=this.symbolTable.findImplementation(t,new Ci(this.scope,!1,!1));if(1!==n.length)throw new Error("Failed to lookup interface ".concat(t,"."));this.registerLayer(e.getDeclarations(),n[0])}},{key:"visitComponentBody",value:function(e){var t=this;if(!(this.scope instanceof bi))throw new Error("Component body must be a component scope!");var n=this.scope;this.registerLayer(e.getDeclarations(),n,(function(){e.getImplementations().forEach((function(e){return e.accept(new Bi(t.symbolTable,n))}))}),(function(t){e.getImplementations().forEach((function(e){return e.accept(t)}))}))}}]),n}(Zn),Ui=function(){function e(t,n){Object(s.a)(this,e),this.symbolTable=t,this.programScope=n;var i=new gi(this.symbolTable.globalScope,"BOOLEAN"),r=new gi(this.symbolTable.globalScope,"CHARACTER"),a=new gi(this.symbolTable.globalScope,"TEXT"),o=new gi(this.symbolTable.globalScope,"INTEGER"),c=new gi(this.symbolTable.globalScope,"REAL");this.builtInTypes=new Array(i,r,a,o,c),this.constants=new Map([["TRUE",i],["FALSE",i],["PI",c]]),this.variables=new Map([["TIME",o]]),this.systemProcedures=new Array(["ASSERT",[this.symbolTable.voidType,new Array(i)]],["ASSERT",[this.symbolTable.voidType,new Array(i,o)]],["HALT",[this.symbolTable.voidType,new Array(o)]],["INC",[this.symbolTable.voidType,new Array(o)]],["INC",[this.symbolTable.voidType,new Array(o,o)]],["DEC",[this.symbolTable.voidType,new Array(o)]],["DEC",[this.symbolTable.voidType,new Array(o,o)]],["PASSIVATE",[this.symbolTable.voidType,new Array(o)]],["WRITE",[this.symbolTable.voidType,new Array(a)]],["WRITE",[this.symbolTable.voidType,new Array(o)]],["WRITE",[this.symbolTable.voidType,new Array(c)]],["WRITE",[this.symbolTable.voidType,new Array(r)]],["WRITEHEX",[this.symbolTable.voidType,new Array(o)]],["WRITELINE",[this.symbolTable.voidType,new Array]],["NEW",[this.symbolTable.voidType,new Array(this.symbolTable.anyComponentType)]],["NEW",[this.symbolTable.voidType,new Array(o)]],["NEW",[this.symbolTable.voidType,new Array(o,o)]],["NEW",[this.symbolTable.voidType,new Array(o,o,o)]],["DELETE",[this.symbolTable.voidType,new Array(this.symbolTable.anyComponentType)]],["COUNT",[o,new Array(this.symbolTable.anyRequiredInterfaceType)]],["LENGTH",[o,new Array(a)]],["SQRT",[c,new Array(c)]],["SIN",[c,new Array(c)]],["COS",[c,new Array(c)]],["TAN",[c,new Array(c)]],["ARCSIN",[c,new Array(c)]],["ARCCOS",[c,new Array(c)]],["ARCTAN",[c,new Array(c)]],["RANDOM",[o,new Array(o,o)]],["MIN",[c,new Array(c)]],["MIN",[o,new Array(o)]],["MAX",[c,new Array(c)]],["MAX",[o,new Array(o)]],["CHARACTER",[r,new Array(o)]],["INTEGER",[o,new Array(c)]],["INTEGER",[o,new Array(r)]],["REAL",[c,new Array(o)]],["TEXT",[a,new Array(r)]])}return Object(o.a)(e,[{key:"register",value:function(e){this.registerBuiltIns(),e.accept(new _i(this.symbolTable,this.programScope))}},{key:"registerBuiltIns",value:function(){this.registerBuiltInTypes(),this.registerBuiltInProcedures(),this.registerBuiltInConstants(),this.registerBuiltInVariables()}},{key:"registerBuiltInTypes",value:function(){var e=this;this.builtInTypes.forEach((function(t){return e.symbolTable.registerBuiltIns(t)}))}},{key:"registerBuiltInProcedures",value:function(){var e=this;this.systemProcedures.forEach((function(t){var n=new vi(e.symbolTable.globalScope,t[0],t[1][1],t[1][0]);e.symbolTable.registerProcedure(n)}))}},{key:"registerBuiltInConstants",value:function(){var e=this;this.constants.forEach((function(t,n){return e.symbolTable.constants.push(new fi(n,t))}))}},{key:"registerBuiltInVariables",value:function(){var e=this;this.variables.forEach((function(t,n){return e.symbolTable.registerVariable(new ji(e.symbolTable.globalScope,n,!1,t))}))}}],[{key:"run",value:function(t,n,i){new e(t,i).register(n)}},{key:"createInterfaceDeclarationSymbol",value:function(e,t,n){var i,r=t.getName().getName(),a=e.findInterface(r,new Ci(n,!0,!0));if(0===a.length)throw new Error("Interface ".concat(r," not defined."));if(a.length>1)throw new Error("Interface ".concat(r," multiple times defined."));var s=t.getCardinality();return new Ei(a[0],new Oi(null!==(i=null===s||void 0===s?void 0:s.getMin())&&void 0!==i?i:1,null===s||void 0===s?void 0:s.getMax()))}}]),e}(),Wi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i){var r;return Object(s.a)(this,n),(r=t.call(this)).symbolTable=e,r.scope=i,r}return Object(o.a)(n,[{key:"findCollectionVariable",value:function(e){if(e instanceof zt||e instanceof Qt){var t=e.getName().getName(),n=this.symbolTable.findCollectionVariable(t,!0,[],new Ci(this.scope,!1,!1));if(n.length>1)throw new Error("Found ".concat(t," multiple times."));if(n.length<1)throw new Error("Failed to find ".concat(t,"."));return n[0]}throw new Error("Not implemented yet.")}},{key:"visitProgram",value:function(e){var t=this;e.getComponents().forEach((function(e){return e.accept(t)}))}},{key:"visitComponent",value:function(e){var t,i=Fi.getComponent(this.symbolTable,e.getName().getName(),new Ci(this.scope,!0,!0));null===(t=e.getBody())||void 0===t||t.accept(new n(this.symbolTable,i))}},{key:"visitComponentBody",value:function(e){var t,i,r,a=this;e.getDeclarations().forEach((function(e){return e.accept(a)})),e.getImplementations().forEach((function(e){return e.accept(a)})),null===(t=e.getBeginBlock())||void 0===t||t.accept(new n(this.symbolTable,this.scope)),null===(i=e.getActivityBlock())||void 0===i||i.accept(new n(this.symbolTable,this.scope)),null===(r=e.getFinallyBlock())||void 0===r||r.accept(new n(this.symbolTable,this.scope))}},{key:"visitImplementation",value:function(e){var t,i=this,r=Fi.getImplementation(this.symbolTable,e.getName().getName(),new Ci(this.scope,!0,!1));e.getDeclarations().forEach((function(e){return e.accept(new n(i.symbolTable,r))})),null===(t=e.getStatements())||void 0===t||t.accept(new n(this.symbolTable,r))}},{key:"visitProcedure",value:function(e){var t,i=this,r=Fi.getProcedureFromNode(e,this.symbolTable,new Ci(this.scope,!0,!1));e.getDeclarations().forEach((function(e){return e.accept(new n(i.symbolTable,r))})),null===(t=e.getStatements())||void 0===t||t.accept(new n(this.symbolTable,r))}},{key:"visitStatementSequence",value:function(e){var t=this;e.getStatements().forEach((function(e){return e.accept(new n(t.symbolTable,new ci(t.scope)))}))}},{key:"visitProcedureCall",value:function(e){var t=this,n=e.getParams().map((function(e){return e.accept(new Pi(t.symbolTable,t.scope)),Object(f.d)(t.symbolTable.expressionToSymbol.get(e))})),i=Fi.getProcedure(e.getName().getName(),this.symbolTable,n,void 0,new Ci(this.scope,!0,!1));this.symbolTable.callToSymbol.set(e,i)}},{key:"visitAssignment",value:function(e){e.getDesignator().accept(new Pi(this.symbolTable,this.scope));var t=Object(f.d)(this.symbolTable.designatorToSymbol.get(e.getDesignator()));if(!(t instanceof ji&&t.mutable)&&!(t instanceof Ii))throw new Error("Cannot asign to to a constant variable.");e.getExpression().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitNew",value:function(e){var t=this;e.getDesignator().accept(new Pi(this.symbolTable,this.scope)),e.getArgs().forEach((function(e){return e.accept(new Pi(t.symbolTable,t.scope))}))}},{key:"visitConnect",value:function(e){e.getTo().accept(new Pi(this.symbolTable,this.scope)),e.getWhat().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitDisconnect",value:function(e){e.getWhat().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitSend",value:function(e){if("FINISHED"===e.getTarget().getName())throw new Error("foo");this.symbolTable.sendReceiveToSymbol.set(e,Fi.getMessage(this.symbolTable,this.scope,e.getFrom(),e.getTarget().getName(),!1,e.getArgs()))}},{key:"visitReceive",value:function(e){this.symbolTable.sendReceiveToSymbol.set(e,Fi.getMessage(this.symbolTable,this.scope,e.getFrom(),e.getReceiver().getName(),!1,e.getTargets()))}},{key:"visitDelete",value:function(e){e.getTarget().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitMove",value:function(e){e.getFrom().accept(new Pi(this.symbolTable,this.scope)),e.getTo().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitAwait",value:function(e){e.getExpression().accept(new Pi(this.symbolTable,this.scope))}},{key:"visitReturn",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(new Pi(this.symbolTable,this.scope))}},{key:"visitIf",value:function(e){var t,i=this,r=new ci(this.scope);e.getExpression().accept(new Pi(this.symbolTable,r)),e.getThen().accept(new n(this.symbolTable,r)),e.getElseIfs().forEach((function(e){return e.accept(new n(i.symbolTable,r))})),null===(t=e.getElse())||void 0===t||t.accept(new n(this.symbolTable,r))}},{key:"visitElseIf",value:function(e){var t=new ci(this.scope);e.getExpression().accept(new Pi(this.symbolTable,t)),e.getThen().accept(new n(this.symbolTable,t))}},{key:"visitWhile",value:function(e){var t=new ci(this.scope);e.getExpresssion().accept(new Pi(this.symbolTable,t)),e.getBody().accept(new n(this.symbolTable,t))}},{key:"visitRepeat",value:function(e){var t=new ci(this.scope);e.getExpresssion().accept(new Pi(this.symbolTable,t)),e.getBody().accept(new n(this.symbolTable,t))}},{key:"visitFor",value:function(e){var t,i=new ci(this.scope);if(e.getExpression().accept(new Pi(this.symbolTable,i)),!(e.getDesignator()instanceof Qt))throw new Error("Only basic designators currently supported.");e.getDesignator().accept(new Pi(this.symbolTable,i)),e.getTo().accept(new Pi(this.symbolTable,i)),null===(t=e.getBy())||void 0===t||t.accept(new Pi(this.symbolTable,i)),e.getStatements().accept(new n(this.symbolTable,i))}},{key:"visitForeach",value:function(e){var t=this,i=new ci(this.scope);e.getOf().accept(new Pi(this.symbolTable,i));var r=this.findCollectionVariable(e.getOf());if(r.parameters.length<e.getDesignators().length)throw new Error("Foreach designator match error.");e.getDesignators().forEach((function(e,n){if(!(e instanceof Qt))throw new Error("Only basic designators supported.");t.symbolTable.registerVariable(new ji(t.scope,e.getName().getName(),!0,r.parameters[n])),e.accept(new Pi(t.symbolTable,i))})),e.getBody().accept(new n(this.symbolTable,i))}},{key:"visitStatementBlock",value:function(e){e.getStatements().accept(this)}}]),n}(Zn),Gi=function(){function e(t,n){Object(s.a)(this,e),this.symbolTable=t,this.programScope=n}return Object(o.a)(e,[{key:"fix",value:function(e){e.accept(new Wi(this.symbolTable,this.programScope)),e.accept(new qi(this.symbolTable,this.programScope))}}],[{key:"run",value:function(t,n,i){new e(t,i).fix(n)}}]),e}(),Hi=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"check",value:function(e,t){var n=new Si,i=new ai(n.globalScope,e);return Ui.run(n,t,i),Gi.run(n,t,i),n}}]),e}(),Xi=n(1);!function(e){e[e.Tag=0]="Tag"}(ki||(ki={}));var Qi=function e(){Object(s.a)(this,e),this._labelTag=ki.Tag},zi=function(){function e(){Object(s.a)(this,e),this.targets=new Map,this.origins=new Map,this.code=new Array}return Object(o.a)(e,[{key:"complete",value:function(){return this.fixLabels(),this.code}},{key:"createLabel",value:function(){return new Qi}},{key:"setLabel",value:function(e){this.targets.set(e,this.code.length)}},{key:"fixLabels",value:function(){var e=this;this.origins.forEach((function(t,n){var i=e.targets.get(n);if(void 0===i)throw new Error("Cannot branch to unknown label.");t.forEach((function(t){var n=e.code[t-1];if(n.code!==Xi.l.Branch&&n.code!==Xi.l.BranchFalse&&n.code!==Xi.l.BranchTrue)throw new Error("Not a jump instruction: "+n.code+", target: "+i+", origin: "+t);e.code[t-1].arguments.push(new Xi.j(i-t))}))}))}},{key:"emitLoadInteger",value:function(e){this.emit(Xi.l.LoadConstantInteger,new Xi.h(e))}},{key:"emitLoadFloat",value:function(e){this.emit(Xi.l.LoadConstantFloat,new Xi.d(e))}},{key:"emitLoadCharacter",value:function(e){this.emit(Xi.l.LoadConstantCharacter,new Xi.b(e))}},{key:"emitLoadText",value:function(e){this.emit(Xi.l.LoadConstantText,new Xi.p(e))}},{key:"emitLoadBoolean",value:function(e){this.emit(Xi.l.LoadConstantBoolean,new Xi.a(e))}},{key:"emitJump",value:function(e,t){var n;this.emit(e),this.origins.has(t)||this.origins.set(t,new Array),null===(n=this.origins.get(t))||void 0===n||n.push(this.code.length)}},{key:"emitBranch",value:function(e){this.emitJump(Xi.l.Branch,e)}},{key:"emitBranchFalse",value:function(e){this.emitJump(Xi.l.BranchFalse,e)}},{key:"emitBranchTrue",value:function(e){this.emitJump(Xi.l.BranchTrue,e)}},{key:"emitSystemCall",value:function(e,t){var n=new Xi.n(e);n.arguments.push(new Xi.h(t)),this.emit(Xi.l.SystemCall,n)}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.code.push(Object(c.a)(Xi.g,[e].concat(n)))}}]),e}(),Yi=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbols=e,a.scope=i,a.metadata=r,a.assembler=new zi,a}return Object(o.a)(n,[{key:"getInstructions",value:function(){return this.assembler.complete()}},{key:"visitBasicDesignator",value:function(e){var t=e.getName().getName(),n=Object(f.d)(this.symbols.designatorToSymbol.get(e));if(n instanceof gi&&n.scope===this.symbols.globalScope)switch(t){case"FALSE":return void this.assembler.emitLoadBoolean(!1);case"TRUE":return void this.assembler.emitLoadBoolean(!0);case"PI":return void this.assembler.emitLoadFloat(Math.PI)}if(n instanceof ji||n instanceof Ii){var i=this.metadata.findVariable(n);this.assembler.emit(Xi.l.LoadVariable,i)}else{if(!(n instanceof mi))throw Error("Unsupported BasicDesignatorNode ".concat(t));var r=this.metadata.findInterface(n);this.assembler.emit(Xi.l.LoadService,r)}}},{key:"visitBasicExpressionDesignator",value:function(e){var t=this,n=e.getName().getName(),i=Object(f.d)(this.symbols.designatorToSymbol.get(e));if(i instanceof Ii){var r=this.metadata.findVariable(i);return e.getExpressions().forEach((function(e){return e.accept(t)})),void this.assembler.emit(Xi.l.LoadVariable,r)}throw Error("Unsupported BasicExpressionDesignatorNode ".concat(n))}},{key:"visitBaseTargetDesignator",value:function(e){var t=this.symbols.designatorToSymbol.get(e);if(void 0===t)throw new Error("Failed base target designator node lookup.");e.getTarget().accept(this),t instanceof vi?this.handleCall(t):e.getBase().accept(this)}},{key:"visitAttribute",value:function(e){switch(e.getName().getName()){case"SHARED":this.assembler.emit(Xi.l.AcquireShared);break;case"EXCLUSIVE":this.assembler.emit(Xi.l.AcquireExclusive)}}},{key:"handleLockRelease",value:function(e){switch(e.getName().getName()){case"SHARED":this.assembler.emit(Xi.l.ReleaseShared);break;case"EXCLUSIVE":this.assembler.emit(Xi.l.ReleaseExclusive)}}},{key:"visitStatementSequence",value:function(e){var t=this;e.getAttributes().forEach((function(e){return e.accept(t)})),e.getStatements().forEach((function(e){return e.accept(t)})),e.getAttributes().forEach((function(e){return t.handleLockRelease(e)}))}},{key:"handleSystemCall",value:function(e){var t=e.identifier,n=e.parameters.length;if(e.scope!==this.symbols.globalScope)return!1;switch(t){case"WRITELINE":return this.assembler.emitSystemCall(Xi.o.WriteLine,n),!0;case"ASSERT":return this.assembler.emitSystemCall(Xi.o.Assert,n),!0;case"HALT":return this.assembler.emitSystemCall(Xi.o.Halt,n),!0;case"INC":return this.assembler.emitSystemCall(Xi.o.Inc,n),!0;case"DEC":return this.assembler.emitSystemCall(Xi.o.Dec,n),!0;case"PASSIVATE":return this.assembler.emitSystemCall(Xi.o.Passivate,n),!0;case"WRITE":return this.assembler.emitSystemCall(Xi.o.Write,n),!0;case"WRITEHEX":return this.assembler.emitSystemCall(Xi.o.WriteHex,n),!0;case"COUNT":return this.assembler.emitSystemCall(Xi.o.Count,n),!0;case"LENGTH":return this.assembler.emitSystemCall(Xi.o.Length,n),!0;case"SQRT":return this.assembler.emitSystemCall(Xi.o.Sqrt,n),!0;case"SIN":return this.assembler.emitSystemCall(Xi.o.Sin,n),!0;case"COS":return this.assembler.emitSystemCall(Xi.o.Cos,n),!0;case"TAN":return this.assembler.emitSystemCall(Xi.o.Tan,n),!0;case"ARCSIN":return this.assembler.emitSystemCall(Xi.o.ArcSin,n),!0;case"ARCCOS":return this.assembler.emitSystemCall(Xi.o.ArcCos,n),!0;case"ARCTAN":return this.assembler.emitSystemCall(Xi.o.ArcTan,n),!0;case"MIN":return this.assembler.emitSystemCall(Xi.o.Min,n),!0;case"MAX":return this.assembler.emitSystemCall(Xi.o.Max,n),!0;case"CHARACTER":return this.assembler.emitSystemCall(Xi.o.ToCharacter,n),!0;case"INTEGER":return this.assembler.emitSystemCall(Xi.o.ToInteger,n),!0;case"REAL":return this.assembler.emitSystemCall(Xi.o.ToReal,n),!0;case"TEXT":return this.assembler.emitSystemCall(Xi.o.ToText,n),!0;case"RANDOM":return this.assembler.emitSystemCall(Xi.o.Random,n),!0}return!1}},{key:"handleCall",value:function(e){this.handleSystemCall(e)||this.assembler.emit(Xi.l.ProcedureCall,this.metadata.findProcedure(e))}},{key:"visitProcedureCall",value:function(e){var t=this;e.getParams().forEach((function(e){e.accept(t)})),this.handleCall(Object(f.d)(this.symbols.callToSymbol.get(e)))}},{key:"visitAssignment",value:function(e){e.getDesignator().accept(this),e.getExpression().accept(this),this.assembler.emit(Xi.l.StoreVariable)}},{key:"visitConstantList",value:function(e){var t=this;e.getConstants().forEach((function(e){var n=Object(f.d)(t.symbols.variableToSymbol.get(e)),i=t.metadata.findVariable(n);t.assembler.emit(Xi.l.LoadVariable,i),e.getExpression().getExpression().accept(t),t.assembler.emit(Xi.l.StoreVariable)}))}},{key:"visitNew",value:function(e){var t=this,n=e.getDesignator(),i=this.symbols.designatorToSymbol.get(n);if(e.getArgs().forEach((function(e){return e.accept(t)})),n.accept(this),i instanceof ji||i instanceof Ii){var r=i.type;if(r instanceof bi)return void this.assembler.emit(Xi.l.New,this.metadata.findComponent(r));if(r instanceof gi)return void this.assembler.emit(Xi.l.New,this.metadata.builtInTypeDescriptor(r))}throw new Error("Unsupported new statement.")}},{key:"visitConnect",value:function(e){e.getWhat().accept(this),e.getTo().accept(this),this.assembler.emit(Xi.l.Connect)}},{key:"visitDisconnect",value:function(e){e.getWhat().accept(this),this.assembler.emit(Xi.l.Disconnect)}},{key:"visitSend",value:function(e){var t=this;e.getArgs().forEach((function(e){return e.accept(t)}));var n=e.getFrom();(void 0===n||n instanceof Qt)&&this.assembler.emit(Xi.l.LoadThis),null===n||void 0===n||n.accept(this);var i=this.metadata.findMessage(Object(f.d)(this.symbols.sendReceiveToSymbol.get(e)));this.assembler.emit(Xi.l.Send,i)}},{key:"visitReceive",value:function(e){var t=this;e.getTargets().forEach((function(e){return e.accept(t)}));var n=e.getFrom();(void 0===n||n instanceof Qt)&&this.assembler.emit(Xi.l.LoadThis),null===n||void 0===n||n.accept(this);var i=this.metadata.findMessage(Object(f.d)(this.symbols.sendReceiveToSymbol.get(e)));this.assembler.emit(Xi.l.Receive,i)}},{key:"visitDelete",value:function(e){e.getTarget().accept(this),this.assembler.emit(Xi.l.Delete)}},{key:"visitMove",value:function(e){e.getFrom().accept(this),e.getTo().accept(this),this.assembler.emit(Xi.l.Move)}},{key:"visitAwait",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),this.assembler.emit(Xi.l.AcquireExclusive),e.getExpression().accept(this),this.assembler.emitBranchTrue(n),this.assembler.emit(Xi.l.ReleaseExclusive),this.assembler.emitBranch(t),this.assembler.setLabel(n)}},{key:"visitReturn",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(this),this.assembler.emit(Xi.l.Return)}},{key:"visitIf",value:function(e){var t,n=this,i=this.assembler.createLabel(),r=e.getElseIfs().map((function(){return n.assembler.createLabel()})),a=this.assembler.createLabel();(e.getExpression().accept(this),e.getElseIfs().length>0&&(this.assembler.emitBranchFalse(r[0]),e.getThen().accept(this),e.getElseIfs().forEach((function(t,s){n.assembler.emitBranch(i),n.assembler.setLabel(r[s]),t.getExpression().accept(n),n.assembler.emitBranchFalse(s+1<e.getElseIfs().length?r[s+1]:void 0!==e.getElse()?a:i),t.getThen().accept(n)}))),void 0!==e.getElse())&&(this.assembler.emitBranchFalse(a),e.getThen().accept(this),this.assembler.emitBranch(i),this.assembler.setLabel(a),null===(t=e.getElse())||void 0===t||t.accept(this));0===e.getElseIfs().length&&void 0===e.getElse()&&(this.assembler.emitBranchFalse(i),e.getThen().accept(this)),this.assembler.setLabel(i)}},{key:"visitWhile",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),e.getExpresssion().accept(this),this.assembler.emitBranchFalse(n),e.getBody().accept(this),this.assembler.emitBranch(t),this.assembler.setLabel(n)}},{key:"visitRepeat",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),e.getBody().accept(this),e.getExpresssion().accept(this),this.assembler.emitBranchTrue(n),this.assembler.emitBranch(t),this.assembler.setLabel(n)}},{key:"visitFor",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel(),i=e.getDesignator();i.accept(this),e.getExpression().accept(this),this.assembler.emit(Xi.l.StoreVariable),this.assembler.setLabel(t),i.accept(this),e.getTo().accept(this);var r=e.getBy();if(void 0!==r){var a=this.assembler.createLabel(),s=this.assembler.createLabel(),o=r.getExpression();o.accept(this),this.assembler.emitLoadInteger(0),this.assembler.emit(Xi.l.Greater),this.assembler.emitBranchFalse(a),this.assembler.emit(Xi.l.LessEqual),this.assembler.emitBranchFalse(n),this.assembler.emitBranch(s),this.assembler.setLabel(a),this.assembler.emit(Xi.l.GreaterEqual),this.assembler.emitBranchFalse(n),this.assembler.setLabel(s),e.getStatements().accept(this),i.accept(this),o.accept(this),this.assembler.emitSystemCall(Xi.o.Inc,2)}else this.assembler.emit(Xi.l.LessEqual),this.assembler.emitBranchFalse(n),e.getStatements().accept(this),i.accept(this),this.assembler.emitSystemCall(Xi.o.Inc,1);this.assembler.emitBranch(t),this.assembler.setLabel(n)}},{key:"visitForeach",value:function(e){var t=this;console.warn("FOREACH is not yet fully supported by the code generator and runtime.");var n=this.assembler.createLabel(),i=this.assembler.createLabel();this.assembler.setLabel(n),e.getDesignators().forEach((function(e){return e.accept(t)})),e.getOf().accept(this),this.assembler.emitSystemCall(Xi.o.LoadForEachDesignators,e.getDesignators().length),this.assembler.emitBranchFalse(i),e.getBody().accept(this),this.assembler.emitBranch(n),this.assembler.setLabel(i)}},{key:"visitStatementBlock",value:function(e){e.getStatements().accept(this)}},{key:"visitUnaryExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitBinaryExpression",value:function(e){switch(e.getLeft().accept(this),e.getRight().accept(this),e.getOp()){case rt.Equal:this.assembler.emit(Xi.l.Equal);break;case rt.Less:this.assembler.emit(Xi.l.Less);break;case rt.LessEqual:this.assembler.emit(Xi.l.LessEqual);break;case rt.More:this.assembler.emit(Xi.l.Greater);break;case rt.MoreEqual:this.assembler.emit(Xi.l.GreaterEqual);break;case rt.NotEqual:this.assembler.emit(Xi.l.NotEqual)}}},{key:"visitTypeCheck",value:function(e){e.getDesignator().accept(this),e.getType().accept(this),this.assembler.emit(Xi.l.IsType)}},{key:"visitUnaryTermNode",value:function(e){switch(e.getTerm().accept(this),e.getOp()){case ft.Minus:this.assembler.emit(Xi.l.Negate)}}},{key:"visitTermChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}))}},{key:"visitRightTerm",value:function(e){switch(e.getRight().accept(this),e.getOp()){case pt.Minus:this.assembler.emit(Xi.l.Subtract);break;case pt.Or:this.assembler.emit(Xi.l.LogicOr);break;case pt.Plus:this.assembler.emit(Xi.l.Add)}}},{key:"visitFactorChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}))}},{key:"visitRightFactor",value:function(e){switch(e.getRight().accept(this),e.getOp()){case bt.AndText:this.assembler.emit(Xi.l.LogicAnd);break;case bt.Div:case bt.DivText:this.assembler.emit(Xi.l.Divide);break;case bt.Times:this.assembler.emit(Xi.l.Multiply);break;case bt.ModText:this.assembler.emit(Xi.l.Modulo)}}},{key:"visitUnaryFactor",value:function(e){switch(e.getFactor().accept(this),e.getPrefix()){case Ot.Not:this.assembler.emit(Xi.l.Not)}}},{key:"visitExpressionFactor",value:function(e){e.getExpression().accept(this)}},{key:"visitIntegerNumber",value:function(e){this.assembler.emitLoadInteger(e.getValue())}},{key:"visitRealNumber",value:function(e){this.assembler.emitLoadFloat(e.getValue())}},{key:"visitConstantCharacter",value:function(e){this.assembler.emitLoadCharacter(e.getCharacter())}},{key:"visitText",value:function(e){this.assembler.emitLoadText(e.getText())}},{key:"visitReceiveTest",value:function(e){var t=Object(f.d)(this.symbols.patternToSymbol.get(e.getPattern())),n=e.getDesignator();this.assembler.emit(Xi.l.LoadThis),null===n||void 0===n||n.accept(this),this.assembler.emit(Xi.l.ReceiveTest,this.metadata.findMessage(t))}},{key:"visitInputTest",value:function(e){var t=e.getDesignator();this.assembler.emit(Xi.l.LoadThis),null===t||void 0===t||t.accept(this),this.assembler.emit(Xi.l.InputTest)}},{key:"visitExistsTest",value:function(e){e.getDesignator().accept(this),this.assembler.emit(Xi.l.ExistsTest)}},{key:"visitFunctionCall",value:function(e){var t=this;e.getArguments().forEach((function(e){return e.accept(t)})),this.handleCall(Object(f.d)(this.symbols.callToSymbol.get(e)))}},{key:"visitProcedure",value:function(e){var t,i,r,a=Object(f.d)(this.symbols.procedureToSymbol.get(e)),s=new n(this.symbols,a,this.metadata),o=this.metadata.findProcedure(a);e.getDeclarations().filter((function(e){return e instanceof $n||e instanceof tt})).forEach((function(e){return e.accept(s)})),(t=o.declarations.init.instructions).push.apply(t,l(s.getInstructions())),Zi.fillDeclarations(o.declarations,a,this.metadata,this.symbols),null===(i=e.getStatements())||void 0===i||i.accept(s),(r=o.begin.instructions).push.apply(r,l(s.getInstructions()))}}]),n}(Zn),Ji=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbol=e,a.metadata=i,a.symbols=r,a}return Object(o.a)(n,[{key:"visitImplementation",value:function(e){var t,n,i,r=this.metadata.findImplementation(this.symbol),a=new Yi(this.symbols,this.symbol,this.metadata);Zi.fillDeclarations(r.declarations,this.symbol,this.metadata,this.symbols),e.getDeclarations().filter((function(e){return e instanceof $n||e instanceof tt})).forEach((function(e){return e.accept(a)})),(t=r.declarations.init.instructions).push.apply(t,l(a.getInstructions())),a=new Yi(this.symbols,this.symbol,this.metadata),null===(n=e.getStatements())||void 0===n||n.accept(a),(i=r.begin.instructions).push.apply(i,l(a.getInstructions()))}}]),n}(Zn),Ki=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e,i,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbol=e,a.metadata=i,a.symbols=r,a}return Object(o.a)(n,[{key:"visitComponentBody",value:function(e){var t,n,i,r,a,s,o,c=this,u=this.metadata.findComponent(this.symbol),h=new Yi(this.symbols,this.symbol,this.metadata);e.getDeclarations().filter((function(e){return e instanceof $n||e instanceof tt})).forEach((function(e){return e.accept(h)})),(t=u.declarations.init.instructions).push.apply(t,l(h.getInstructions())),e.getImplementations().forEach((function(e){var t=Object(f.d)(c.symbols.implementationToSymbol.get(e)),n=new Ji(t,c.metadata,c.symbols);e.accept(n)})),h=new Yi(this.symbols,this.symbol,this.metadata),null===(n=e.getBeginBlock())||void 0===n||n.accept(h),(i=u.begin.instructions).push.apply(i,l(h.getInstructions())),h=new Yi(this.symbols,this.symbol,this.metadata),null===(r=e.getActivityBlock())||void 0===r||r.accept(h),(a=u.activity.instructions).push.apply(a,l(h.getInstructions())),h=new Yi(this.symbols,this.symbol,this.metadata),null===(s=e.getFinallyBlock())||void 0===s||s.accept(h),(o=u.finally.instructions).push.apply(o,l(h.getInstructions()))}}]),n}(Zn),$i=function(){function e(){Object(s.a)(this,e),this.componentMapping=new Map,this.interfaceMapping=new Map,this.implementationMapping=new Map,this.procedureMapping=new Map,this.variableMapping=new Map,this.messageMapping=new Map,this.globalDescriptor=new Xi.c("@___@GLOBAL_DESCRIPTOR@___@")}return Object(o.a)(e,[{key:"getGlobalComponent",value:function(){return this.globalDescriptor}},{key:"pushComponent",value:function(e,t){this.componentMapping.set(e,t)}},{key:"findComponent",value:function(e){var t=this.componentMapping.get(e);if(void 0===t)throw new Error("Unknown Symbol <-> Component Mapping.");return t}},{key:"pushInterface",value:function(e,t){this.interfaceMapping.set(e,t)}},{key:"findInterface",value:function(e){var t=this.interfaceMapping.get(e);if(void 0===t)throw new Error("Unknown Symbol <-> Interface Mapping.");return t}},{key:"pushImplementation",value:function(e,t){this.implementationMapping.set(e,t)}},{key:"findImplementation",value:function(e){var t=this.implementationMapping.get(e);if(void 0===t)throw new Error("Unknown Symbol <-> Component Mapping.");return t}},{key:"pushProcedure",value:function(e,t){this.procedureMapping.set(e,t)}},{key:"findProcedure",value:function(e){var t=this.procedureMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Component Mapping.");return t}},{key:"pushVariable",value:function(e,t){this.variableMapping.set(e,t)}},{key:"findVariable",value:function(e){var t=this.variableMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Variable Mapping.");return t}},{key:"pushMessage",value:function(e,t){this.messageMapping.set(e,t)}},{key:"findMessage",value:function(e){var t=this.messageMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Message Mapping.");return t}},{key:"builtInTypeDescriptor",value:function(e){switch(e.identifier){case"INTEGER":return new Xi.h;case"REAL":return new Xi.d;case"BOOLEAN":return new Xi.a;case"CHARACTER":return new Xi.b;case"TEXT":return new Xi.p;default:throw new Error("Unsupported variable built in type symbol.")}}}]),e}(),Zi=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"generate",value:function(e){var t=this,n=new Xi.e,i=this.generateMetadata(e);return e.components.forEach((function(r){return t.generateComponent(r,e,n,i)})),n}},{key:"generateMetadata",value:function(e){var t=this,n=new $i;return n.pushComponent(e.anyComponentType,new Xi.c(e.anyComponentType.identifier)),n.pushInterface(e.anyRequiredInterfaceType,new Xi.i(e.anyRequiredInterfaceType.identifier)),n.pushMessage(e.finishMessage,new Xi.k(e.finishMessage.identifier)),n.pushMessage(e.anyMessage,new Xi.k(e.anyMessage.identifier)),e.getSystemProcedures().forEach((function(e){var i,r=new Xi.m(e.identifier,void 0);(i=r.parameters).push.apply(i,l(e.parameters.map((function(e){return new Xi.q(e.identifier,t.convertSymbolToDescriptor(e,n),!0)})))),n.pushProcedure(e,r)})),e.interfaces.forEach((function(e){return n.pushInterface(e,new Xi.i(e.identifier))})),e.components.forEach((function(e){return n.pushComponent(e,new Xi.c(e.identifier))})),e.messages.forEach((function(e){var i=new Xi.k(e.identifier);e.parameters.forEach((function(e){i.data.push(t.convertSymbolToDescriptor(e,n))})),n.pushMessage(e,i)})),e.interfaces.forEach((function(i){return t.fillInterface(i,n,e)})),e.impplementations.forEach((function(e){var t=new Xi.f(n.findInterface(e.interfaceSymbol));n.pushImplementation(e,t)})),e.variables.forEach((function(e){var i=t.convertSymbolToDescriptor(e.type,n),r=new Xi.q(e.identifier,i,!0);i instanceof Xi.p&&r.indexTypes.push(new Xi.h),n.pushVariable(e,r)})),e.collectionVariables.forEach((function(e){var i,r=t.convertSymbolToDescriptor(e.type,n),a=new Xi.q(e.identifier,r,!0);(i=a.indexTypes).push.apply(i,l(e.parameters.map((function(e){return t.convertSymbolToDescriptor(e,n)})))),n.pushVariable(e,a)})),e.procedures.forEach((function(i){var r,a=i.returnType,s=a===e.voidType?void 0:t.convertSymbolToDescriptor(a,n),o=new Xi.m(i.identifier,s);(r=o.parameters).push.apply(r,l(i.parameters.map((function(e){return new Xi.q(e.identifier,t.convertSymbolToDescriptor(e,n),!0)})))),n.pushProcedure(i,o)})),e.components.forEach((function(i){return t.fillComponent(i,n,e)})),n}},{key:"convertSymbolToDescriptor",value:function(e,t){if(e instanceof gi)return t.builtInTypeDescriptor(e);if(e instanceof bi)return t.findComponent(e);if(e instanceof mi)return t.findInterface(e);throw new Error("Cannot convert to descriptor")}},{key:"fillInterface",value:function(e,t,n){t.findInterface(e)}},{key:"fillComponent",value:function(t,n,i){var r=n.findComponent(t);t.genericType.offered.forEach((function(e){return r.offers.push(n.findInterface(e.interfaceSymbol))})),t.genericType.required.forEach((function(e){return r.requires.push(n.findInterface(e.interfaceSymbol))})),i.getImplementations(t).forEach((function(e){return r.implementations.push(n.findImplementation(e))})),e.fillDeclarations(r.declarations,t,n,i)}},{key:"generateComponent",value:function(e,t,n,i){var r,a=t.symbolToComponent.get(e);if(void 0===a||!(a instanceof Ke))throw new Error("Failed node lookup for component ".concat(e.identifier));null===(r=a.getBody())||void 0===r||r.accept(new Ki(e,i,t));var s=i.findComponent(e);n.components.push(s),e.isEntryPoint&&n.entryPoints.push(s)}}],[{key:"fillDeclarations",value:function(e,t,n,i){i.getVariables(t).forEach((function(t){return e.variables.push(n.findVariable(t))})),i.getCollectionVariables(t).forEach((function(t){return e.variables.push(n.findVariable(t))})),i.getProcedures(t).forEach((function(t){return e.procedures.push(n.findProcedure(t))}))}}]),e}(),er=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"compile",value:function(e,t){var n=new Ue,i=new He(n,e,t),r=new ti(n,i).parse();if(n.hasErrors())throw n.print(console.log),new Error("Error during Lexing and/or Parsing. See console.log.");var a=(new Hi).check(e,r);return(new Zi).generate(a)}}]),e}(),tr=n(14),nr=self,ir=!1;function rr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){void 0!==e&&nr.postMessage({output:e,running:ir})}))}function ar(e){var t=(ir=e)?"":"\n> ";nr.postMessage({output:t,running:ir})}var sr,or=new er;function cr(){(sr=new tr.a).changeOutput(rr.bind(nr)),sr.isRunningUpdate(ar.bind(nr))}nr.onmessage=function(){var e=Object(a.a)(r.a.mark((function e(t){var n,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("run"!==t.data.fn){e.next=15;break}return e.prev=1,cr(),ar(!0),i=or.compile(t.data.uri,t.data.code),e.next=7,null===(n=sr)||void 0===n?void 0:n.run(i);case 7:sr=void 0,e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0.stack),r=e.t0.message,ir=!1,nr.postMessage({output:"\n!!! ".concat(r," !!!\n\n"),running:ir}),sr=void 0;case 15:"stop"===t.data.fn&&(null===(a=sr)||void 0===a||a.halt());case 16:case"end":return e.stop()}var r}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();t.default=nr}]);
//# sourceMappingURL=system.worker.04519ee0.worker.js.map