!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=18)}([function(e,t,n){"use strict";n.d(t,"f",(function(){return G})),n.d(t,"d",(function(){return u})),n.d(t,"m",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"q",(function(){return k})),n.d(t,"c",(function(){return T})),n.d(t,"l",(function(){return b})),n.d(t,"n",(function(){return y})),n.d(t,"p",(function(){return w})),n.d(t,"b",(function(){return C})),n.d(t,"e",(function(){return S})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return P})),n.d(t,"o",(function(){return N})),n.d(t,"j",(function(){return M})),n.d(t,"k",(function(){return q})),n.d(t,"h",(function(){return _}));var r,a=n(1),i=n(2),s=n(3),o=n(4),c=function(){function e(t){Object(a.a)(this,e),this.name=t}return Object(i.a)(e,null,[{key:"push",value:function(e,t){return e.push(t)-1}},{key:"load",value:function(e,t){if(t>=e.length||t<0)throw new Error("Invalid load index ".concat(t,", target size ").concat(e.length,"."));return e[t]}}]),e}(),u=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).procedures=new Array,r.implementations=new Array,r.fields=new Array,r.offers=new Array,r.requires=new Array,r.initCode=new p,r.beginCode=new p,r.activityCode=new p,r.finallyCode=new p,r}return Object(i.a)(n,[{key:"getInitCode",value:function(){return this.initCode}},{key:"getBeginCode",value:function(){return this.beginCode}},{key:"getActivityCode",value:function(){return this.activityCode}},{key:"getFinallyCode",value:function(){return this.finallyCode}},{key:"pushProcedure",value:function(e){return c.push(this.procedures,e)}},{key:"loadProcedure",value:function(e){return c.load(this.procedures,e)}},{key:"pushImplementation",value:function(e){return c.push(this.implementations,e)}},{key:"loadImplementation",value:function(e){return c.load(this.implementations,e)}},{key:"pushField",value:function(e){return c.push(this.fields,e)}},{key:"loadField",value:function(e){return c.load(this.fields,e)}},{key:"pushOffer",value:function(e){return c.push(this.offers,e)}},{key:"loadOffer",value:function(e){return c.load(this.offers,e)}},{key:"pushRequires",value:function(e){return c.push(this.requires,e)}},{key:"loadRequires",value:function(e){return c.load(this.requires,e)}}]),n}(c);!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(r||(r={}));var l,h=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).instructions=new Array,e}return Object(i.a)(n,[{key:"getInstructions",value:function(){return this.instructions}}]),n}(c);!function(e){e[e.Tag=0]="Tag"}(l||(l={}));var f,p=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this,"@@__LOCAL_CODE_BLOCK__@@"))._localCodeBlockDescriptor=l.Tag,e}return n}(h),v=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e)).parent=r,s.paramTypes=i,s}return n}(h),g=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,e)).parent=r,i}return n}(h);!function(e){e[e.Tag=0]="Tag"}(f||(f={}));var b,y,m,d=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments))._variableDescriptorBaseTag=f.Tag,e}return n}(c),k=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).value=void 0,e}return Object(i.a)(n,[{key:"getValue",value:function(){return this.value}},{key:"updateValue",value:function(e){this.value=e}}]),n}(d),T=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).values=new Map,e}return Object(i.a)(n,[{key:"getValue",value:function(e){var t=this.values.get(e);if(void 0===t)throw new Error("Failed to lookup collection variable.");return t}},{key:"updateValue",value:function(e,t){this.values.set(e,t)}}]),n}(d),x=n(8);!function(e){e[e.Add=0]="Add",e[e.Subtract=1]="Subtract",e[e.Multiply=2]="Multiply",e[e.Divide=3]="Divide",e[e.Negate=4]="Negate",e[e.Modulo=5]="Modulo",e[e.Equal=6]="Equal",e[e.Less=7]="Less",e[e.LessEqual=8]="LessEqual",e[e.Greater=9]="Greater",e[e.GreaterEqual=10]="GreaterEqual",e[e.NotEqual=11]="NotEqual",e[e.Not=12]="Not",e[e.LogicOr=13]="LogicOr",e[e.LogicAnd=14]="LogicAnd",e[e.New=15]="New",e[e.Delete=16]="Delete",e[e.Send=17]="Send",e[e.Receive=18]="Receive",e[e.Connect=19]="Connect",e[e.Disconnect=20]="Disconnect",e[e.CheckReceive=21]="CheckReceive",e[e.SysCall=22]="SysCall",e[e.ProcedureCall=23]="ProcedureCall",e[e.Return=24]="Return",e[e.LoadConstantBoolean=25]="LoadConstantBoolean",e[e.LoadConstantText=26]="LoadConstantText",e[e.LoadConstantCharacter=27]="LoadConstantCharacter",e[e.LoadConstantFloat=28]="LoadConstantFloat",e[e.LoadConstantInteger=29]="LoadConstantInteger",e[e.LoadDescriptor=30]="LoadDescriptor",e[e.LoadThis=31]="LoadThis",e[e.Move=32]="Move",e[e.StoreArgument=33]="StoreArgument",e[e.LoadArgument=34]="LoadArgument",e[e.StoreLocalVariable=35]="StoreLocalVariable",e[e.LoadLocalVariable=36]="LoadLocalVariable",e[e.StoreVariable=37]="StoreVariable",e[e.LoadVariable=38]="LoadVariable",e[e.StoreCollectionVariable=39]="StoreCollectionVariable",e[e.LoadCollectionVariable=40]="LoadCollectionVariable",e[e.StoreConstantVariable=41]="StoreConstantVariable",e[e.LoadConstantVariable=42]="LoadConstantVariable",e[e.Await=43]="Await",e[e.AcquireShared=44]="AcquireShared",e[e.ReleaseShared=45]="ReleaseShared",e[e.AcquireExclusive=46]="AcquireExclusive",e[e.ReleaseExclusive=47]="ReleaseExclusive",e[e.Branch=48]="Branch",e[e.BranchTrue=49]="BranchTrue",e[e.BranchFalse=50]="BranchFalse",e[e.IsType=51]="IsType"}(b||(b={})),function(e){e[e.Write=0]="Write",e[e.WriteLine=1]="WriteLine",e[e.WriteHex=2]="WriteHex",e[e.Assert1=3]="Assert1",e[e.Assert2=4]="Assert2",e[e.Halt=5]="Halt",e[e.Inc1=6]="Inc1",e[e.Inc2=7]="Inc2",e[e.Dec1=8]="Dec1",e[e.Dec2=9]="Dec2",e[e.Passivate=10]="Passivate",e[e.Count=11]="Count",e[e.Length=12]="Length",e[e.Sqrt=13]="Sqrt",e[e.Sin=14]="Sin",e[e.Cos=15]="Cos",e[e.Tan=16]="Tan",e[e.ArcSin=17]="ArcSin",e[e.ArcCos=18]="ArcCos",e[e.ArcTan=19]="ArcTan",e[e.Random=20]="Random",e[e.Min=21]="Min",e[e.Max=22]="Max",e[e.ToCharacter=23]="ToCharacter",e[e.ToInteger=24]="ToInteger",e[e.ToReal=25]="ToReal",e[e.ToText=26]="ToText"}(y||(y={})),function(e){e[e.Tag=0]="Tag"}(m||(m={}));var O,w=function e(t){Object(a.a)(this,e),this.value=t,this._textValueTag=m.Tag};!function(e){e[e.Tag=0]="Tag"}(O||(O={}));var E,C=function e(t){Object(a.a)(this,e),this.value=t,this._characterValueTag=O.Tag};!function(e){e[e.Tag=0]="Tag"}(E||(E={}));var j,S=function e(t){Object(a.a)(this,e),this.value=t,this._floatValueTag=E.Tag};!function(e){e[e.Tag=0]="Tag"}(j||(j={}));var L,I=function e(t){Object(a.a)(this,e),this.value=t,this._integerValueTag=j.Tag};!function(e){e[e.Tag=0]="Tag"}(L||(L={}));var F,P=function e(t){Object(a.a)(this,e),this.value=t,this._booleanValueTag=L.Tag};!function(e){e[e.Tag=0]="Tag"}(F||(F={}));var A,N=function e(t){Object(a.a)(this,e),this.value=t,this._systemCallValueTag=F.Tag};!function(e){e[e.Tag=0]="Tag"}(A||(A={}));var R;!function(e){e[e.Tag=0]="Tag"}(R||(R={}));var D;!function(e){e[e.Tag=0]="Tag"}(D||(D={}));var B;!function(e){e[e.Tag=0]="Tag"}(B||(B={}));var V,M=function e(t){Object(a.a)(this,e),this.offset=t,this._jumpOffsetTag=B.Tag};!function(e){e[e.Tag=0]="Tag"}(V||(V={}));var q=function e(){Object(a.a)(this,e),this._labelTag=V.Tag},_=function(){function e(t){Object(a.a)(this,e),this.opCode=t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.operands=Object(x.a)(Array,r)}return Object(i.a)(e,[{key:"getOpCode",value:function(){return this.opCode}},{key:"getOperands",value:function(){return this.operands}}]),e}(),G=function(){function e(){Object(a.a)(this,e),this.entryPoints=new Array,this.components=new Array,this.interfaces=new Array}return Object(i.a)(e,[{key:"pushEntry",value:function(e){this.entryPoints.push(e)}},{key:"getEntryPoints",value:function(){return this.entryPoints}},{key:"pushComponent",value:function(e){return c.push(this.components,e)}},{key:"loadComponent",value:function(e){return c.load(this.components,e)}},{key:"pushInterface",value:function(e){return c.push(this.interfaces,e)}},{key:"loadInterface",value:function(e){return c.load(this.interfaces,e)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(r.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(9),a=n(12);function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){var t=Object(a.a)();return function(){var n,a=Object(r.a)(e);if(t){var i=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return s(this,n)}}},function(e,t,n){e.exports=n(16)},function(e,t,n){"use strict";function r(e,t,n,r,a,i,s){try{var o=e[i](s),c=o.value}catch(u){return void n(u)}o.done?t(c):Promise.resolve(c).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function o(e){r(s,a,i,o,c,"next",e)}function c(e){r(s,a,i,o,c,"throw",e)}o(void 0)}))}}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10),a=n(12);function i(e,t,n){return(i=Object(a.a)()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&Object(r.a)(i,n.prototype),i}).apply(null,arguments)}},function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(5),a=n.n(r),i=n(6),s=n(1),o=n(2),c=n(14),u=n(13),l=n(15),h=function(){function t(){Object(s.a)(this,t),this.scheduler=new c.a,this.nextTaskId=0,this.stop=!1,this.out=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.stdout.write(t)}))},this.isRunning=function(){},this.currentIl=void 0}return Object(o.a)(t,[{key:"reset",value:function(){this.stop=!0}},{key:"changeOutput",value:function(e){this.out=e}},{key:"isRunningUpdate",value:function(e){this.isRunning=e}},{key:"haltProcess",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scheduler.killTask(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"haltProcessWithCode",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.print("Halting process, code ".concat(n));case 2:this.scheduler.killTask(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"time",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(new Date).getMilliseconds());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop=!1,this.currentIl=t,e.next=4,this.run();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning(!0),null===(t=this.currentIl)||void 0===t||t.getEntryPoints().forEach(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.createTask(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n=this.scheduler.getActiveTask();case 3:if(void 0===n||this.stop){e.next=9;break}return e.next=6,n.execute();case 6:n=this.scheduler.getActiveTask(),e.next=3;break;case 9:this.isRunning(!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"print",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.out.apply(this,t);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createTask",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.nextTaskId++,r=new u.a(n,new l.a(this,n),t),this.scheduler.enqueue(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return void 0===this.instance&&(this.instance=new t),this.instance}}]),t}();h.instance=void 0}).call(this,n(17))},function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return g}));var r,a=n(7),i=n(3),s=n(4),o=n(5),c=n.n(o),u=n(6),l=n(1),h=n(2);!function(e){e[e.Waiting=0]="Waiting",e[e.Init=1]="Init",e[e.Ready=2]="Ready",e[e.Running=3]="Running",e[e.Finally=4]="Finally",e[e.Done=5]="Done"}(r||(r={}));var f,p=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,[{key:"post",value:function(e){this.data=e}},{key:"receive",value:function(){return this.data}},{key:"check",value:function(){return void 0!==this.data}}]),e}(),v=function(){function e(t,n,r){Object(l.a)(this,e),this.id=t,this.state=n,this.processor=r,this.mailbox=new p}return Object(h.a)(e,[{key:"getMailbox",value:function(){return this.mailbox}},{key:"execute",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isDone();case 2:if(!e.sent){e.next=5;break}return this.state=r.Done,e.abrupt("return");case 5:return e.next=7,this.processor.processNext();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTaskId",value:function(){return this.id}},{key:"getState",value:function(){return this.state}}]),e}();!function(e){e[e.None=0]="None",e[e.Begin=1]="Begin",e[e.Activity=2]="Activity",e[e.Finally=3]="Finally"}(f||(f={}));var g=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(e,a,i){var s;return Object(l.a)(this,n),(s=t.call(this,e,r.Waiting,a)).descriptor=i,s.childTasks=new Array,s.activeBlock=f.None,s}return Object(h.a)(n,[{key:"addChild",value:function(e){this.childTasks.push(e)}},{key:"loadBlock",value:function(e,t){var n;return 0!==e.getInstructions().length&&(this.activeBlock=t,(n=this.processor).load.apply(n,Object(a.a)(e.getInstructions())),!0)}},{key:"loadNextCodeBlock",value:function(){switch(this.activeBlock){case f.None:return this.loadBlock(this.descriptor.getBeginCode(),f.Begin)||this.loadBlock(this.descriptor.getActivityCode(),f.Activity)||this.loadBlock(this.descriptor.getFinallyCode(),f.Finally);case f.Begin:return this.loadBlock(this.descriptor.getActivityCode(),f.Activity)||this.loadBlock(this.descriptor.getFinallyCode(),f.Finally);case f.Activity:return this.loadBlock(this.descriptor.getFinallyCode(),f.Finally)}return!1}},{key:"isDone",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.processor.isDone()&&!this.loadNextCodeBlock());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(v)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a=n(2),i=n(13),s=function(){function e(){Object(r.a)(this,e),this.activeTask=void 0,this.readyTasks=new Array}return Object(a.a)(e,[{key:"enqueue",value:function(e){this.readyTasks.push(e)}},{key:"getActiveTask",value:function(){return this.scheduleNext(),this.activeTask}},{key:"killTask",value:function(e){this.readyTasks=this.readyTasks.filter((function(t){return t.getTaskId()!==e}))}},{key:"scheduleNext",value:function(){void 0!==this.activeTask&&this.activeTask.getState()!==i.b.Done&&this.readyTasks.push(this.activeTask),this.activeTask=this.readyTasks.shift()}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),a=n.n(r),i=n(6),s=n(1),o=n(2),c=n(0),u=function(){function e(){Object(s.a)(this,e),this.stack=new Array}return Object(o.a)(e,[{key:"pop",value:function(){if(0!==this.stack.length)return this.stack.pop()}},{key:"push",value:function(e){this.stack.push(e)}}]),e}(),l=function(){function e(t,n){Object(s.a)(this,e),this.sysCaller=t,this.processId=n,this.code=new Array,this.instructionPointer=0,this.evalStack=new u}return Object(o.a)(e,[{key:"load",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.code=t,this.instructionPointer=0,this.evalStack=new u}},{key:"isDone",value:function(){return this.code.length<=this.instructionPointer}},{key:"syscall",value:function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i,s,o,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==n.length){t.next=2;break}throw new Error("System call operation failed, no operand found.");case 2:if(n[0]instanceof c.o){t.next=4;break}throw new Error("System call operation failed, first operandmust be a system call value.");case 4:t.t0=n[0].value,t.next=t.t0===c.n.WriteLine?7:10;break;case 7:return t.next=9,this.sysCaller.print("\n");case 9:return t.abrupt("return");case 10:r=this.evalStack.pop(),t.t1=n[0].value,t.next=t.t1===c.n.Write?14:t.t1===c.n.WriteHex?20:t.t1===c.n.Assert1?26:t.t1===c.n.Halt?34:t.t1===c.n.Inc1?40:t.t1===c.n.Dec1?50:t.t1===c.n.Passivate?60:t.t1===c.n.Count?61:t.t1===c.n.Length?65:t.t1===c.n.Sqrt?69:t.t1===c.n.Sin?74:t.t1===c.n.Cos?79:t.t1===c.n.Tan?84:t.t1===c.n.ArcSin?89:t.t1===c.n.ArcCos?94:t.t1===c.n.ArcTan?99:t.t1===c.n.Min?104:t.t1===c.n.Max?106:t.t1===c.n.ToCharacter?108:t.t1===c.n.ToText?113:t.t1===c.n.ToInteger?118:t.t1===c.n.ToReal?123:128;break;case 14:if(!((r=e.tryLoadVariableValue(r))instanceof c.p||r instanceof c.b||r instanceof c.e||r instanceof c.i)){t.next=19;break}return t.next=18,this.sysCaller.print(r.value.toString());case 18:return t.abrupt("return");case 19:return t.abrupt("break",128);case 20:if(!((r=e.tryLoadVariableValue(r))instanceof c.i)){t.next=25;break}return t.next=24,this.sysCaller.print(r.value.toString(16));case 24:return t.abrupt("return");case 25:return t.abrupt("break",128);case 26:if(!((r=e.tryLoadVariableValue(r))instanceof c.a)){t.next=33;break}if(r.value){t.next=33;break}return t.next=31,this.sysCaller.print("Assertion failed.\n");case 31:return t.next=33,this.sysCaller.haltProcess(this.processId);case 33:return t.abrupt("break",128);case 34:if(!((r=e.tryLoadVariableValue(r))instanceof c.i)){t.next=39;break}return t.next=38,this.sysCaller.haltProcessWithCode(this.processId,r.value);case 38:return t.abrupt("return");case 39:return t.abrupt("break",128);case 40:if(!(r instanceof c.q)){t.next=46;break}if(!((i=r.getValue())instanceof c.i)){t.next=46;break}return r.updateValue(new c.i(i.value+1)),this.evalStack.push(r),t.abrupt("return");case 46:if(!(r instanceof c.i)){t.next=49;break}return this.evalStack.push(new c.i(r.value+1)),t.abrupt("return");case 49:return t.abrupt("break",128);case 50:if(!(r instanceof c.q)){t.next=56;break}if(!((s=r.getValue())instanceof c.i)){t.next=56;break}return r.updateValue(new c.i(s.value-1)),this.evalStack.push(r),t.abrupt("return");case 56:if(!(r instanceof c.i)){t.next=59;break}return this.evalStack.push(new c.i(r.value-1)),t.abrupt("return");case 59:return t.abrupt("break",128);case 60:return t.abrupt("return");case 61:if(!(r instanceof c.p)){t.next=64;break}return this.evalStack.push(new c.i(1)),t.abrupt("return");case 64:return t.abrupt("return");case 65:if(!(r instanceof c.p)){t.next=68;break}return this.evalStack.push(new c.i(r.value.length)),t.abrupt("return");case 68:return t.abrupt("break",128);case 69:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=73;break}return this.evalStack.push(new c.e(Math.sqrt(r.value))),t.abrupt("return");case 73:return t.abrupt("break",128);case 74:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=78;break}return this.evalStack.push(new c.e(Math.sin(r.value))),t.abrupt("return");case 78:return t.abrupt("break",128);case 79:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=83;break}return this.evalStack.push(new c.e(Math.cos(r.value))),t.abrupt("return");case 83:return t.abrupt("break",128);case 84:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=88;break}return this.evalStack.push(new c.e(Math.tan(r.value))),t.abrupt("return");case 88:return t.abrupt("break",128);case 89:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=93;break}return this.evalStack.push(new c.e(Math.asin(r.value))),t.abrupt("return");case 93:return t.abrupt("break",128);case 94:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=98;break}return this.evalStack.push(new c.e(Math.acos(r.value))),t.abrupt("return");case 98:return t.abrupt("break",128);case 99:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=103;break}return this.evalStack.push(new c.e(Math.atan(r.value))),t.abrupt("return");case 103:return t.abrupt("break",128);case 104:return this.evalStack.push(new c.e(Number.MIN_VALUE)),t.abrupt("return");case 106:return this.evalStack.push(new c.e(Number.MAX_VALUE)),t.abrupt("return");case 108:if(!((r=e.tryLoadVariableValue(r))instanceof c.i)){t.next=112;break}return this.evalStack.push(new c.b(String.fromCharCode(r.value))),t.abrupt("return");case 112:return t.abrupt("break",128);case 113:if(!((r=e.tryLoadVariableValue(r))instanceof c.b)){t.next=117;break}return this.evalStack.push(new c.p(r.value)),t.abrupt("return");case 117:return t.abrupt("break",128);case 118:if(!((r=e.tryLoadVariableValue(r))instanceof c.e)){t.next=122;break}return this.evalStack.push(new c.i(Math.trunc(r.value))),t.abrupt("return");case 122:return t.abrupt("break",128);case 123:if(!((r=e.tryLoadVariableValue(r))instanceof c.i)){t.next=127;break}return this.evalStack.push(new c.e(r.value)),t.abrupt("return");case 127:return t.abrupt("break",128);case 128:o=this.evalStack.pop(),t.t2=n[0].value,t.next=t.t2===c.n.Assert2?132:t.t2===c.n.Inc2?140:t.t2===c.n.Dec2?151:t.t2===c.n.Random?162:168;break;case 132:if(r=e.tryLoadVariableValue(r),!((o=e.tryLoadVariableValue(o))instanceof c.a&&r instanceof c.i)){t.next=139;break}if(o.value){t.next=139;break}return this.sysCaller.print("Assertion failed. Code ".concat(r,".")),this.sysCaller.haltProcessWithCode(this.processId,r.value),t.abrupt("return");case 139:return t.abrupt("break",168);case 140:if(r=e.tryLoadVariableValue(r),!(o instanceof c.q)){t.next=147;break}if(!((u=o.getValue())instanceof c.i&&r instanceof c.i)){t.next=147;break}return o.updateValue(new c.i(u.value+r.value)),this.evalStack.push(r),t.abrupt("return");case 147:if(!(o instanceof c.i&&r instanceof c.i)){t.next=150;break}return this.evalStack.push(new c.i(o.value+r.value)),t.abrupt("return");case 150:return t.abrupt("break",168);case 151:if(r=e.tryLoadVariableValue(r),!(o instanceof c.q)){t.next=158;break}if(!((l=o.getValue())instanceof c.i&&r instanceof c.i)){t.next=158;break}return o.updateValue(new c.i(l.value-r.value)),this.evalStack.push(r),t.abrupt("return");case 158:if(!(o instanceof c.i&&r instanceof c.i)){t.next=161;break}return this.evalStack.push(new c.i(o.value-r.value)),t.abrupt("return");case 161:return t.abrupt("break",168);case 162:if(r=e.tryLoadVariableValue(r),!((o=e.tryLoadVariableValue(o))instanceof c.i&&r instanceof c.i)){t.next=167;break}return this.evalStack.push(new c.i(Math.trunc(Math.random()*r.value)+o.value)),t.abrupt("return");case 167:return t.abrupt("break",168);case 168:throw new Error("Failed system call '".concat(n[0].value,"'. Operation not supported."));case 169:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.p&&r instanceof c.p)){t.next=5;break}return this.evalStack.push(new c.p(r.value+n.value)),t.abrupt("return");case 5:if(!(n instanceof c.e&&r instanceof c.e)){t.next=8;break}return this.evalStack.push(new c.e(r.value+n.value)),t.abrupt("return");case 8:if(!(n instanceof c.i&&r instanceof c.i)){t.next=11;break}return this.evalStack.push(new c.i(Math.trunc(r.value+n.value))),t.abrupt("return");case 11:throw new Error("Add operation failed.");case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"sub",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.e&&r instanceof c.e)){t.next=5;break}return this.evalStack.push(new c.e(r.value-n.value)),t.abrupt("return");case 5:if(!(n instanceof c.i&&r instanceof c.i)){t.next=8;break}return this.evalStack.push(new c.i(Math.trunc(r.value-n.value))),t.abrupt("return");case 8:throw new Error("Sub operation failed.");case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"mul",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.e&&r instanceof c.e)){t.next=5;break}return this.evalStack.push(new c.e(r.value*n.value)),t.abrupt("return");case 5:if(!(n instanceof c.i&&r instanceof c.i)){t.next=8;break}return this.evalStack.push(new c.i(Math.trunc(r.value*n.value))),t.abrupt("return");case 8:throw new Error("Mul operation failed.");case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"div",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.e&&r instanceof c.e)){t.next=5;break}return this.evalStack.push(new c.e(r.value/n.value)),t.abrupt("return");case 5:if(!(n instanceof c.i&&r instanceof c.i)){t.next=8;break}return this.evalStack.push(new c.i(Math.trunc(r.value/n.value))),t.abrupt("return");case 8:throw new Error("Div operation failed.");case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"mod",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.e&&r instanceof c.e)){t.next=5;break}return this.evalStack.push(new c.e(r.value%n.value)),t.abrupt("return");case 5:if(!(n instanceof c.i&&r instanceof c.i)){t.next=8;break}return this.evalStack.push(new c.i(Math.trunc(r.value%n.value))),t.abrupt("return");case 8:throw new Error("Mod operation failed.");case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"and",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.a&&r instanceof c.a)){t.next=5;break}return this.evalStack.push(new c.a(r.value&&n.value)),t.abrupt("return");case 5:throw new Error("And operation failed.");case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"or",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),r=e.tryLoadVariableValue(this.evalStack.pop()),!(n instanceof c.a&&r instanceof c.a)){t.next=5;break}return this.evalStack.push(new c.a(r.value||n.value)),t.abrupt("return");case 5:throw new Error("Or operation failed.");case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"not",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=e.tryLoadVariableValue(this.evalStack.pop()))instanceof c.a)){t.next=4;break}return this.evalStack.push(new c.a(!n.value)),t.abrupt("return");case 4:throw new Error("Not operation failed.");case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"negate",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=e.tryLoadVariableValue(this.evalStack.pop()))instanceof c.e)){t.next=4;break}return this.evalStack.push(new c.e(-n.value)),t.abrupt("return");case 4:if(!(n instanceof c.i)){t.next=7;break}return this.evalStack.push(new c.i(-n.value)),t.abrupt("return");case 7:throw new Error("Negate operation failed.");case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadText",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>=1&&t[0]instanceof c.p)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Text load operation failed.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadCharacter",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>=1&&t[0]instanceof c.b)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Character load operation failed.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadFloat",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0&&t[0]instanceof c.e)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Float load operation failed.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadInteger",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0&&t[0]instanceof c.i)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Integer load operation failed.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadBoolean",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0&&t[0]instanceof c.a)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Boolean load operation failed.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"branch",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1===t.length){e.next=2;break}throw new Error("Branch conditions only have one operand.");case 2:if(!((n=t[0])instanceof c.j)){e.next=6;break}return this.instructionPointer=this.instructionPointer+n.offset,e.abrupt("return");case 6:throw new Error("Failed jump.");case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"branchConditionally",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.evalStack.pop(),1===n.length){e.next=3;break}throw new Error("Branch conditions only have one operand.");case 3:if(!(r instanceof c.a&&n[0]instanceof c.j)){e.next=8;break}if(r.value!==t){e.next=7;break}return this.branch(n),e.abrupt("return");case 7:return e.abrupt("return");case 8:throw new Error("Conditional jump failed.");case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"compareLessGreater",value:function(){var t=Object(i.a)(a.a.mark((function t(n,r,i){var s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null!==(s=e.tryLoadVariableValue(n))&&void 0!==s?s:n,r=null!==(o=e.tryLoadVariableValue(r))&&void 0!==o?o:r,!(n instanceof c.i&&r instanceof c.i)){t.next=5;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 5:if(!(n instanceof c.e&&r instanceof c.e)){t.next=8;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 8:if(!(n instanceof c.p&&r instanceof c.p)){t.next=11;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 11:if(!(n instanceof c.b&&r instanceof c.b)){t.next=14;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 14:throw new Error("Unsupported less/greater comparison.");case 15:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"compareEquality",value:function(){var t=Object(i.a)(a.a.mark((function t(n,r,i){var s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null!==(s=e.tryLoadVariableValue(n))&&void 0!==s?s:n,r=null!==(o=e.tryLoadVariableValue(r))&&void 0!==o?o:r,!(n instanceof c.a&&r instanceof c.a)){t.next=5;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 5:if(!(n instanceof c.i&&r instanceof c.i)){t.next=8;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 8:if(!(n instanceof c.e&&r instanceof c.e)){t.next=11;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 11:if(!(n instanceof c.p&&r instanceof c.p)){t.next=14;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 14:if(!(n instanceof c.b&&r instanceof c.b)){t.next=17;break}return this.evalStack.push(new c.a(i(n.value,r.value))),t.abrupt("return");case 17:throw new Error("Unsupported equality comparison.");case 18:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"handleCompareOp",value:function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=e.tryLoadVariableValue(this.evalStack.pop()))){t.next=3;break}throw new Error("Unknown right compare argument.");case 3:if(void 0!==(i=e.tryLoadVariableValue(this.evalStack.pop()))){t.next=6;break}throw new Error("Unknown left compare argument.");case 6:t.t0=n,t.next=t.t0===c.l.Equal?9:t.t0===c.l.NotEqual?12:t.t0===c.l.Less?15:t.t0===c.l.LessEqual?18:t.t0===c.l.Greater?21:t.t0===c.l.GreaterEqual?24:27;break;case 9:return t.next=11,this.compareEquality(i,r,(function(e,t){return e===t}));case 11:return t.abrupt("return");case 12:return t.next=14,this.compareEquality(i,r,(function(e,t){return e!==t}));case 14:return t.abrupt("return");case 15:return t.next=17,this.compareLessGreater(i,r,(function(e,t){return e<t}));case 17:return t.abrupt("return");case 18:return t.next=20,this.compareLessGreater(i,r,(function(e,t){return e<=t}));case 20:return t.abrupt("return");case 21:return t.next=23,this.compareLessGreater(i,r,(function(e,t){return e>t}));case 23:return t.abrupt("return");case 24:return t.next=26,this.compareLessGreater(i,r,(function(e,t){return e>=t}));case 26:return t.abrupt("return");case 27:throw new Error("Unsupprted compare op.");case 28:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"storeVariable",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tryLoadVariableValue(this.evalStack.pop()),!((r=this.evalStack.pop())instanceof c.q)){t.next=10;break}if(void 0!==(i=r.getValue())||!(n instanceof c.i||n instanceof c.e||n instanceof c.a||n instanceof c.b||n instanceof c.p||n instanceof c.d)){t.next=7;break}return r.updateValue(n),t.abrupt("return");case 7:if(!(n instanceof c.i&&i instanceof c.i||n instanceof c.i&&i instanceof c.i||n instanceof c.e&&i instanceof c.e||n instanceof c.a&&i instanceof c.a||n instanceof c.b&&i instanceof c.b||n instanceof c.p&&i instanceof c.p||n instanceof c.d&&i instanceof c.d)){t.next=10;break}return r.updateValue(n),t.abrupt("return");case 10:throw new Error("Unsupported Variable Store.");case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadVariable",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(1===t.length&&t[0]instanceof c.q)){e.next=3;break}return this.evalStack.push(t[0]),e.abrupt("return");case 3:throw new Error("Unsupported Variable Load.");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processNext",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDone()){e.next=2;break}return e.abrupt("return");case 2:t=this.code[this.instructionPointer++],e.t0=t.getOpCode(),e.next=e.t0===c.l.New?6:e.t0===c.l.Delete?9:e.t0===c.l.SysCall?10:e.t0===c.l.LoadConstantText?13:e.t0===c.l.LoadConstantCharacter?15:e.t0===c.l.LoadConstantFloat?17:e.t0===c.l.LoadConstantInteger?19:e.t0===c.l.LoadConstantBoolean?22:e.t0===c.l.Add?25:e.t0===c.l.Subtract?28:e.t0===c.l.Multiply?31:e.t0===c.l.Divide?34:e.t0===c.l.Modulo?37:e.t0===c.l.LogicAnd?40:e.t0===c.l.LogicOr?43:e.t0===c.l.Not?46:e.t0===c.l.Negate?49:e.t0===c.l.Equal||e.t0===c.l.Less||e.t0===c.l.LessEqual||e.t0===c.l.Greater||e.t0===c.l.GreaterEqual||e.t0===c.l.NotEqual?52:e.t0===c.l.Branch?55:e.t0===c.l.BranchFalse?58:e.t0===c.l.BranchTrue?61:e.t0===c.l.Send?64:e.t0===c.l.Receive?65:e.t0===c.l.Connect?66:e.t0===c.l.Disconnect?67:e.t0===c.l.CheckReceive?68:e.t0===c.l.ProcedureCall?69:e.t0===c.l.Return?70:e.t0===c.l.LoadDescriptor?71:e.t0===c.l.LoadThis?72:e.t0===c.l.Move?73:e.t0===c.l.StoreArgument?74:e.t0===c.l.LoadArgument?75:e.t0===c.l.StoreLocalVariable?76:e.t0===c.l.LoadLocalVariable?77:e.t0===c.l.StoreVariable?78:e.t0===c.l.LoadVariable?80:e.t0===c.l.StoreCollectionVariable?82:e.t0===c.l.LoadCollectionVariable?83:e.t0===c.l.StoreConstantVariable?84:e.t0===c.l.LoadConstantVariable?85:e.t0===c.l.Await?86:e.t0===c.l.AcquireShared?87:e.t0===c.l.ReleaseShared?88:e.t0===c.l.AcquireExclusive?89:e.t0===c.l.ReleaseExclusive?90:e.t0===c.l.IsType?91:92;break;case 6:return e.next=8,this.sysCaller.createTask(t.getOperands()[0]);case 8:case 9:return e.abrupt("break",92);case 10:return e.next=12,this.syscall(t.getOperands());case 12:return e.abrupt("break",92);case 13:return this.loadText(t.getOperands()),e.abrupt("break",92);case 15:return this.loadCharacter(t.getOperands()),e.abrupt("break",92);case 17:return this.loadFloat(t.getOperands()),e.abrupt("break",92);case 19:return e.next=21,this.loadInteger(t.getOperands());case 21:return e.abrupt("break",92);case 22:return e.next=24,this.loadBoolean(t.getOperands());case 24:return e.abrupt("break",92);case 25:return e.next=27,this.add();case 27:return e.abrupt("break",92);case 28:return e.next=30,this.sub();case 30:return e.abrupt("break",92);case 31:return e.next=33,this.mul();case 33:return e.abrupt("break",92);case 34:return e.next=36,this.div();case 36:return e.abrupt("break",92);case 37:return e.next=39,this.mod();case 39:return e.abrupt("break",92);case 40:return e.next=42,this.and();case 42:return e.abrupt("break",92);case 43:return e.next=45,this.or();case 45:return e.abrupt("break",92);case 46:return e.next=48,this.not();case 48:return e.abrupt("break",92);case 49:return e.next=51,this.negate();case 51:return e.abrupt("break",92);case 52:return e.next=54,this.handleCompareOp(t.getOpCode());case 54:return e.abrupt("break",92);case 55:return e.next=57,this.branch(t.getOperands());case 57:return e.abrupt("break",92);case 58:return e.next=60,this.branchConditionally(!1,t.getOperands());case 60:return e.abrupt("break",92);case 61:return e.next=63,this.branchConditionally(!0,t.getOperands());case 63:case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:return e.abrupt("break",92);case 78:return this.storeVariable(),e.abrupt("break",92);case 80:return this.loadVariable(t.getOperands()),e.abrupt("break",92);case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:return e.abrupt("break",92);case 92:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"tryLoadVariableValue",value:function(e){return e instanceof c.q?e.getValue():e}}]),e}()},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",o=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(F){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,i=Object.create(a.prototype),s=new S(r||[]);return i._invoke=function(e,t,n){var r=h;return function(a,i){if(r===p)throw new Error("Generator is already running");if(r===v){if("throw"===a)throw i;return I()}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var o=E(s,n);if(o){if(o===g)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?v:f,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=v,n.method="throw",n.arg=c.arg)}}}(e,n,s),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(F){return{type:"throw",arg:F}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",v="completed",g={};function b(){}function y(){}function m(){}var d={};d[i]=function(){return this};var k=Object.getPrototypeOf,T=k&&k(k(L([])));T&&T!==n&&r.call(T,i)&&(d=T);var x=m.prototype=b.prototype=Object.create(d);function O(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(a,i,s,o){var c=l(e[a],e,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"===typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,o)}))}o(c.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(e){if(e){var n=e[i];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:I}}function I(){return{value:t,done:!0}}return y.prototype=x.constructor=m,m.constructor=y,y.displayName=c(m,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},O(w.prototype),w.prototype[s]=function(){return this},e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var s=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},O(x),c(x,o,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=L,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return o.type="throw",o.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;j(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:L(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=r}catch(a){Function("r","regeneratorRuntime = r")(r)}},function(e,t){var n,r,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var e=o(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new v(e,t)),1!==u.length||l||o(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var r=n(5),a=n.n(r),i=n(6),s=n(1),o=n(2),c=n(8),u=n(7),l=n(3),h=n(4),f=n(9),p=n(10);function v(e){var t="function"===typeof Map?new Map:void 0;return(v=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Object(c.a)(e,arguments,Object(f.a)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object(p.a)(r,e)})(e)}var g;!function(e){e[e.Tag=0]="Tag"}(g||(g={}));var b,y=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(r=t.call.apply(t,[this,e].concat(i)))._tag=g.Tag,r}return Object(o.a)(n,null,[{key:"fromArray",value:function(e){if(!(e.length<1)){var t=e.shift();if(void 0!==t){var r=new n(t);return e.forEach((function(e){r.push(e)})),r}}}}]),n}(v(Array));!function(e){e[e.LT=-1]="LT",e[e.EQ=0]="EQ",e[e.GT=1]="GT"}(b||(b={}));var m,d=function(){function e(t,n){Object(s.a)(this,e),this.line=t,this.character=n}return Object(o.a)(e,[{key:"compareTo",value:function(e){return this.line<e.line||this.line===e.line&&this.character<e.character?b.LT:this.line>e.line||this.line===e.line&&this.character>e.character?b.GT:b.EQ}}],[{key:"from",value:function(t){return t instanceof e?t:new e(t.line,t.character)}}]),e}(),k=function(){function e(t,n){Object(s.a)(this,e),this.start=t,this.end=n}return Object(o.a)(e,null,[{key:"merge",value:function(t,n){var r=d.from(t.start).compareTo(n.start),a=d.from(t.end).compareTo(n.end);return new e(r===b.LT?t.start:r===b.GT?n.start:t.start,a===b.LT?n.end:a===b.GT?t.end:n.end)}}]),e}(),T=function(){function e(t,n){Object(s.a)(this,e),this.uri=t,this.range=n}return Object(o.a)(e,null,[{key:"merge",value:function(t,n){if(t.uri!==n.uri)throw Error("Source location URI missmatch.");return new e(t.uri,k.merge(t.range,n.range))}}]),e}();function x(e){switch(e){case m.Begin:return m.Begin;case m.Activity:return m.Activity;case m.Finally:return m.Finally;case m.End:return m.End;case m.Constant:return m.Constant;case m.Variable:return m.Variable;case m.In:return m.In;case m.Out:return m.Out;case m.Is:return m.Is;case m.Type:return m.Type;case m.Any:return m.Any;case m.Finish:return m.Finish;case m.Component:return m.Component;case m.Interface:return m.Interface;case m.Procedure:return m.Procedure;case m.Implementation:return m.Implementation;case m.Offers:return m.Offers;case m.Requires:return m.Requires;case m.OpenBrace:return m.OpenBrace;case m.CloseBrace:return m.CloseBrace;case m.OpenSquareBracket:return m.OpenSquareBracket;case m.CloseSquareBracket:return m.CloseSquareBracket;case m.OpenParentheses:return m.OpenParentheses;case m.CloseParentheses:return m.CloseParentheses;case m.Semicolon:return m.Semicolon;case m.Colon:return m.Colon;case m.Comma:return m.Comma;case m.Asterisk:return m.Asterisk;case m.Pipe:return m.Pipe;case m.For:return m.For;case m.To:return m.To;case m.By:return m.By;case m.Do:return m.Do;case m.Foreach:return m.Foreach;case m.Of:return m.Of;case m.While:return m.While;case m.Repeat:return m.Repeat;case m.Until:return m.Until;case m.If:return m.If;case m.Then:return m.Then;case m.Elsif:return m.Elsif;case m.Else:return m.Else;case m.Return:return m.Return;case m.NumberSign:return m.NumberSign;case m.Equal:return m.Equal;case m.Less:return m.Less;case m.LessEqual:return m.LessEqual;case m.Greater:return m.Greater;case m.GreaterEqual:return m.GreaterEqual;case m.ColonEqual:return m.ColonEqual;case m.Ellipsis:return m.Ellipsis;case m.Plus:return m.Plus;case m.Minus:return m.Minus;case m.Tilde:return m.Tilde;case m.Slash:return m.Slash;case m.Div:return m.Div;case m.Mod:return m.Mod;case m.And:return m.And;case m.Or:return m.Or;case m.ExclamationMark:return m.ExclamationMark;case m.QuestionMark:return m.QuestionMark;default:return}}!function(e){e.EOT="EOT",e.Begin="BEGIN",e.Activity="ACTIVITY",e.Finally="FINALLY",e.End="END",e.Constant="CONSTANT",e.Variable="VARIABLE",e.In="IN",e.Out="OUT",e.Is="IS",e.Type="TYPE",e.Any="ANY",e.Finish="FINISH",e.Component="COMPONENT",e.Interface="INTERFACE",e.Procedure="PROCEDURE",e.Implementation="IMPLEMENTATION",e.Offers="OFFERS",e.Requires="REQUIRES",e.OpenBrace="{",e.CloseBrace="}",e.OpenSquareBracket="[",e.CloseSquareBracket="]",e.OpenParentheses="(",e.CloseParentheses=")",e.Semicolon=";",e.Colon=":",e.Comma=",",e.Asterisk="*",e.Pipe="|",e.For="FOR",e.To="TO",e.By="BY",e.Do="DO",e.Foreach="FOREACH",e.Of="OF",e.While="WHILE",e.Repeat="REPEAT",e.Until="UNTIL",e.If="IF",e.Then="THEN",e.Elsif="ELSIF",e.Else="ELSE",e.Return="RETURN",e.NumberSign="#",e.Equal="=",e.Less="<",e.LessEqual="<=",e.Greater=">",e.GreaterEqual=">=",e.ColonEqual=":=",e.Ellipsis="..",e.Plus="+",e.Minus="-",e.Tilde="~",e.Slash="/",e.Div="DIV",e.Mod="MOD",e.And="AND",e.Or="OR",e.ExclamationMark="!",e.QuestionMark="?"}(m||(m={}));var O,w=function(){function e(t){Object(s.a)(this,e),this.location=t}return Object(o.a)(e,[{key:"getLocation",value:function(){return this.location}}]),e}();!function(e){e[e.Tag=0]="Tag"}(O||(O={}));var E,C=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._errorTag=O.Tag,r}return n}(w),j=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).tag=r,a}return Object(o.a)(n,[{key:"getTag",value:function(){return this.tag}}]),n}(w),S=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).identifier=r,a}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}}]),n}(w),L=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).value=r,a}return Object(o.a)(n,[{key:"getNumber",value:function(){return this.value}}]),n}(w);!function(e){e[e.Tag=0]="Tag"}(E||(E={}));var I,F=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=E.Tag,e}return n}(L);!function(e){e[e.Tag=0]="Tag"}(I||(I={}));var P,A=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=I.Tag,e}return n}(L);!function(e){e[e.Tag=0]="Tag"}(P||(P={}));var N,R,D,B,V,M,q,_,G,U,W,H,Q,X,z,Y,K,$,Z,J,ee=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r*Math.pow(10,a))).mantissa=r,i.exponent=a,i._tag=P.Tag,i}return Object(o.a)(n,[{key:"getMantissa",value:function(){return this.mantissa}},{key:"getExponent",value:function(){return this.exponent}}]),n}(L),te=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).text=r,a}return Object(o.a)(n,[{key:"getText",value:function(){return this.text}}]),n}(w);!function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return Fe.objectLiteral(t)&&Fe.number(t.line)&&Fe.number(t.character)}}(N||(N={})),function(e){e.create=function(e,t,n,r){if(Fe.number(e)&&Fe.number(t)&&Fe.number(n)&&Fe.number(r))return{start:N.create(e,t),end:N.create(n,r)};if(N.is(e)&&N.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+r+"]")},e.is=function(e){var t=e;return Fe.objectLiteral(t)&&N.is(t.start)&&N.is(t.end)}}(R||(R={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Fe.defined(t)&&R.is(t.range)&&(Fe.string(t.uri)||Fe.undefined(t.uri))}}(D||(D={})),function(e){e.create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},e.is=function(e){var t=e;return Fe.defined(t)&&R.is(t.targetRange)&&Fe.string(t.targetUri)&&(R.is(t.targetSelectionRange)||Fe.undefined(t.targetSelectionRange))&&(R.is(t.originSelectionRange)||Fe.undefined(t.originSelectionRange))}}(B||(B={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){var t=e;return Fe.number(t.red)&&Fe.number(t.green)&&Fe.number(t.blue)&&Fe.number(t.alpha)}}(V||(V={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return R.is(t.range)&&V.is(t.color)}}(M||(M={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return Fe.string(t.label)&&(Fe.undefined(t.textEdit)||z.is(t))&&(Fe.undefined(t.additionalTextEdits)||Fe.typedArray(t.additionalTextEdits,z.is))}}(q||(q={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(_||(_={})),function(e){e.create=function(e,t,n,r,a){var i={startLine:e,endLine:t};return Fe.defined(n)&&(i.startCharacter=n),Fe.defined(r)&&(i.endCharacter=r),Fe.defined(a)&&(i.kind=a),i},e.is=function(e){var t=e;return Fe.number(t.startLine)&&Fe.number(t.startLine)&&(Fe.undefined(t.startCharacter)||Fe.number(t.startCharacter))&&(Fe.undefined(t.endCharacter)||Fe.number(t.endCharacter))&&(Fe.undefined(t.kind)||Fe.string(t.kind))}}(G||(G={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Fe.defined(t)&&D.is(t.location)&&Fe.string(t.message)}}(U||(U={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(W||(W={})),function(e){e.Unnecessary=1,e.Deprecated=2}(H||(H={})),function(e){e.create=function(e,t,n,r,a,i){var s={range:e,message:t};return Fe.defined(n)&&(s.severity=n),Fe.defined(r)&&(s.code=r),Fe.defined(a)&&(s.source=a),Fe.defined(i)&&(s.relatedInformation=i),s},e.is=function(e){var t=e;return Fe.defined(t)&&R.is(t.range)&&Fe.string(t.message)&&(Fe.number(t.severity)||Fe.undefined(t.severity))&&(Fe.number(t.code)||Fe.string(t.code)||Fe.undefined(t.code))&&(Fe.string(t.source)||Fe.undefined(t.source))&&(Fe.undefined(t.relatedInformation)||Fe.typedArray(t.relatedInformation,U.is))}}(Q||(Q={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={title:e,command:t};return Fe.defined(n)&&n.length>0&&(a.arguments=n),a},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.string(t.title)&&Fe.string(t.command)}}(X||(X={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Fe.objectLiteral(t)&&Fe.string(t.newText)&&R.is(t.range)}}(z||(z={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Fe.defined(t)&&re.is(t.textDocument)&&Array.isArray(t.edits)}}(Y||(Y={})),function(e){e.create=function(e,t){var n={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"create"===t.kind&&Fe.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Fe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Fe.boolean(t.options.ignoreIfExists)))}}(K||(K={})),function(e){e.create=function(e,t,n){var r={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(r.options=n),r},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Fe.string(t.oldUri)&&Fe.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Fe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Fe.boolean(t.options.ignoreIfExists)))}}($||($={})),function(e){e.create=function(e,t){var n={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Fe.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Fe.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Fe.boolean(t.options.ignoreIfNotExists)))}}(Z||(Z={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Fe.string(e.kind)?K.is(e)||$.is(e)||Z.is(e):Y.is(e)})))}}(J||(J={}));var ne,re,ae,ie,se,oe,ce,ue,le,he,fe,pe,ve,ge,be,ye,me,de,ke,Te,xe,Oe,we,Ee,Ce,je,Se,Le=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(z.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(z.replace(e,t))},e.prototype.delete=function(e){this.edits.push(z.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}();!function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(Y.is(e)){var n=new Le(e.edits);t._textEditChanges[e.textDocument.uri]=n}})):e.changes&&Object.keys(e.changes).forEach((function(n){var r=new Le(e.changes[n]);t._textEditChanges[n]=r})))}Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(re.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(r=this._textEditChanges[t.uri])){var n={textDocument:t,edits:a=[]};this._workspaceEdit.documentChanges.push(n),r=new Le(a),this._textEditChanges[t.uri]=r}return r}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var r;if(!(r=this._textEditChanges[e])){var a=[];this._workspaceEdit.changes[e]=a,r=new Le(a),this._textEditChanges[e]=r}return r},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(K.create(e,t))},e.prototype.renameFile=function(e,t,n){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push($.create(e,t,n))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(Z.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")}}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.string(t.uri)}}(ne||(ne={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.string(t.uri)&&(null===t.version||Fe.number(t.version))}}(re||(re={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.string(t.uri)&&Fe.string(t.languageId)&&Fe.number(t.version)&&Fe.string(t.text)}}(ae||(ae={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(ie||(ie={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(ie||(ie={})),function(e){e.is=function(e){var t=e;return Fe.objectLiteral(e)&&ie.is(t.kind)&&Fe.string(t.value)}}(se||(se={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(oe||(oe={})),function(e){e.PlainText=1,e.Snippet=2}(ce||(ce={})),function(e){e.Deprecated=1}(ue||(ue={})),function(e){e.create=function(e){return{label:e}}}(le||(le={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(he||(he={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Fe.string(t)||Fe.objectLiteral(t)&&Fe.string(t.language)&&Fe.string(t.value)}}(fe||(fe={})),function(e){e.is=function(e){var t=e;return!!t&&Fe.objectLiteral(t)&&(se.is(t.contents)||fe.is(t.contents)||Fe.typedArray(t.contents,fe.is))&&(void 0===e.range||R.is(e.range))}}(pe||(pe={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(ve||(ve={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={label:e};return Fe.defined(t)&&(a.documentation=t),Fe.defined(n)?a.parameters=n:a.parameters=[],a}}(ge||(ge={})),function(e){e.Text=1,e.Read=2,e.Write=3}(be||(be={})),function(e){e.create=function(e,t){var n={range:e};return Fe.number(t)&&(n.kind=t),n}}(ye||(ye={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(me||(me={})),function(e){e.Deprecated=1}(de||(de={})),function(e){e.create=function(e,t,n,r,a){var i={name:e,kind:t,location:{uri:r,range:n}};return a&&(i.containerName=a),i}}(ke||(ke={})),function(e){e.create=function(e,t,n,r,a,i){var s={name:e,detail:t,kind:n,range:r,selectionRange:a};return void 0!==i&&(s.children=i),s},e.is=function(e){var t=e;return t&&Fe.string(t.name)&&Fe.number(t.kind)&&R.is(t.range)&&R.is(t.selectionRange)&&(void 0===t.detail||Fe.string(t.detail))&&(void 0===t.deprecated||Fe.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(Te||(Te={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(xe||(xe={})),function(e){e.create=function(e,t){var n={diagnostics:e};return void 0!==t&&null!==t&&(n.only=t),n},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.typedArray(t.diagnostics,Q.is)&&(void 0===t.only||Fe.typedArray(t.only,Fe.string))}}(Oe||(Oe={})),function(e){e.create=function(e,t,n){var r={title:e};return X.is(t)?r.command=t:r.edit=t,void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return t&&Fe.string(t.title)&&(void 0===t.diagnostics||Fe.typedArray(t.diagnostics,Q.is))&&(void 0===t.kind||Fe.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||X.is(t.command))&&(void 0===t.isPreferred||Fe.boolean(t.isPreferred))&&(void 0===t.edit||J.is(t.edit))}}(we||(we={})),function(e){e.create=function(e,t){var n={range:e};return Fe.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return Fe.defined(t)&&R.is(t.range)&&(Fe.undefined(t.command)||X.is(t.command))}}(Ee||(Ee={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Fe.defined(t)&&Fe.number(t.tabSize)&&Fe.boolean(t.insertSpaces)}}(Ce||(Ce={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return Fe.defined(t)&&R.is(t.range)&&(Fe.undefined(t.target)||Fe.string(t.target))}}(je||(je={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&R.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(Se||(Se={}));var Ie;!function(e){function t(e,n){if(e.length<=1)return e;var r=e.length/2|0,a=e.slice(0,r),i=e.slice(r);t(a,n),t(i,n);for(var s=0,o=0,c=0;s<a.length&&o<i.length;){var u=n(a[s],i[o]);e[c++]=u<=0?a[s++]:i[o++]}for(;s<a.length;)e[c++]=a[s++];for(;o<i.length;)e[c++]=i[o++];return e}e.create=function(e,t,n,r){return new Pe(e,t,n,r)},e.is=function(e){var t=e;return!!(Fe.defined(t)&&Fe.string(t.uri)&&(Fe.undefined(t.languageId)||Fe.string(t.languageId))&&Fe.number(t.lineCount)&&Fe.func(t.getText)&&Fe.func(t.positionAt)&&Fe.func(t.offsetAt))},e.applyEdits=function(e,n){for(var r=e.getText(),a=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),i=r.length,s=a.length-1;s>=0;s--){var o=a[s],c=e.offsetAt(o.range.start),u=e.offsetAt(o.range.end);if(!(u<=i))throw new Error("Overlapping edit");r=r.substring(0,c)+o.newText+r.substring(u,r.length),i=c}return r}}(Ie||(Ie={}));var Fe,Pe=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var a=t.charAt(r);n="\r"===a||"\n"===a,"\r"===a&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return N.create(0,e);for(;n<r;){var a=Math.floor((n+r)/2);t[a]>e?r=a:n=a+1}var i=n-1;return N.create(i,e-t[i])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return"undefined"!==typeof e},e.undefined=function(e){return"undefined"===typeof e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"===typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Fe||(Fe={}));var Ae,Ne=function e(t,n,r,a,i,o,c){Object(s.a)(this,e),this.range=t,this.severity=n,this.message=r,this.code=a,this.source=i,this.tags=o,this.relatedInformation=c},Re=function(){function e(){Object(s.a)(this,e),this.diagnostics=new Array,this.warning=!1,this.error=!1}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e;return t.diagnostics=Object(c.a)(Array,Object(u.a)(this.diagnostics)),t.warning=this.warning,t.error=this.error,t}}]),e}(),De=function(){function e(){Object(s.a)(this,e),this.state=new Re,this.stateStack=new Array}return Object(o.a)(e,[{key:"log",value:function(e){this.state.diagnostics.push(e),e.severity===W.Warning&&(this.state.warning=!0),e.severity===W.Error&&(this.state.error=!0)}},{key:"saveState",value:function(){this.stateStack.push(this.state.copy())}},{key:"restoreState",value:function(){var e=this.stateStack.pop();void 0!==e?this.state=e:console.warn("Failed to restore diagnosis state, no state saved.")}},{key:"hasErrors",value:function(){return this.state.error}},{key:"hasWarnings",value:function(){return this.state.warning}},{key:"getDiagnostics",value:function(){return this.state.diagnostics}},{key:"print",value:function(e){var t=this;this.state.diagnostics.forEach((function(n){e("[".concat(n.range.start.line,":").concat(n.range.start.character,"]: ").concat(t.toString(n.severity),": ").concat(n.message,"."))}))}},{key:"toString",value:function(e){switch(e){case W.Error:return"Error";case W.Warning:return"Warning";case W.Information:return"Information";case W.Hint:return"Hint";default:return"undefined"}}}]),e}();!function(e){e.Null="\0",e.Backspace="\b",e.Space=" ",e.HorizontalTab="\t",e.VerticalTab="\v",e.FormFeed="\f",e.CarriageReturn="\r",e.LineFeed="\n",e.Backslash="\\",e.SingleQuote="'",e.DoubleQuote='"'}(Ae||(Ae={}));var Be,Ve=function(){function e(){Object(s.a)(this,e),this.tokenCache=new Array,this.currentPosition=0,this.currentLinePosition=0,this.currentLine=0}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e;return t.tokenCache=Object(c.a)(Array,Object(u.a)(this.tokenCache)),t.currentPosition=this.currentPosition,t.currentLinePosition=this.currentLinePosition,t.currentLine=this.currentLine,t}}]),e}(),Me=function(){function e(t,n,r){Object(s.a)(this,e),this.diagnosis=t,this.uri=n,this.code=Array.from(r),this.state=new Ve,this.stateStack=new Array}return Object(o.a)(e,[{key:"advance",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e>0&&!this.isEOT();)this.isLineFeed()?(this.state.currentLine=this.state.currentLine+1,this.state.currentLinePosition=0):this.state.currentLinePosition=this.state.currentLinePosition+1,this.state.currentPosition=this.state.currentPosition+1,e-=1}},{key:"getCurrentCharacter",value:function(){return this.isEOT()?void 0:this.code[this.state.currentPosition]}},{key:"createSourceLocation",value:function(e){return new T(this.uri,e)}},{key:"createSourcePosition",value:function(){return new d(this.state.currentLine,this.state.currentLinePosition)}},{key:"createEOTToken",value:function(){var e=this.createSourcePosition();return new j(this.createSourceLocation(new k(e,e)),m.EOT)}},{key:"isSpace",value:function(){return this.getCurrentCharacter()===Ae.Space}},{key:"isTab",value:function(){var e=this.getCurrentCharacter();return e===Ae.HorizontalTab||e===Ae.VerticalTab}},{key:"isFormFeed",value:function(){return this.getCurrentCharacter()===Ae.FormFeed}},{key:"isLineFeed",value:function(){return this.getCurrentCharacter()===Ae.LineFeed}},{key:"isCarriageReturn",value:function(){return this.getCurrentCharacter()===Ae.CarriageReturn}},{key:"isBackslash",value:function(){return this.getCurrentCharacter()===Ae.Backslash}},{key:"isLetter",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&(e>="a"&&e<="z"||e>="A"&&e<="Z")}},{key:"isDot",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&"."===e}},{key:"isEllipsis",value:function(){return this.isDot()&&this.state.currentPosition+1<this.code.length&&"."===this.code[this.state.currentPosition+1]}},{key:"isNumber",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&e>="0"&&e<="9"}},{key:"isHexCharacter",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&(e>="a"&&e<="f"||e>="A"&&e<="F")}},{key:"isDoubleQuote",value:function(){return this.getCurrentCharacter()===Ae.DoubleQuote}},{key:"isWhitespace",value:function(){return this.isSpace()||this.isTab()||this.isLineFeed()||this.isCarriageReturn()||this.isFormFeed()}},{key:"isEOT",value:function(){return this.state.currentPosition>=this.code.length}},{key:"isCommentStart",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&x(e)===m.OpenParentheses&&this.state.currentPosition+1<this.code.length&&x(this.code[this.state.currentPosition+1])===m.Asterisk}},{key:"isCommentEnd",value:function(){var e=this.getCurrentCharacter();return void 0!==e&&x(e)===m.Asterisk&&this.state.currentPosition+1<this.code.length&&x(this.code[this.state.currentPosition+1])===m.CloseParentheses}},{key:"skipWhitespace",value:function(){for(var e=!1;this.isWhitespace();)e=!0,this.advance();return e}},{key:"skipComment",value:function(){var e=!1;if(this.isCommentStart()){for(e=!0,this.advance(2);!this.isEOT()&&!this.isCommentEnd();)this.advance();this.isEOT()||this.advance(2)}return e}},{key:"skipUntilWhitespace",value:function(){for(;!this.isWhitespace()&&!this.isEOT();)this.advance()}},{key:"readCharacter",value:function(){var e=this.getCurrentCharacter();if(this.isBackslash()){this.advance();var t=function(e){switch(e){case"0":return Ae.Null;case"b":return Ae.Backspace;case"t":return Ae.HorizontalTab;case"v":return Ae.VerticalTab;case"f":return Ae.FormFeed;case"r":return Ae.CarriageReturn;case"n":return Ae.LineFeed;case"\\":return Ae.Backslash;case"'":return Ae.SingleQuote;case'"':return Ae.DoubleQuote;default:return}}(this.getCurrentCharacter());if(void 0!==t)return this.advance(),t}return this.advance(),e}},{key:"readText",value:function(){var e="",t=this.createSourcePosition();for(this.advance();!this.isDoubleQuote();){var n=this.readCharacter();if(void 0===n)return new C(this.createSourceLocation(new k(t,this.createSourcePosition())));e+=n}if(this.isDoubleQuote()){this.advance();var r=this.createSourcePosition();return new te(this.createSourceLocation(new k(t,r)),e)}return new C(this.createSourceLocation(new k(t,this.createSourcePosition())))}},{key:"readIdentifier",value:function(){for(var e="",t=this.createSourcePosition();!this.isEOT()&&(this.isLetter()||this.isNumber());)e+=this.getCurrentCharacter(),this.advance();var n=this.createSourceLocation(new k(t,this.createSourcePosition())),r=x(e);return void 0!==r?new j(n,r):new S(n,e)}},{key:"readFixToken",value:function(){var e=this.createSourcePosition(),t=this.getCurrentCharacter();if(void 0!==t){var n=x(t);if(this.advance(),void 0!==n){var r=this.getCurrentCharacter();if(void 0!==r)if(x(r)===m.Equal)switch(n){case m.Less:return this.advance(),new j(this.createSourceLocation(new k(e,this.createSourcePosition())),m.LessEqual);case m.Greater:return this.advance(),new j(this.createSourceLocation(new k(e,this.createSourcePosition())),m.GreaterEqual);case m.Colon:return this.advance(),new j(this.createSourceLocation(new k(e,this.createSourcePosition())),m.ColonEqual)}return new j(this.createSourceLocation(new k(e,this.createSourcePosition())),n)}}return new C(this.createSourceLocation(new k(e,this.createSourcePosition())))}},{key:"readScaleFactor",value:function(){var e=0;for(this.isNumber()||this.diagnosis.log(new Ne(new k(this.createSourcePosition(),this.createSourcePosition()),W.Error,"Scale factor must be at least one digit long."));this.isNumber();){var t=this.getCurrentCharacter();void 0!==t&&(e=10*e+Number.parseInt(t),this.advance())}return e}},{key:"readNumber",value:function(){for(var e=this.createSourcePosition(),t=void 0,n=!1,r=!1,a=0;this.isNumber()||this.isHexCharacter();){if(this.isHexCharacter()&&(n=!0),t=void 0===t?this.getCurrentCharacter():t+this.getCurrentCharacter(),this.advance(),r&&n){this.skipUntilWhitespace(),this.diagnosis.log(new Ne(new k(e,this.createSourcePosition()),W.Error,"Floating point hex numbers are not supported."));break}if(r&&(a-=1),this.isEllipsis())break;if(this.isDot()&&(this.advance(),r=!0),r&&"E"===this.getCurrentCharacter()){this.advance();var i=this.getCurrentCharacter(),s=1;"-"!==i&&"+"!==i||(s="-"===i?-1:1,this.advance()),a=s*this.readScaleFactor();break}}if(void 0===t)return new A(this.createSourceLocation(new k(e,this.createSourcePosition())),0);var o="H"===this.getCurrentCharacter()||"X"===this.getCurrentCharacter();return o&&this.advance(),n&&!o&&(this.skipUntilWhitespace(),this.diagnosis.log(new Ne(new k(e,this.createSourcePosition()),W.Error,'Missing "H" or "X" after hex number'))),n||o?new F(this.createSourceLocation(new k(e,this.createSourcePosition())),Number.parseInt("0x"+t)):r?new ee(this.createSourceLocation(new k(e,this.createSourcePosition())),Number.parseInt(t),a):new A(this.createSourceLocation(new k(e,this.createSourcePosition())),Number.parseInt(t))}},{key:"readEllipsis",value:function(){var e=this.createSourcePosition();return this.advance(),this.advance(),new j(this.createSourceLocation(new k(e,this.createSourcePosition())),m.Ellipsis)}},{key:"read",value:function(){for(;!this.isEOT()&&(this.skipWhitespace()||this.skipComment()););return this.isEOT()?this.createEOTToken():this.isDoubleQuote()?this.readText():this.isLetter()?this.readIdentifier():this.isNumber()?this.readNumber():this.isEllipsis()?this.readEllipsis():this.readFixToken()}},{key:"getUri",value:function(){return this.uri}},{key:"saveState",value:function(){this.stateStack.push(this.state.copy())}},{key:"popSaveState",value:function(){this.stateStack.pop()}},{key:"restoreState",value:function(){var e=this.stateStack.pop();void 0!==e?this.state=e:console.warn("No lexer state to restore.")}},{key:"peek",value:function(e){if(e<1)throw RangeError("peek range must be greater than 0.");var t=this.state.tokenCache.length;if(e<=t)return this.state.tokenCache[e-1];do{if(t>0){var n=this.state.tokenCache[t-1];if(n instanceof j&&n.getTag()===m.EOT)return n}t=this.state.tokenCache.push(this.read())}while(e>t);return this.state.tokenCache[e-1]}},{key:"next",value:function(){var e=this.peek(1);return this.state.tokenCache.shift(),e}}]),e}(),qe=function(){function e(t){Object(s.a)(this,e),this.location=t}return Object(o.a)(e,[{key:"getLocation",value:function(){return this.location}}]),e}(),_e=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitAttribute(this)}}]),n}(qe),Ge=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).min=r,i.max=a,i}return Object(o.a)(n,[{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"accept",value:function(e){e.visitCardinality(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(Be||(Be={}));var Ue,We=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Be.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitDeclaration(this)}}]),n}(qe),He=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o){var c;return Object(s.a)(this,n),(c=t.call(this,e)).name=r,c.offers=a,c.requires=i,c.body=o,c}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getOffers",value:function(){return this.offers}},{key:"getRequires",value:function(){return this.requires}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitComponent(this)}}]),n}(We),Qe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).declarations=r,u.implementations=a,u.beginBlock=i,u.activityBlock=o,u.finallyBlock=c,u}return Object(o.a)(n,[{key:"getDeclarations",value:function(){return this.declarations}},{key:"getImplementations",value:function(){return this.implementations}},{key:"getBeginBlock",value:function(){return this.beginBlock}},{key:"getActivityBlock",value:function(){return this.activityBlock}},{key:"getFinallyBlock",value:function(){return this.finallyBlock}},{key:"accept",value:function(e){e.visitComponentBody(this)}}]),n}(qe),Xe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.expression=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitConstant(this)}}]),n}(qe),ze=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitConstantExpression(this)}}]),n}(qe),Ye=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).constants=r,a}return Object(o.a)(n,[{key:"getConstants",value:function(){return this.constants}},{key:"accept",value:function(e){e.visitConstantList(this)}}]),n}(We);!function(e){e[e.Tag=0]="Tag"}(Ue||(Ue={}));var Ke,$e=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._expressionTag=Ue.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitExpression(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(Ke||(Ke={}));var Ze,Je=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).attributes=r,a._attributedExpressionTag=Ke.Tag,a}return Object(o.a)(n,[{key:"getAttributes",value:function(){return this.attributes}},{key:"accept",value:function(e){e.visitAttributedExpression(this)}}]),n}($e),et=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r)).expression=a,i}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitUnaryExpression(this)}}]),n}(Je);!function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.Less=2]="Less",e[e.LessEqual=3]="LessEqual",e[e.More=4]="More",e[e.MoreEqual=5]="MoreEqual"}(Ze||(Ze={}));var tt,nt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o){var c;return Object(s.a)(this,n),(c=t.call(this,e,r)).left=a,c.op=i,c.right=o,c}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitBinaryExpression(this)}}]),n}(Je);!function(e){e[e.Offers=0]="Offers",e[e.Requires=1]="Requires"}(tt||(tt={}));var rt,at=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r)).op=a,o.interfaces=i,o}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getInterfaces",value:function(){return this.interfaces}},{key:"accept",value:function(e){e.visitOffersRequiresExpression(this)}}]),n}(Je),it=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r)).designator=a,o.type=i,o}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitTypeCheck(this)}}]),n}(Je);!function(e){e[e.Tag=0]="Tag"}(rt||(rt={}));var st,ot=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._simpleExpressionTag=rt.Tag,r}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitSimpleExpression(this)}}]),n}($e);!function(e){e[e.Plus=0]="Plus",e[e.Minus=1]="Minus"}(st||(st={}));var ct,ut=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).op=r,i.term=a,i}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getTerm",value:function(){return this.term}},{key:"accept",value:function(e){e.visitUnaryTermNode(this)}}]),n}(ot);!function(e){e[e.Plus=0]="Plus",e[e.Minus=1]="Minus",e[e.Or=2]="Or"}(ct||(ct={}));var lt,ht=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).left=r,i.right=a,i}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitTermChain(this)}}]),n}(ot),ft=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).op=r,i.right=a,i}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitRightTerm(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(lt||(lt={}));var pt,vt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._termTag=lt.Tag,r}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitTerm(this)}}]),n}(ot),gt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).left=r,i.right=a,i}return Object(o.a)(n,[{key:"getLeft",value:function(){return this.left}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitFactorChain(this)}}]),n}(vt);!function(e){e[e.Times=0]="Times",e[e.Div=1]="Div",e[e.DivText=2]="DivText",e[e.ModText=3]="ModText",e[e.AndText=4]="AndText"}(pt||(pt={}));var bt,yt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).op=r,i.right=a,i}return Object(o.a)(n,[{key:"getOp",value:function(){return this.op}},{key:"getRight",value:function(){return this.right}},{key:"accept",value:function(e){e.visitRightFactor(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(bt||(bt={}));var mt,dt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._factorTag=bt.Tag,r}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitFactor(this)}}]),n}(vt);!function(e){e[e.Not=0]="Not"}(mt||(mt={}));var kt,Tt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).prefix=r,i.factor=a,i}return Object(o.a)(n,[{key:"getPrefix",value:function(){return this.prefix}},{key:"getFactor",value:function(){return this.factor}},{key:"accept",value:function(e){e.visitUnaryFactor(this)}}]),n}(dt),xt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expresion=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expresion}},{key:"accept",value:function(e){e.visitExpressionFactor(this)}}]),n}(dt),Ot=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOperand(this)}}]),n}(dt),wt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).value=r,a}return Object(o.a)(n,[{key:"getValue",value:function(){return this.value}},{key:"accept",value:function(e){e.visitNumber(this)}}]),n}(Ot);!function(e){e[e.Tag=0]="Tag"}(kt||(kt={}));var Et,Ct=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._integerNumberTag=kt.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitIntegerNumber(this)}}]),n}(wt);!function(e){e[e.Tag=0]="Tag"}(Et||(Et={}));var jt,St=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._realNumberTag=Et.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRealNumber(this)}}]),n}(wt),Lt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).character=r,a}return Object(o.a)(n,[{key:"getCharacter",value:function(){return this.character}},{key:"accept",value:function(e){e.visitConstantCharacter(this)}}]),n}(Ot),It=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).text=r,a}return Object(o.a)(n,[{key:"getText",value:function(){return this.text}},{key:"accept",value:function(e){e.visitText(this)}}]),n}(Ot);!function(e){e[e.Any=0]="Any",e[e.Finish=1]="Finish"}(jt||(jt={}));var Ft,Pt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).designator=r,i.pattern=a,i}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getPattern",value:function(){return this.pattern}}]),n}(Ot);!function(e){e[e.Tag=0]="Tag"}(Ft||(Ft={}));var At,Nt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Ft.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitReceiveTest(this)}}]),n}(Pt);!function(e){e[e.Tag=0]="Tag"}(At||(At={}));var Rt,Dt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=At.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitInputTest(this)}}]),n}(Pt),Bt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).designator=r,a}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"accept",value:function(e){e.visitExistsTest(this)}}]),n}(Ot),Vt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.args=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getArguments",value:function(){return this.args}},{key:"accept",value:function(e){e.visitFunctionCall(this)}}]),n}(Ot);!function(e){e[e.Tag=0]="Tag"}(Rt||(Rt={}));var Mt,qt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Rt.Tag,e}return n}(Ot),_t=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitBasicDesignator(this)}}]),n}(qt),Gt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.expressions=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getExpressions",value:function(){return this.expressions}},{key:"accept",value:function(e){e.visitBasicExpressionDesignator(this)}}]),n}(qt),Ut=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).base=r,i.target=a,i}return Object(o.a)(n,[{key:"getBase",value:function(){return this.base}},{key:"getTarget",value:function(){return this.target}},{key:"accept",value:function(e){e.visitBaseTargetDesignator(this)}}]),n}(qt),Wt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).designator=r,i.type=a,i}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitDesignatorType(this)}}]),n}(qt),Ht=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).name=r,o.declarations=a,o.statements=i,o}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getDeclarations",value:function(){return this.declarations}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitImplementation(this)}}]),n}(qe),Qt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.protocol=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getProtocol",value:function(){return this.protocol}},{key:"accept",value:function(e){e.visitInterface(this)}}]),n}(We),Xt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitProtocol(this)}}]),n}(qe),zt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).terms=r,a}return Object(o.a)(n,[{key:"getTerms",value:function(){return this.terms}},{key:"accept",value:function(e){e.visitProtocolExpression(this)}}]),n}(qe),Yt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).factors=r,a}return Object(o.a)(n,[{key:"getFactors",value:function(){return this.factors}},{key:"accept",value:function(e){e.visitProtocolTerm(this)}}]),n}(qe),Kt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.cardinality=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getCardinality",value:function(){return this.cardinality}},{key:"accept",value:function(e){e.visitInterfaceDeclaration(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(Mt||(Mt={}));var $t,Zt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=Mt.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOfferedInterface(this)}}]),n}(Kt);!function(e){e[e.Tag=0]="Tag"}($t||($t={}));var Jt,en=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=$t.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRequiredInterfface(this)}}]),n}(Kt),tn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=r,a}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"accept",value:function(e){e.visitName(this)}}]),n}(qe),nn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.params=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitIndexedName(this)}}]),n}(qe),rn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).names=r,i.type=a,i}return Object(o.a)(n,[{key:"getNames",value:function(){return this.names}},{key:"getType",value:function(){return this.type}},{key:"accept",value:function(e){e.visitParameter(this)}}]),n}(qe),an=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).name=r,u.params=a,u.type=i,u.declarations=o,u.statements=c,u}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"getType",value:function(){return this.type}},{key:"getDeclarations",value:function(){return this.declarations}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitProcedure(this)}}]),n}(We),sn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).mutable=r,i.parameter=a,i}return Object(o.a)(n,[{key:"isMutable",value:function(){return this.mutable}},{key:"getParameter",value:function(){return this.parameter}},{key:"accept",value:function(e){e.visitProcedureParameter(this)}}]),n}(qe),on=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).components=r,i.interfaces=a,i}return Object(o.a)(n,[{key:"getComponents",value:function(){return this.components}},{key:"getInterfaces",value:function(){return this.interfaces}},{key:"accept",value:function(e){e.visitProgram(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(Jt||(Jt={}));var cn,un=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._protocolFactorTag=Jt.Tag,r}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitProtocolFactor(this)}}]),n}(qe);!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(cn||(cn={}));var ln,hn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).direction=r,o.name=a,o.params=i,o}return Object(o.a)(n,[{key:"getDirection",value:function(){return this.direction}},{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitMessageDeclaration(this)}}]),n}(un);!function(e){e[e.Tag=0]="Tag"}(ln||(ln={}));var fn,pn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=r,a._protocolFactorExpressionTag=ln.Tag,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitProtocolFactorExpression(this)}}]),n}(un);!function(e){e[e.Tag=0]="Tag"}(fn||(fn={}));var vn,gn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=fn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitOptionalProtocolFactorExpression(this)}}]),n}(pn);!function(e){e[e.Tag=0]="Tag"}(vn||(vn={}));var bn,yn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=vn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitRepeatingProtocolFactorExpression(this)}}]),n}(pn);!function(e){e[e.Tag=0]="Tag"}(bn||(bn={}));var mn,dn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=bn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitGroupProtocolFactorExpression(this)}}]),n}(pn);!function(e){e[e.Tag=0]="Tag"}(mn||(mn={}));var kn,Tn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._statementTag=mn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitStatement(this)}}]),n}(qe),xn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).name=r,i.params=a,i}return Object(o.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getParams",value:function(){return this.params}},{key:"accept",value:function(e){e.visitProcedureCall(this)}}]),n}(Tn),On=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).designator=r,i.expression=a,i}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitAssignment(this)}}]),n}(Tn),wn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).designator=r,i.args=a,i}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getArgs",value:function(){return this.args}},{key:"accept",value:function(e){e.visitNew(this)}}]),n}(Tn),En=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).what=r,i.to=a,i}return Object(o.a)(n,[{key:"getWhat",value:function(){return this.what}},{key:"getTo",value:function(){return this.to}},{key:"accept",value:function(e){e.visitConnect(this)}}]),n}(Tn),Cn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).what=r,a}return Object(o.a)(n,[{key:"getWhat",value:function(){return this.what}},{key:"accept",value:function(e){e.visitDisconnect(this)}}]),n}(Tn),jn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).from=r,o.target=a,o.args=i,o}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getTarget",value:function(){return this.target}},{key:"getArgs",value:function(){return this.args}},{key:"accept",value:function(e){e.visitSend(this)}}]),n}(Tn),Sn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).from=r,o.receiver=a,o.targets=i,o}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getReceiver",value:function(){return this.receiver}},{key:"getTargets",value:function(){return this.targets}},{key:"accept",value:function(e){e.visitReceive(this)}}]),n}(Tn),Ln=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).target=r,a}return Object(o.a)(n,[{key:"getTarget",value:function(){return this.target}},{key:"accept",value:function(e){e.visitDelete(this)}}]),n}(Tn),In=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).from=r,i.to=a,i}return Object(o.a)(n,[{key:"getFrom",value:function(){return this.from}},{key:"getTo",value:function(){return this.to}},{key:"accept",value:function(e){e.visitMove(this)}}]),n}(Tn),Fn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitAwait(this)}}]),n}(Tn),Pn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).expression=r,a}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitReturn(this)}}]),n}(Tn),An=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o){var c;return Object(s.a)(this,n),(c=t.call(this,e)).expression=r,c.then=a,c.elseIfs=i,c.elseNode=o,c}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"getThen",value:function(){return this.then}},{key:"getElseIfs",value:function(){return this.elseIfs}},{key:"getElse",value:function(){return this.elseNode}},{key:"accept",value:function(e){e.visitIf(this)}}]),n}(Tn),Nn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).expression=r,i.then=a,i}return Object(o.a)(n,[{key:"getExpression",value:function(){return this.expression}},{key:"getThen",value:function(){return this.then}},{key:"accept",value:function(e){e.visitElseIf(this)}}]),n}(Tn),Rn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).expression=r,i.body=a,i}return Object(o.a)(n,[{key:"getExpresssion",value:function(){return this.expression}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitWhile(this)}}]),n}(Tn),Dn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).body=r,i.expression=a,i}return Object(o.a)(n,[{key:"getBody",value:function(){return this.body}},{key:"getExpresssion",value:function(){return this.expression}},{key:"accept",value:function(e){e.visitRepeat(this)}}]),n}(Tn),Bn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,o,c){var u;return Object(s.a)(this,n),(u=t.call(this,e)).designator=r,u.expression=a,u.to=i,u.by=o,u.statements=c,u}return Object(o.a)(n,[{key:"getDesignator",value:function(){return this.designator}},{key:"getExpression",value:function(){return this.expression}},{key:"getTo",value:function(){return this.to}},{key:"getBy",value:function(){return this.by}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitFor(this)}}]),n}(Tn),Vn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).designators=r,o.of=a,o.body=i,o}return Object(o.a)(n,[{key:"getDesignators",value:function(){return this.designators}},{key:"getOf",value:function(){return this.of}},{key:"getBody",value:function(){return this.body}},{key:"accept",value:function(e){e.visitForeach(this)}}]),n}(Tn),Mn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).statements=r,a}return Object(o.a)(n,[{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitStatementBlock(this)}}]),n}(Tn),qn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).attributes=r,i.statements=a,i}return Object(o.a)(n,[{key:"getAttributes",value:function(){return this.attributes}},{key:"getStatements",value:function(){return this.statements}},{key:"accept",value:function(e){e.visitStatementSequence(this)}}]),n}(qe);!function(e){e[e.Tag=0]="Tag"}(kn||(kn={}));var _n,Gn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._tag=kn.Tag,e}return Object(o.a)(n,[{key:"accept",value:function(e){e.visitType(this)}}]),n}(qe),Un=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).identifier=r,a}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}},{key:"accept",value:function(e){e.visitBasicType(this)}}]),n}(Gn),Wn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).offered=r,i.required=a,i}return Object(o.a)(n,[{key:"getOffered",value:function(){return this.offered}},{key:"getRequired",value:function(){return this.required}},{key:"accept",value:function(e){e.visitAnyType(this)}}]),n}(Gn),Hn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e)).names=r,o.type=a,o.attributes=i,o}return Object(o.a)(n,[{key:"getNames",value:function(){return this.names}},{key:"getType",value:function(){return this.type}},{key:"getAttributes",value:function(){return this.attributes}},{key:"accept",value:function(e){e.visitVariable(this)}}]),n}(qe),Qn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).variables=r,a}return Object(o.a)(n,[{key:"getVariables",value:function(){return this.variables}},{key:"accept",value:function(e){e.visitVariableList(this)}}]),n}(We),Xn=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"visitProtocolFactor",value:function(e){e instanceof hn?this.visitMessageDeclaration(e):e instanceof pn&&this.visitProtocolFactorExpression(e)}},{key:"visitMessageDeclaration",value:function(e){}},{key:"visitProtocolFactorExpression",value:function(e){e instanceof gn?this.visitOptionalProtocolFactorExpression(e):e instanceof yn?this.visitRepeatingProtocolFactorExpression(e):e instanceof dn&&this.visitGroupProtocolFactorExpression(e)}},{key:"visitOptionalProtocolFactorExpression",value:function(e){}},{key:"visitGroupProtocolFactorExpression",value:function(e){}},{key:"visitRepeatingProtocolFactorExpression",value:function(e){}},{key:"visitType",value:function(e){e instanceof Un?this.visitBasicType(e):e instanceof Wn&&this.visitAnyType(e)}},{key:"visitBasicType",value:function(e){}},{key:"visitAnyType",value:function(e){}},{key:"visitDesignator",value:function(e){e instanceof _t?this.visitBasicDesignator(e):e instanceof Gt?this.visitBasicExpressionDesignator(e):e instanceof Ut?this.visitBaseTargetDesignator(e):e instanceof Wt&&this.visitDesignatorType(e)}},{key:"visitBasicDesignator",value:function(e){}},{key:"visitBasicExpressionDesignator",value:function(e){}},{key:"visitBaseTargetDesignator",value:function(e){}},{key:"visitDesignatorType",value:function(e){}},{key:"visitInterfaceDeclaration",value:function(e){e instanceof Zt?this.visitOfferedInterface(e):e instanceof en&&this.visitRequiredInterfface(e)}},{key:"visitOfferedInterface",value:function(e){}},{key:"visitRequiredInterfface",value:function(e){}},{key:"visitName",value:function(e){}},{key:"visitIndexedName",value:function(e){}},{key:"visitCardinality",value:function(e){}},{key:"visitProgram",value:function(e){}},{key:"visitDeclaration",value:function(e){e instanceof He?this.visitComponent(e):e instanceof Qt?this.visitInterface(e):e instanceof Ye?this.visitConstantList(e):e instanceof Qn?this.visitVariableList(e):e instanceof an&&this.visitProcedure(e)}},{key:"visitComponent",value:function(e){}},{key:"visitInterface",value:function(e){}},{key:"visitConstantList",value:function(e){}},{key:"visitVariableList",value:function(e){}},{key:"visitProcedure",value:function(e){}},{key:"visitProcedureParameter",value:function(e){}},{key:"visitComponentBody",value:function(e){}},{key:"visitImplementation",value:function(e){}},{key:"visitProtocol",value:function(e){}},{key:"visitProtocolExpression",value:function(e){}},{key:"visitProtocolTerm",value:function(e){}},{key:"visitAttribute",value:function(e){}},{key:"visitStatementSequence",value:function(e){}},{key:"visitParameter",value:function(e){}},{key:"visitConstant",value:function(e){}},{key:"visitConstantExpression",value:function(e){}},{key:"visitVariable",value:function(e){}},{key:"visitStatement",value:function(e){e instanceof xn?this.visitProcedureCall(e):e instanceof On?this.visitAssignment(e):e instanceof wn?this.visitNew(e):e instanceof En?this.visitConnect(e):e instanceof Cn?this.visitDisconnect(e):e instanceof jn?this.visitSend(e):e instanceof Sn?this.visitReceive(e):e instanceof Ln?this.visitDelete(e):e instanceof In?this.visitMove(e):e instanceof Fn?this.visitAwait(e):e instanceof Pn?this.visitReturn(e):e instanceof An?this.visitIf(e):e instanceof Nn?this.visitElseIf(e):e instanceof Rn?this.visitWhile(e):e instanceof Dn?this.visitRepeat(e):e instanceof Bn?this.visitFor(e):e instanceof Vn?this.visitForeach(e):e instanceof Mn&&this.visitStatementBlock(e)}},{key:"visitProcedureCall",value:function(e){}},{key:"visitAssignment",value:function(e){}},{key:"visitNew",value:function(e){}},{key:"visitConnect",value:function(e){}},{key:"visitDisconnect",value:function(e){}},{key:"visitSend",value:function(e){}},{key:"visitReceive",value:function(e){}},{key:"visitDelete",value:function(e){}},{key:"visitMove",value:function(e){}},{key:"visitAwait",value:function(e){}},{key:"visitReturn",value:function(e){}},{key:"visitIf",value:function(e){}},{key:"visitElseIf",value:function(e){}},{key:"visitWhile",value:function(e){}},{key:"visitRepeat",value:function(e){}},{key:"visitFor",value:function(e){}},{key:"visitForeach",value:function(e){}},{key:"visitStatementBlock",value:function(e){}},{key:"visitExpression",value:function(e){e instanceof ot?this.visitSimpleExpression(e):e instanceof Je&&this.visitAttributedExpression(e)}},{key:"visitAttributedExpression",value:function(e){e instanceof ot?this.visitSimpleExpression(e):e instanceof et?this.visitUnaryExpression(e):e instanceof nt?this.visitBinaryExpression(e):e instanceof at?this.visitOffersRequiresExpression(e):e instanceof it&&this.visitTypeCheck(e)}},{key:"visitUnaryExpression",value:function(e){}},{key:"visitBinaryExpression",value:function(e){}},{key:"visitOffersRequiresExpression",value:function(e){}},{key:"visitTypeCheck",value:function(e){}},{key:"visitSimpleExpression",value:function(e){e instanceof ut?this.visitUnaryTermNode(e):e instanceof ht?this.visitTermChain(e):e instanceof vt&&this.visitTerm(e)}},{key:"visitUnaryTermNode",value:function(e){}},{key:"visitTermChain",value:function(e){}},{key:"visitRightTerm",value:function(e){}},{key:"visitTerm",value:function(e){e instanceof dt?this.visitFactor(e):e instanceof gt?this.visitFactorChain(e):e instanceof yt&&this.visitRightFactor(e)}},{key:"visitFactorChain",value:function(e){}},{key:"visitRightFactor",value:function(e){}},{key:"visitFactor",value:function(e){e instanceof Tt?this.visitUnaryFactor(e):e instanceof Lt?this.visitConstantCharacter(e):e instanceof Ot&&this.visitOperand(e)}},{key:"visitUnaryFactor",value:function(e){}},{key:"visitExpressionFactor",value:function(e){}},{key:"visitOperand",value:function(e){e instanceof wt?this.visitNumber(e):e instanceof Lt?this.visitConstantCharacter(e):e instanceof It?this.visitText(e):e instanceof Nt?this.visitReceiveTest(e):e instanceof Dt?this.visitInputTest(e):e instanceof Bt?this.visitExistsTest(e):e instanceof Vt?this.visitFunctionCall(e):e instanceof qt&&this.visitDesignator(e)}},{key:"visitNumber",value:function(e){e instanceof Ct?this.visitIntegerNumber(e):e instanceof St&&this.visitRealNumber(e)}},{key:"visitIntegerNumber",value:function(e){}},{key:"visitRealNumber",value:function(e){}},{key:"visitConstantCharacter",value:function(e){}},{key:"visitText",value:function(e){}},{key:"visitReceiveTest",value:function(e){}},{key:"visitInputTest",value:function(e){}},{key:"visitExistsTest",value:function(e){}},{key:"visitFunctionCall",value:function(e){}}]),e}();!function(e){e.New="NEW",e.Conncet="CONNECT",e.Disconnect="DISCONNECT",e.Delete="DELETE",e.Move="MOVE",e.Await="AWAIT",e.Input="INPUT",e.Exists="EXISTS"}(_n||(_n={}));var zn,Yn=function(){function e(t,n){Object(s.a)(this,e),this.diagnosis=t,this.lexer=n}return Object(o.a)(e,[{key:"hasTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.lexer.peek(t);return this.isTaggedFixToken(n,e)}},{key:"isTaggedFixToken",value:function(e,t){return e instanceof j&&e.getTag()===t}},{key:"hasIdentifier",value:function(e){var t=this.lexer.peek(1);return t instanceof S&&t.getIdentifier()===e}},{key:"isComponent",value:function(){return this.hasTag(m.Component)}},{key:"isInterface",value:function(){return this.hasTag(m.Interface)}},{key:"isEOT",value:function(){return this.hasTag(m.EOT)}},{key:"error",value:function(e){var t=this.lexer.peek(1).getLocation().range;throw this.diagnosis.log(new Ne(t,W.Error,e)),new Error("[".concat(t.start.line,",").concat(t.start.character,":").concat(t.end.line,",").concat(t.end.character,"]: ").concat(e))}},{key:"loop",value:function(e,t){for(;e()&&!this.isEOT();)t()}},{key:"expectConsumeFixToken",value:function(e){if(!this.tryConsumeFixToken(e)){var t="Expected FixToken with Tag ".concat(e);this.error(t)}}},{key:"tryConsumeFixToken",value:function(e){return!!this.hasTag(e)&&(this.lexer.next(),!0)}},{key:"expectConsumeIdentifierToken",value:function(e){if(!this.tryConsumeIdentifierToken(e)){var t="Expected IdentifierToken with Identifier ".concat(e);this.error(t)}}},{key:"tryParse",value:function(e){try{this.diagnosis.saveState(),this.lexer.saveState();var t=e();return this.lexer.popSaveState(),t}catch(n){return this.diagnosis.restoreState(),void this.lexer.restoreState()}}},{key:"tryConsumeIdentifierToken",value:function(e){return!!this.hasIdentifier(e)&&(this.lexer.next(),!0)}},{key:"parseName",value:function(){var e=this.lexer.peek(1);if(e instanceof S)return this.lexer.next(),new tn(e.getLocation(),e.getIdentifier());return this.error("Failed to parse identifier name")}},{key:"parseIndexedName",value:function(){var e=this.lexer.peek(1);if(!(e instanceof S))return this.error("Failed to parse indexed name.");if(this.lexer.next(),this.tryConsumeFixToken(m.OpenSquareBracket)){var t=this.parseParameterList(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseSquareBracket),new nn(T.merge(e.getLocation(),n),e.getIdentifier(),t)}return new nn(e.getLocation(),e.getIdentifier(),new Array)}},{key:"parseCardinality",value:function(){if(this.hasTag(m.OpenSquareBracket)){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.OpenSquareBracket);var t=this.lexer.next();if(!(t instanceof A))return this.error("Expected number token.");var n=t.getNumber(),r=n;this.tryConsumeFixToken(m.Ellipsis)&&((t=this.lexer.peek(1))instanceof A?(this.lexer.next(),r=t.getNumber()):this.hasTag(m.Asterisk)?(this.lexer.next(),r=1/0):this.error('Expected number or "*".'));var a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseSquareBracket),new Ge(T.merge(e,a),n,r)}}},{key:"parseInterfaceDeclaration",value:function(e){var t=this.parseName(),n=this.parseCardinality();return new e(void 0===n?t.getLocation():T.merge(t.getLocation(),n.getLocation()),t,n)}},{key:"parseOfferedInterfaceDeclaration",value:function(){return this.parseInterfaceDeclaration(Zt)}},{key:"parseRequiredInterfaceDeclaration",value:function(){return this.parseInterfaceDeclaration(en)}},{key:"parseOffers",value:function(){var e=new Array;return this.tryConsumeFixToken(m.Offers)&&e.push.apply(e,Object(u.a)(this.parseOfferedInterfaceDeclarationList())),e}},{key:"parseRequires",value:function(){var e=new Array;return this.tryConsumeFixToken(m.Requires)&&e.push.apply(e,Object(u.a)(this.parseRequiredInterfaceDeclarationList())),e}},{key:"parseFunctionCall",value:function(){var e=this.parseName();this.expectConsumeFixToken(m.OpenParentheses);var t=new Array;this.hasTag(m.CloseParentheses)||t.push.apply(t,Object(u.a)(this.parseExpressionList()));var n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Vt(T.merge(e.getLocation(),n),e,t)}},{key:"parseMessagePattern",value:function(){return this.tryConsumeFixToken(m.Any)?jt.Any:this.tryConsumeFixToken(m.Finish)?jt.Finish:this.parseName()}},{key:"tryParseExpression",value:function(){return this.tryParse(this.parseExpression.bind(this))}},{key:"parseReceiveTestExpression",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.QuestionMark);var r=this.lexer.peek(1).getLocation(),a=this.parseMessagePattern();return new Nt(T.merge(n,r),e,a)}},{key:"parseInputTestExpression",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Input),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator();if(!this.hasTag(m.Comma)){if(t instanceof _t){var n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Dt(T.merge(e,n),void 0,t.getName())}this.error("Failed parsing input test node.")}this.expectConsumeFixToken(m.Comma);var r=this.parseMessagePattern(),a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Dt(T.merge(e,a),t,r)}},{key:"parseExistsExpression",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Exists),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Bt(T.merge(e,n),t)}},{key:"parseOperand",value:function(){var e=this.lexer.peek(1);if(e instanceof te){this.lexer.next();var t=e.getText();return 1===t.length?new Lt(e.getLocation(),t):new It(e.getLocation(),t)}if(e instanceof A)return this.lexer.next(),new Ct(e.getLocation(),e.getNumber());if(e instanceof F)return this.lexer.next(),new Ct(e.getLocation(),e.getNumber());if(e instanceof ee)return this.lexer.next(),new St(e.getLocation(),e.getNumber());if(this.hasIdentifier(_n.Input))return this.parseInputTestExpression();if(this.hasIdentifier(_n.Exists))return this.parseExistsExpression();var n=this.tryParseDesignator();return this.hasTag(m.QuestionMark)?this.parseReceiveTestExpression(n):void 0===n?this.parseFunctionCall():n}},{key:"parseFactor",value:function(){var e=this.lexer.peek(1).getLocation();if(this.tryConsumeFixToken(m.Tilde)){var t=this.parseFactor();return new Tt(T.merge(e,t.getLocation()),mt.Not,t)}if(this.tryConsumeFixToken(m.OpenParentheses)){var n=this.parseExpression(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new xt(T.merge(e,r),n)}return this.parseOperand()}},{key:"isFactorInfix",value:function(){return this.hasTag(m.Asterisk)||this.hasTag(m.Slash)||this.hasTag(m.Div)||this.hasTag(m.Mod)||this.hasTag(m.And)}},{key:"parseFactorInfix",value:function(){return this.tryConsumeFixToken(m.Asterisk)?pt.Times:this.tryConsumeFixToken(m.Slash)?pt.Div:this.tryConsumeFixToken(m.Div)?pt.DivText:this.tryConsumeFixToken(m.Mod)?pt.ModText:this.tryConsumeFixToken(m.And)?pt.AndText:this.error("Failed to parse factor infix.")}},{key:"parseRightFactor",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseFactorInfix(),n=this.parseFactor();return new yt(T.merge(e,n.getLocation()),t,n)}},{key:"parseTerm",value:function(){var e=this.parseFactor();if(!this.isFactorInfix())return e;var t=this.parseListWithPredicate(this.parseRightFactor.bind(this),this.isFactorInfix.bind(this));return new gt(T.merge(e.getLocation(),t[t.length-1].getLocation()),e,t)}},{key:"isTermInfix",value:function(){return this.hasTag(m.Plus)||this.hasTag(m.Minus)||this.hasTag(m.Or)}},{key:"parseTermInfix",value:function(){return this.tryConsumeFixToken(m.Plus)?ct.Plus:this.tryConsumeFixToken(m.Minus)?ct.Minus:this.tryConsumeFixToken(m.Or)?ct.Or:this.error("Failed to parse term infix.")}},{key:"parseRightTerm",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseTermInfix(),n=this.parseTerm();return new ft(T.merge(e,n.getLocation()),t,n)}},{key:"isTermPrefix",value:function(){return this.hasTag(m.Plus)||this.hasTag(m.Minus)}},{key:"parseUnaryPrefix",value:function(){return this.tryConsumeFixToken(m.Plus)?st.Plus:this.tryConsumeFixToken(m.Minus)?st.Minus:this.error("Failed to parse prefix operator.")}},{key:"parseUnaryTerm",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseUnaryPrefix(),n=this.parseTerm();return new ut(T.merge(e,n.getLocation()),t,n)}},{key:"parseSimpleExpression",value:function(){var e=this.isTermPrefix()?this.parseUnaryTerm():this.parseTerm();if(!this.isTermInfix())return e;var t=this.parseListWithPredicate(this.parseRightTerm.bind(this),this.isTermInfix.bind(this));return new ht(T.merge(e.getLocation(),t[t.length-1].getLocation()),e,t)}},{key:"isBinaryExpressionOperator",value:function(){return this.hasTag(m.Equal)||this.hasTag(m.NumberSign)||this.hasTag(m.Less)||this.hasTag(m.LessEqual)||this.hasTag(m.Greater)||this.hasTag(m.GreaterEqual)}},{key:"parseBinaryExpressionOperator",value:function(){return this.tryConsumeFixToken(m.Equal)?Ze.Equal:this.tryConsumeFixToken(m.NumberSign)?Ze.NotEqual:this.tryConsumeFixToken(m.Less)?Ze.Less:this.tryConsumeFixToken(m.LessEqual)?Ze.LessEqual:this.tryConsumeFixToken(m.Greater)?Ze.More:this.tryConsumeFixToken(m.GreaterEqual)?Ze.MoreEqual:this.error("Failed to parse term infix.")}},{key:"parseBinaryExpression",value:function(e,t,n){var r=this.parseBinaryExpressionOperator(),a=this.parseSimpleExpression();return new nt(T.merge(e,a.getLocation()),t,n,r,a)}},{key:"parseExpression",value:function(){var e=this.parseAttributeList(),t=this.parseSimpleExpression();if(t instanceof qt){var n=0===e.length?t.getLocation():e[0].getLocation();if(this.tryConsumeFixToken(m.Offers)){var r=this.parseOfferedInterfaceDeclarationList();return new at(T.merge(n,r[r.length-1].getLocation()),e,tt.Offers,r)}if(this.tryConsumeFixToken(m.Requires)){var a=this.parseRequiredInterfaceDeclarationList();return new at(T.merge(n,a[a.length-1].getLocation()),e,tt.Requires,a)}if(this.tryConsumeFixToken(m.Is)){var i=this.parseType();return new it(T.merge(n,i.getLocation()),e,t,i)}return this.isBinaryExpressionOperator()?this.parseBinaryExpression(n,e,t):t}var s=0===e.length?t.getLocation():e[0].getLocation();return this.isBinaryExpressionOperator()?this.parseBinaryExpression(s,e,t):new et(T.merge(s,t.getLocation()),e,t)}},{key:"parseProcedureCall",value:function(){var e=this.parseName(),t=new Array,n=e.getLocation();return this.tryConsumeFixToken(m.OpenParentheses)&&(t.push.apply(t,Object(u.a)(this.parseExpressionList())),n=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(m.CloseParentheses)),new xn(T.merge(e.getLocation(),n),e,t)}},{key:"parseStatementSequenceBlock",value:function(e){var t=void 0;if(this.hasTag(e)){var n=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(e),t=this.parseStatementSequence(n)}return t}},{key:"parseBasicDesignator",value:function(){var e=this.parseName();if(this.tryConsumeFixToken(m.OpenSquareBracket)){var t=this.parseExpressionList(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseSquareBracket),new Gt(T.merge(e.getLocation(),n),e,t)}return new _t(e.getLocation(),e)}},{key:"parseDesignator",value:function(){var e=this.parseBasicDesignator();if(this.tryConsumeFixToken(m.OpenParentheses)){if(this.hasTag(m.Any)){var t=this.parseType(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Wt(T.merge(e.getLocation(),n),e,t)}var r=this.parseDesignator(),a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Ut(T.merge(e.getLocation(),a),e,r)}return e}},{key:"tryParseDesignator",value:function(){return this.tryParse(this.parseDesignator.bind(this))}},{key:"parseStatementSequence",value:function(e){var t=this.parseAttributeList(),n=this.parseStatementList(),r=n[n.length-1].getLocation();return new qn(T.merge(e,r),t,n)}},{key:"parseNewStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.New),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator(),n=new Array;this.tryConsumeFixToken(m.Comma)&&n.push.apply(n,Object(u.a)(this.parseExpressionList()));var r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new wn(T.merge(e,r),t,n)}},{key:"parseDeleteStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Delete),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Ln(T.merge(e,n),t)}},{key:"parseConnectStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Conncet),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator();this.expectConsumeFixToken(m.Comma);var n=this.parseDesignator(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new En(T.merge(e,r),t,n)}},{key:"parseDisconnectStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Disconnect),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Cn(T.merge(e,n),t)}},{key:"parseMoveStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Move),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseDesignator();this.expectConsumeFixToken(m.Comma);var n=this.parseDesignator(),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new In(T.merge(e,r),t,n)}},{key:"parseAwaitStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeIdentifierToken(_n.Await),this.expectConsumeFixToken(m.OpenParentheses);var t=this.parseExpression(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.CloseParentheses),new Fn(T.merge(e,n),t)}},{key:"parseSendStatement",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.ExclamationMark);var r=this.parseName(),a=new Array,i=r.getLocation();return this.tryConsumeFixToken(m.OpenParentheses)&&(a.push.apply(a,Object(u.a)(this.parseExpressionList())),i=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(m.CloseParentheses)),new jn(T.merge(n,i),e,r,a)}},{key:"parseReceiveStatement",value:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.getLocation())&&void 0!==t?t:this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.QuestionMark);var r=this.parseName(),a=new Array,i=r.getLocation();return this.tryConsumeFixToken(m.OpenParentheses)&&(a.push.apply(a,Object(u.a)(this.parseDesignatorList())),i=this.lexer.peek(1).getLocation(),this.expectConsumeFixToken(m.CloseParentheses)),new Sn(T.merge(n,i),e,r,a)}},{key:"parseAssignmentStatement",value:function(e){this.expectConsumeFixToken(m.ColonEqual);var t=this.parseExpression();return new On(T.merge(e.getLocation(),t.getLocation()),e,t)}},{key:"parseReturnStatement",value:function(){var e,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Return);var n=this.tryParseExpression();return new Pn(T.merge(t,null!==(e=null===n||void 0===n?void 0:n.getLocation())&&void 0!==e?e:t),n)}},{key:"parseIfStatement",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.If);var n=this.parseExpression();this.expectConsumeFixToken(m.Then);var r=this.parseStatementSequence(this.lexer.peek(1).getLocation()),a=new Array;this.loop((function(){return e.hasTag(m.Elsif)}),(function(){var t=e.lexer.peek(1).getLocation();e.expectConsumeFixToken(m.Elsif);var n=e.parseExpression();e.expectConsumeFixToken(m.Then);var r=e.parseStatementSequence(e.lexer.peek(1).getLocation());a.push(new Nn(T.merge(t,r.getLocation()),n,r))}));var i=void 0;this.tryConsumeFixToken(m.Else)&&(i=this.parseStatementSequence(this.lexer.peek(1).getLocation()));var s=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.End),new An(T.merge(t,s),n,r,a,i)}},{key:"parseWhileStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.While);var t=this.parseExpression();this.expectConsumeFixToken(m.Do);var n=this.parseStatementSequence(this.lexer.peek(1).getLocation()),r=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.End),new Rn(T.merge(e,r),t,n)}},{key:"parseRepeatStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Repeat);var t=this.parseStatementSequence(this.lexer.peek(1).getLocation());this.expectConsumeFixToken(m.Until);var n=this.parseExpression();return new Dn(T.merge(e,n.getLocation()),t,n)}},{key:"parseForStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.For);var t=this.parseDesignator();this.expectConsumeFixToken(m.ColonEqual);var n=this.parseExpression();this.expectConsumeFixToken(m.To);var r=this.parseExpression(),a=void 0;this.tryConsumeFixToken(m.By)&&(a=this.parseConstantExpression()),this.expectConsumeFixToken(m.Do);var i=this.parseStatementSequence(this.lexer.peek(1).getLocation()),s=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.End),new Bn(T.merge(e,s),t,n,r,a,i)}},{key:"parseForeachStatement",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Foreach);var t=this.parseDesignatorList();this.expectConsumeFixToken(m.Of);var n=this.parseDesignator();this.expectConsumeFixToken(m.Do);var r=this.parseStatementSequence(this.lexer.peek(1).getLocation()),a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.End),new Vn(T.merge(e,a),t,n,r)}},{key:"parseStatementBlock",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Begin);var t=this.parseStatementSequence(this.lexer.peek(1).getLocation()),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.End),new Mn(T.merge(e,n),t)}},{key:"parseStatement",value:function(){if(this.hasIdentifier(_n.New))return this.parseNewStatement();if(this.hasIdentifier(_n.Delete))return this.parseDeleteStatement();if(this.hasIdentifier(_n.Conncet))return this.parseConnectStatement();if(this.hasIdentifier(_n.Disconnect))return this.parseDisconnectStatement();if(this.hasIdentifier(_n.Move))return this.parseMoveStatement();if(this.hasIdentifier(_n.Await))return this.parseAwaitStatement();if(this.hasTag(m.Return))return this.parseReturnStatement();if(this.hasTag(m.If))return this.parseIfStatement();if(this.hasTag(m.While))return this.parseWhileStatement();if(this.hasTag(m.Repeat))return this.parseRepeatStatement();if(this.hasTag(m.For))return this.parseForStatement();if(this.hasTag(m.Foreach))return this.parseForeachStatement();if(this.hasTag(m.Begin))return this.parseStatementBlock();var e=this.tryParseDesignator();if(this.hasTag(m.ExclamationMark))return this.parseSendStatement(e);if(this.hasTag(m.QuestionMark))return this.parseReceiveStatement(e);if(void 0===e)return this.parseProcedureCall();if(this.hasTag(m.ColonEqual))return this.parseAssignmentStatement(e);if(e instanceof _t)return new xn(e.getLocation(),e.getName(),new Array);if(e instanceof Ut){var t=e.getBase();if(t instanceof _t)return new xn(e.getLocation(),t.getName(),new Array(e.getTarget()))}return this.error("Failed to parse statement. Unknown statement.")}},{key:"parseConstantExpression",value:function(){var e=this.parseExpression();return new ze(e.getLocation(),e)}},{key:"parseConstant",value:function(){var e=this.parseName();this.expectConsumeFixToken(m.Equal);var t=this.parseConstantExpression(),n=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.Semicolon),new Xe(T.merge(e.getLocation(),n),e,t)}},{key:"tryParseConstant",value:function(){return this.tryParse(this.parseConstant.bind(this))}},{key:"parseConstantList",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Constant);var n=new y(this.parseConstant()),r=!0;return this.loop((function(){return r}),(function(){var t=e.tryParseConstant();void 0!==t?n.push(t):r=!1})),new Ye(T.merge(t,n[n.length-1].getLocation()),n)}},{key:"parseVariable",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseIndexedIdentifierList();this.expectConsumeFixToken(m.Colon);var n=this.parseType(),r=this.parseAttributeList(),a=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.Semicolon),new Hn(T.merge(e,a),t,n,r)}},{key:"tryParseVariable",value:function(){return this.tryParse(this.parseVariable.bind(this))}},{key:"parseVariableList",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Variable);var n=new y(this.parseVariable()),r=!0;return this.loop((function(){return r}),(function(){var t=e.tryParseVariable();void 0!==t?n.push(t):r=!1})),new Qn(T.merge(t,n[n.length-1].getLocation()),n)}},{key:"parseProcedure",value:function(){var e=this,t=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Procedure);var n=this.parseName(),r=new Array;this.tryConsumeFixToken(m.OpenParentheses)&&(this.hasTag(m.CloseParentheses)||r.push.apply(r,Object(u.a)(this.parseProcedureParameterList())),this.expectConsumeFixToken(m.CloseParentheses));var a=this.tryConsumeFixToken(m.Colon)?this.parseType():void 0;this.expectConsumeFixToken(m.Semicolon);var i=new Array,s=void 0,o=!1;this.loop((function(){return!e.hasTag(m.End)&&!o}),(function(){var t=e.parseDeclaration();void 0===t?void 0!==s?o=!0:s=e.parseStatementSequenceBlock(m.Begin):i.push(t)}));var c=this.consumeEnd(n);return new an(T.merge(t,c),n,r,a,i,s)}},{key:"parseDeclaration",value:function(){return this.hasTag(m.Component)?this.parseComponent():this.hasTag(m.Interface)?this.parseInterface():this.hasTag(m.Constant)?this.parseConstantList():this.hasTag(m.Variable)?this.parseVariableList():this.hasTag(m.Procedure)?this.parseProcedure():void 0}},{key:"parseComponentBody",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=void 0,r=void 0,a=void 0,i=new Array,s=new Array,o=t,c=!1;return this.loop((function(){return!e.hasTag(m.End)&&!c}),(function(){var t=e.parseDeclaration();if(void 0===t)if(e.hasTag(m.Implementation))s.push(e.parseImplementation());else if(void 0!==n&&e.hasTag(m.Begin)&&e.error("Cannot have more than one begin per component."),void 0===n&&e.hasTag(m.Begin))void 0!==(n=e.parseStatementSequenceBlock(m.Begin))&&(o=n.getLocation());else if(void 0!==r&&e.hasTag(m.Activity)&&e.error("Cannot have more than one activity per component."),void 0===r&&e.hasTag(m.Activity))void 0!==(r=e.parseStatementSequenceBlock(m.Activity))&&(o=r.getLocation());else if(void 0!==a&&e.hasTag(m.Finally)&&e.error("Cannot have more than one finally per component."),void 0===a&&e.hasTag(m.Finally))void 0!==(a=e.parseStatementSequenceBlock(m.Finally))&&(o=a.getLocation());else if(e.hasTag(m.Component)){var u=e.parseComponent();void 0!==u&&i.push(u)}else if(e.hasTag(m.Implementation)){var l=e.parseImplementation();void 0!==l&&s.push(l)}else c=!0;else i.push(t)})),new Qe(T.merge(t,o),i,s,n,r,a)}},{key:"consumeEnd",value:function(e){this.expectConsumeFixToken(m.End),this.parseName().getName()!==e.getName()&&this.error("Name missmatch.");var t=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(m.Semicolon),t}},{key:"parseComponent",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Component);var t=this.parseName(),n=this.parseOffers(),r=this.parseRequires();this.expectConsumeFixToken(m.Semicolon);var a=this.parseComponentBody(),i=this.consumeEnd(t);return new He(T.merge(e,i),t,n,r,a)}},{key:"parseImplementation",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Implementation);var t=this.parseName();this.expectConsumeFixToken(m.Semicolon);var n=this.parseDeclarationList(),r=this.parseStatementSequenceBlock(m.Begin),a=this.consumeEnd(t);return new Ht(T.merge(e,a),t,n,r)}},{key:"parseListWithPredicate",value:function(e,t){var n=new y(e());return this.loop((function(){return t()}),(function(){n.push(e())})),n}},{key:"parseList",value:function(e,t){var n=this,r=new y(e());return this.loop((function(){return n.hasTag(t)}),(function(){n.expectConsumeFixToken(t),r.push(e())})),r}},{key:"parseIdentifierList",value:function(){return this.parseList(this.parseName.bind(this),m.Comma)}},{key:"parseParameterList",value:function(){return this.parseList(this.parseParameter.bind(this),m.Semicolon)}},{key:"parseProcedureParameterList",value:function(){return this.parseList(this.parseProcedureParameter.bind(this),m.Semicolon)}},{key:"parseIndexedIdentifierList",value:function(){return this.parseList(this.parseIndexedName.bind(this),m.Comma)}},{key:"parseExpressionList",value:function(){return this.parseList(this.parseExpression.bind(this),m.Comma)}},{key:"parseDesignatorList",value:function(){return this.parseList(this.parseDesignator.bind(this),m.Comma)}},{key:"parseOfferedInterfaceDeclarationList",value:function(){return this.parseList(this.parseOfferedInterfaceDeclaration.bind(this),m.Comma)}},{key:"parseRequiredInterfaceDeclarationList",value:function(){return this.parseList(this.parseRequiredInterfaceDeclaration.bind(this),m.Comma)}},{key:"parseStatementList",value:function(){return this.parseList(this.parseStatement.bind(this),m.Semicolon)}},{key:"parseAttributeList",value:function(){if(!this.hasTag(m.OpenBrace))return new Array;this.expectConsumeFixToken(m.OpenBrace);var e=this.parseIdentifierList();return this.expectConsumeFixToken(m.CloseBrace),e.map((function(e){return new _e(e.getLocation(),e)}))}},{key:"parseDeclarationList",value:function(){var e=this,t=new Array,n=!0;return this.loop((function(){return n}),(function(){var r=e.parseDeclaration();void 0!==r?t.push(r):n=!1})),t}},{key:"parseType",value:function(){var e=this.lexer.peek(1);if(e instanceof S)return this.lexer.next(),new Un(e.getLocation(),e.getIdentifier());this.expectConsumeFixToken(m.Any);var t=new Array,n=new Array;return this.tryConsumeFixToken(m.OpenParentheses)&&(t.push.apply(t,Object(u.a)(this.parseOfferedInterfaceDeclarationList())),this.tryConsumeFixToken(m.Pipe)&&n.push.apply(n,Object(u.a)(this.parseRequiredInterfaceDeclarationList())),this.expectConsumeFixToken(m.CloseParentheses)),new Wn(e.getLocation(),t,n)}},{key:"parseParameter",value:function(){var e=this.parseIdentifierList();this.expectConsumeFixToken(m.Colon);var t=this.parseType();return new rn(T.merge(e[0].getLocation(),t.getLocation()),e,t)}},{key:"parseProcedureParameter",value:function(){var e=this.hasTag(m.Variable),t=this.lexer.peek(1).getLocation();e&&this.expectConsumeFixToken(m.Variable);var n=this.parseParameter();return new sn(T.merge(t,n.getLocation()),e,n)}},{key:"parseMessageParameters",value:function(){if(this.tryConsumeFixToken(m.OpenParentheses)){var e=this.parseParameterList();return this.expectConsumeFixToken(m.CloseParentheses),e}return new Array}},{key:"parseMessageDeclaration",value:function(){var e=this.lexer.peek(1).getLocation(),t=void 0;if(this.tryConsumeFixToken(m.In)&&(t=cn.IN),this.tryConsumeFixToken(m.Out)&&(t=cn.OUT),void 0===t)return this.error("Message declarations must have a direction.");var n=this.parseName(),r=this.parseMessageParameters();return new hn(e,t,n,r)}},{key:"parseProtocolTermExpression",value:function(e,t,n){var r=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(t);var a=this.parseProtocolExpression();if(void 0!==a){var i=this.lexer.peek(1).getLocation();return this.expectConsumeFixToken(n),new e(T.merge(r,i),a)}return this.error("Failed to parse protocol term expression.")}},{key:"parseProtocolTerm",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=new Array;this.loop((function(){return e.hasTag(m.In)||e.hasTag(m.Out)||e.hasTag(m.OpenSquareBracket)||e.hasTag(m.OpenParentheses)||e.hasTag(m.OpenBrace)}),(function(){if(e.hasTag(m.In)||e.hasTag(m.Out))n.push(e.parseMessageDeclaration());else if(e.hasTag(m.OpenSquareBracket)){var t=e.parseProtocolTermExpression(gn,m.OpenSquareBracket,m.CloseSquareBracket);n.push(t)}else if(e.hasTag(m.OpenParentheses)){var r=e.parseProtocolTermExpression(dn,m.OpenParentheses,m.CloseParentheses);n.push(r)}else if(e.hasTag(m.OpenBrace)){var a=e.parseProtocolTermExpression(yn,m.OpenBrace,m.CloseBrace);n.push(a)}else;}));var r=y.fromArray(n);return void 0===r?this.error("At least one term factor needed."):new Yt(t,r)}},{key:"parseProtocolExpression",value:function(){var e=this,t=this.lexer.peek(1).getLocation();if(!this.hasTag(m.End)){var n=new y(this.parseProtocolTerm());return this.loop((function(){return e.hasTag(m.Pipe)}),(function(){e.expectConsumeFixToken(m.Pipe),n.push(e.parseProtocolTerm())})),new zt(t,n)}}},{key:"parseProtocol",value:function(){var e=this.lexer.peek(1).getLocation(),t=this.parseProtocolExpression();return new Xt(void 0===t?e:T.merge(e,t.getLocation()),t)}},{key:"parseInterface",value:function(){var e=this.lexer.peek(1).getLocation();this.expectConsumeFixToken(m.Interface);var t=this.parseName();this.expectConsumeFixToken(m.Semicolon);var n=this.parseProtocol(),r=this.consumeEnd(t);return new Qt(T.merge(e,r),t,n)}},{key:"parse",value:function(){var e=this,t=this.lexer.peek(1).getLocation(),n=new Array,r=new Array,a=!1;this.loop((function(){return!a}),(function(){if(e.isComponent()){var t=e.parseComponent();void 0!==t&&n.push(t)}else if(e.isInterface()){var i=e.parseInterface();void 0!==i&&r.push(i)}else e.error("Invalid top level node."),a=!0}));var i=this.lexer.peek(1).getLocation();return new on(T.merge(t,i),n,r)}}]),e}();!function(e){e[e.Tag=0]="Tag"}(zn||(zn={}));var Kn,$n=function e(){Object(s.a)(this,e),this._symbolTag=zn.Tag};!function(e){e[e.Tag=0]="Tag"}(Kn||(Kn={}));var Zn,Jn=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._globalScopeSymbolTag=Kn.Tag,e}return n}($n),er=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this)).scope=e,r}return Object(o.a)(n,[{key:"getScope",value:function(){return this.scope}}]),n}($n),tr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).name=r,a}return Object(o.a)(n,[{key:"getProgramName",value:function(){return this.name}}]),n}(er),nr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).identifier=r,a}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}}]),n}(er);!function(e){e[e.Tag=0]="Tag"}(Zn||(Zn={}));var rr,ar=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._blockScopeSymbolTag=Zn.Tag,e}return n}(er);!function(e){e[e.Tag=0]="Tag"}(rr||(rr={}));var ir,sr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._typeSymbolTag=rr.Tag,e}return n}(nr);!function(e){e[e.Tag=0]="Tag"}(ir||(ir={}));var or,cr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._builtInTypeSymbol=ir.Tag,e}return n}(sr);!function(e){e[e.Tag=0]="Tag"}(or||(or={}));var ur,lr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments))._interfaceSymbolTag=or.Tag,e}return n}(sr);!function(e){e[e.Tag=0]="Tag"}(ur||(ur={}));var hr,fr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r)).genericType=a,i._componentSymbolTag=ur.Tag,i}return Object(o.a)(n,[{key:"getGenericType",value:function(){return this.genericType}}]),n}(sr);!function(e){e[e.Tag=0]="Tag"}(hr||(hr={}));var pr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,"@@@__ANY__GENERIC_COMPONENT__@@@",r))._genericComponentSymbolTag=hr.Tag,a}return n}(fr),vr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r)).parameters=a,i}return Object(o.a)(n,[{key:"getParameters",value:function(){return this.parameters}}]),n}(sr),gr=function(){function e(){Object(s.a)(this,e),this.globalScope=new Jn,this.voidType=new cr(this.globalScope,"@@@__VOID__@@@"),this.anyRequiredInterfaceType=new lr(this.globalScope,"@@@__ANY_REQUIRED_INTERFACE__@@@"),this.symbolToDeclaration=new Map,this.symbolToImplementation=new Map,this.expressionToType=new Map,this.typeToType=new Map,this.designatorToSymbol=new Map,this.callToSymbol=new Map,this.sendReceiveToSymbol=new Map,this.types=new Array,this.builtins=new Array,this.components=new Array,this.interfaces=new Array,this.messages=new Array,this.procedures=new Array,this.impplementations=new Array,this.constants=new Array,this.variables=new Array,this.collectionVariables=new Array}return Object(o.a)(e,[{key:"getGlobalScope",value:function(){return this.globalScope}},{key:"getVoidType",value:function(){return this.voidType}},{key:"getAnyRequiredInterfaceType",value:function(){return this.anyRequiredInterfaceType}},{key:"getComponents",value:function(){return this.components}},{key:"getInterfaces",value:function(){return this.interfaces}},{key:"getMessages",value:function(e){return this.messages.filter((function(t){return t.getScope()===e}))}},{key:"getConstants",value:function(){return this.constants}},{key:"getSystemProcedures",value:function(){var e=this;return this.procedures.filter((function(t){return t.getScope()===e.globalScope}))}},{key:"getProcedures",value:function(e){return this.procedures.filter((function(t){return t.getScope()===e}))}},{key:"getImplementations",value:function(e){return this.impplementations.filter((function(t){return t.getScope()===e}))}},{key:"getVariables",value:function(e){return this.variables.filter((function(t){return t.getScope()===e}))}},{key:"getCollectionVariables",value:function(e){return this.collectionVariables.filter((function(t){return t.getScope()===e}))}},{key:"registerBuiltIns",value:function(e){this.builtins.push(e),this.types.push(e)}},{key:"registerComponent",value:function(e){this.components.push(e),this.types.push(e)}},{key:"registerInterface",value:function(e){this.interfaces.push(e),this.types.push(e)}},{key:"registerMessage",value:function(e){this.messages.push(e),this.types.push(e)}},{key:"registerProcedure",value:function(e){this.procedures.push(e)}},{key:"registerImplementation",value:function(e){this.impplementations.push(e)}},{key:"registerConstant",value:function(e){this.constants.push(e)}},{key:"registerVariable",value:function(e){this.variables.push(e)}},{key:"registerCollectionVariable",value:function(e){this.collectionVariables.push(e)}},{key:"linkImplementationNode",value:function(e,t){this.symbolToImplementation.set(e,t)}},{key:"findImplementationNode",value:function(e){return this.symbolToImplementation.get(e)}},{key:"linkDeclarationNode",value:function(e,t){this.symbolToDeclaration.set(e,t)}},{key:"findDeclarationNode",value:function(e){return this.symbolToDeclaration.get(e)}},{key:"fixCallNode",value:function(e,t){this.callToSymbol.set(e,t)}},{key:"getCallProcedure",value:function(e){var t=this.callToSymbol.get(e);if(void 0===t)throw new Error("Failed call node lookup.");return t}},{key:"fixMessage",value:function(e,t){this.sendReceiveToSymbol.set(e,t)}},{key:"getMessageForSendReceive",value:function(e){var t=this.sendReceiveToSymbol.get(e);if(void 0===t)throw new Error("Failed message node lookup.");return t}},{key:"fixExpressionNode",value:function(e,t){this.expressionToType.set(e,t)}},{key:"findExpressionType",value:function(e){return this.expressionToType.get(e)}},{key:"fixTypeNode",value:function(e,t){this.typeToType.set(e,t)}},{key:"findTypeSymbol",value:function(e){return this.typeToType.get(e)}},{key:"fixDesignatorNode",value:function(e,t){this.designatorToSymbol.set(e,t)}},{key:"findDesignatorSymbol",value:function(e){return this.designatorToSymbol.get(e)}},{key:"findConstant",value:function(e){return this.constants.filter((function(t){return t.getIdentifier()===e}))}},{key:"getConstant",value:function(e){var t=this.findConstant(e);if(1!==t.length)throw new Error("Failed constant lookup for ".concat(e,"."));return t[0]}},{key:"findBuiltIn",value:function(e){return this.builtins.filter((function(t){return t.getIdentifier()===e}))}},{key:"getBuiltIn",value:function(e){var t=this.findBuiltIn(e);if(1!==t.length)throw new Error("Failed builtin lookup for ".concat(e,"."));return t[0]}},{key:"findProcedure",value:function(e,t,n,r,a){var i=this;return this.findInComponent(this.procedures,function(t,a){return t.getIdentifier()===e&&t.getParameters().length===n.length&&t.getParameters().filter((function(e,t){return i.isAssignable(e,n[t])})).length===n.length&&(void 0===r||t.getReturnType()===r)&&t.getScope()===a}.bind(this),t,a,!1)}},{key:"isAssignable",value:function(e,t){return e instanceof fr&&t instanceof fr?e.getGenericType().canBeSubstitutedBy(t.getGenericType()):e===t}},{key:"findMessage",value:function(e,t,n,r){var a=this;return this.findInComponent(this.messages,function(t,r){return t.getIdentifier()===e&&t.getParameters().length===n.length&&t.getParameters().filter((function(e,t){return a.isAssignable(e,n[t])})).length===n.length&&t.getScope()===r}.bind(this),t,r,!1)}},{key:"findInComponent",value:function(e,t,n,r,a){if(!r&&n instanceof Jn)return new Array;var i=e.filter((function(e){return t(e,n)}));return i.length>0||n instanceof Jn||!r&&n.getScope()instanceof Jn?i:!a&&(n instanceof fr||n instanceof lr)?r?this.findInComponent(e,t,this.globalScope,r,a):i:this.findInComponent(e,t,n.getScope(),r,a)}},{key:"findNameInScope",value:function(e,t,n,r,a){return this.findInComponent(e,function(e,n){return e.getIdentifier()===t&&e.getScope()===n}.bind(this),n,r,a)}},{key:"findVariable",value:function(e,t,n){var r=this.findNameInScope(this.variables.filter((function(e){return e.isMutable()})),e,t,n,!1);return 0!==r.length?r:this.findNameInScope(this.variables.filter((function(e){return!e.isMutable()})),e,t,n,!0)}},{key:"findCollectionVariable",value:function(e,t,n,r,a){var i=this;return this.findInComponent(this.collectionVariables,function(t,r){return t.getIdentifier()===e&&(void 0===n||t.getParameters().length===n.length&&t.getParameters().filter((function(e,t){return i.isAssignable(e,n[t])})).length===n.length)&&t.getScope()===r}.bind(this),t,r,a)}},{key:"findComponent",value:function(e,t,n,r){return this.findNameInScope(this.components,e,t,n,r)}},{key:"findInterface",value:function(e,t,n,r){return this.findNameInScope(this.interfaces,e,t,n,r)}},{key:"findType",value:function(e,t,n,r){var a=this.findNameInScope(this.types,e,t,n,r);return 0===a.length?this.constants.filter((function(t){return t.getIdentifier()===e})).map((function(e){return e.getType()})):a}},{key:"findImplementation",value:function(e,t,n){return this.findInComponent(this.impplementations,function(t,n){return t.getInterface().getIdentifier()===e&&t.getScope()===n}.bind(this),t,n,!1)}}],[{key:"componentSatisfiesGeneric",value:function(e,t){return 0===t.getOffered().length&&0===t.getRequired().length||t.canBeSubstitutedBy(e.getGenericType())}}]),e}(),br=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(Object(s.a)(this,n),(r=t.call(this)).min=e,r.max=a,e<1)throw new Error("cardinality must be greater 0");if(a<e)throw new Error("min ".concat(e," must be greater than max ").concat(a));return r}return Object(o.a)(n,[{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"hasMax",value:function(){return this.max===1/0}}]),n}($n),yr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).identifier=e,a.type=r,a}return Object(o.a)(n,[{key:"getIdentifier",value:function(){return this.identifier}},{key:"getType",value:function(){return this.type}}]),n}($n),mr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).interfaceSymbol=e,a.cardinality=r,a}return Object(o.a)(n,[{key:"getInterface",value:function(){return this.interfaceSymbol}},{key:"getCardinality",value:function(){return this.cardinality}}]),n}($n),dr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).offered=e,a.required=r,n.validate(a.offered,"Offered interface defined multiple times."),n.validate(a.required,"Required interface defined multiple times."),a}return Object(o.a)(n,[{key:"canBeSubstitutedBy",value:function(e){return n.matchInterfaceDeclarations(this.offered,e.offered,(function(e,t){return e>=t}),(function(e,t){return e>=t}))&&n.matchInterfaceDeclarations(this.required,e.required,(function(e,t){return e<=t}),(function(e,t){return e<=t}))}},{key:"canSubstitute",value:function(e){return e.canBeSubstitutedBy(this)}},{key:"getOffered",value:function(){return this.offered}},{key:"getRequired",value:function(){return this.required}}],[{key:"validate",value:function(e,t){if(Object(c.a)(Array,Object(u.a)(new Set(e.map((function(e){return e.getInterface().getIdentifier()}))))).length!==e.length)throw new Error(t)}},{key:"matchInterfaceDeclarations",value:function(e,t,n,r){return e.filter((function(e){return void 0!==t.find((function(t){return t.getInterface()===e.getInterface()&&n(e.getCardinality().getMin(),t.getCardinality().getMin())&&r(e.getCardinality().getMax(),t.getCardinality().getMax())}))})).length===e.length}}]),n}($n);function kr(e,t,n){return(kr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(f.a)(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}var Tr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).interfaceSymbol=r,a}return Object(o.a)(n,[{key:"getScope",value:function(){return kr(Object(f.a)(n.prototype),"getScope",this).call(this)}},{key:"getInterface",value:function(){return this.interfaceSymbol}}]),n}(er),xr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r)).parameters=a,o.returnType=i,o}return Object(o.a)(n,[{key:"getParameters",value:function(){return this.parameters}},{key:"getReturnType",value:function(){return this.returnType}}]),n}(sr),Or=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r)).mutable=a,o.type=i,o}return Object(o.a)(n,[{key:"isMutable",value:function(){return this.mutable}},{key:"getType",value:function(){return this.type}}]),n}(nr),wr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r)).type=a,o.parameters=i,o}return Object(o.a)(n,[{key:"getType",value:function(){return this.type}},{key:"getParameters",value:function(){return this.parameters}}]),n}(nr),Er=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitComponent",value:function(e){var t=this,n=e.getName().getName(),r=new fr(this.scope,n,new dr(e.getOffers().map((function(e){return Rr.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)})),e.getRequires().map((function(e){return Rr.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)}))));try{throw Vr.getComponent(this.symbolTable,this.scope,n,!1,!1),new Error("Duplicate component ".concat(n," detected,"))}catch(a){}this.symbolTable.registerComponent(r),this.symbolTable.linkDeclarationNode(r,e)}}]),n}(Xn),Cr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitInterface",value:function(e){var t=e.getName().getName(),n=new lr(this.scope,t);try{throw Vr.getInterface(this.symbolTable,this.scope,t,!1,!1),new Error("Duplicate interface ".concat(t," detected."))}catch(r){}this.symbolTable.registerInterface(n),this.symbolTable.linkDeclarationNode(n,e)}}]),n}(Xn),jr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitBasicType",value:function(e){var t=this.symbolTable.findType(e.getIdentifier(),this.scope,!0,!0);if(t.length<1)throw new Error("Failed to find type for basic type: ".concat(e.getIdentifier(),", no type found."));if(t.length>1)throw new Error("Failed to find type for basic type: ".concat(e.getIdentifier(),", multiple definitions found."));this.symbolTable.fixTypeNode(e,t[0])}},{key:"visitAnyType",value:function(e){var t=this,n=new pr(this.scope,new dr(e.getOffered().map((function(e){return Rr.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)})),e.getRequired().map((function(e){return Rr.createInterfaceDeclarationSymbol(t.symbolTable,e,t.scope)}))));this.symbolTable.fixTypeNode(e,n)}}]),n}(Xn),Sr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitProtocol",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(this)}},{key:"visitProtocolTerm",value:function(e){var t=this;e.getFactors().forEach((function(e){return e.accept(t)}))}},{key:"visitMessageDeclaration",value:function(e){var t=this,n=e.getName().getName(),r=e.getParams().flatMap((function(e){e.getType().accept(new jr(t.symbolTable,t.scope));var r=t.symbolTable.findTypeSymbol(e.getType());if(void 0===r)throw new Error("Type lookup for message '".concat(n,"' param failed."));return e.getNames().map((function(){return r}))}));this.symbolTable.registerMessage(new vr(this.scope,n,r))}},{key:"visitOptionalProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitGroupProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitRepeatingProtocolFactorExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitProtocolExpression",value:function(e){var t=this;e.getTerms().forEach((function(e){return e.accept(t)}))}}]),n}(Xn),Lr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitProcedure",value:function(e){var t=this,n=e.getName().getName(),r=Vr.convertParamTypes(this.symbolTable,this.scope,e.getParams().map((function(e){return e.getParameter()}))),a=this.symbolTable.getVoidType(),i=e.getType();if(void 0!==i){i.accept(new jr(this.symbolTable,this.scope));var s=this.symbolTable.findTypeSymbol(i);if(void 0===s)throw new Error("Failed to find procedure return type for ".concat(n,"."));a=s}try{throw Vr.getProcedureFromNode(e,this.symbolTable,this.scope,!1),new Error("Duplicate procedure detected.")}catch(c){}var o=new xr(this.scope,n,r,a);e.getParams().forEach((function(e){var n=e.getParameter();n.getNames().forEach((function(r){return t.symbolTable.registerVariable(new Or(o,r.getName(),e.isMutable(),Vr.getTypeType(t.symbolTable,n.getType())))}))})),this.symbolTable.registerProcedure(o)}}]),n}(Xn),Ir=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitImplementation",value:function(e){var t=e.getName().getName(),n=this.scope.getGenericType().getOffered().filter((function(e){return e.getInterface().getIdentifier()===t})).map((function(e){return e.getInterface()}));if(1!==n.length)throw new Error("Could not find interface for '".concat(t,"' implementation."));try{throw Vr.getImplementation(this.symbolTable,this.scope,t,!1),new Error("Duplicate '".concat(t,"' implementation detected."))}catch(a){}var r=new Tr(this.scope,n[0]);this.symbolTable.registerImplementation(r),this.symbolTable.linkImplementationNode(r,e)}}]),n}(Xn),Fr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"findType",value:function(e){var t=this.symbolTable.findExpressionType(e);if(void 0===t)throw new Error("Failed expression type lookup.");return t}},{key:"visitConstantExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitUnaryExpression",value:function(e){e.getExpression().accept(this);try{this.symbolTable.fixExpressionNode(e,this.findType(e.getExpression()))}catch(t){throw e.getExpression().accept(this),new Error(t)}}},{key:"visitBinaryExpression",value:function(e){e.getLeft().accept(this),e.getRight().accept(this);var t=this.findType(e.getLeft()),n=this.findType(e.getRight());try{this.checkChainMatch(t,n)}catch(a){throw console.log(e),new Error(a.message)}if(!(t instanceof cr))throw new Error("Cannot compare non number values.");var r=t.getIdentifier();switch(e.getOp()){case Ze.Equal:case Ze.NotEqual:if("REAL"!==r&&"INTEGER"!==r&&"BOOLEAN"!==r&&"CHARACTER"!==r&&"TEXT"!==r)throw new Error("Cannot compare non number values.");break;case Ze.Less:case Ze.LessEqual:case Ze.More:case Ze.MoreEqual:if("REAL"!==r&&"INTEGER"!==r&&"CHARACTER"!==r&&"TEXT"!==r)throw new Error("Cannot compare non number values.")}this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN"))}},{key:"visitOffersRequiresExpression",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN"))}},{key:"visitTypeCheck",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN"))}},{key:"visitUnaryTermNode",value:function(e){e.getTerm().accept(this);var t=this.findType(e.getTerm());if(!(t instanceof cr))throw new Error("Cannot apply unary + - op to non builtin type.");var n=t.getIdentifier();switch(e.getOp()){case st.Minus:case st.Plus:if("REAL"!==n&&"INTEGER"!==n)throw new Error("Cannot apply + - to non numbers types.")}this.symbolTable.fixExpressionNode(e,this.findType(e.getTerm()))}},{key:"checkChainMatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=Object(c.a)(Array,Object(u.a)(new Set(n)));if(a.length<1)throw new Error("Failed right factor type lookup.");if(a.length>1)throw new Error("Ambiguous right factor type lookup.");if(a[0]!==e)throw new Error("Factor type missmatch. Left: ".concat(e.getIdentifier(),", Right: ").concat(a[0].getIdentifier()))}},{key:"visitTermChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}));var n=this.findType(e.getLeft());this.checkChainMatch.apply(this,[n].concat(Object(u.a)(e.getRight().map((function(e){return t.findType(e.getRight())}))))),this.symbolTable.fixExpressionNode(e,n)}},{key:"visitRightTerm",value:function(e){e.getRight().accept(this)}},{key:"visitFactorChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}));var n=this.findType(e.getLeft());this.checkChainMatch.apply(this,[n].concat(Object(u.a)(e.getRight().map((function(e){return t.findType(e.getRight())}))))),this.symbolTable.fixExpressionNode(e,n)}},{key:"visitRightFactor",value:function(e){e.getRight().accept(this)}},{key:"visitUnaryFactor",value:function(e){e.getFactor().accept(this);var t=this.findType(e.getFactor());if(!(t instanceof cr))throw new Error("Cannot apply unary not op to non builtin type.");var n=t.getIdentifier();switch(e.getPrefix()){case mt.Not:if("BOOLEAN"!==n)throw new Error("Cannot apply not op to non boolean types.")}this.symbolTable.fixExpressionNode(e,this.findType(e.getFactor()))}},{key:"visitExpressionFactor",value:function(e){e.getExpression().accept(this),this.symbolTable.fixExpressionNode(e,this.findType(e.getExpression()))}},{key:"visitIntegerNumber",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("INTEGER"))}},{key:"visitRealNumber",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("REAL"))}},{key:"visitConstantCharacter",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("CHARACTER"))}},{key:"visitText",value:function(e){this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("TEXT"))}},{key:"visitReceiveTest",value:function(e){var t;this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN")),null===(t=e.getDesignator())||void 0===t||t.accept(new n(this.symbolTable,this.scope))}},{key:"visitInputTest",value:function(e){var t;this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN")),null===(t=e.getDesignator())||void 0===t||t.accept(new n(this.symbolTable,this.scope))}},{key:"visitExistsTest",value:function(e){var t;this.symbolTable.fixExpressionNode(e,this.symbolTable.getBuiltIn("BOOLEAN")),null===(t=e.getDesignator())||void 0===t||t.accept(new n(this.symbolTable,this.scope))}},{key:"visitFunctionCall",value:function(e){var t=this;e.getArguments().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))}));var r=e.getArguments().map((function(e){return t.findType(e)})),a=Vr.getProcedure(e.getName().getName(),this.symbolTable,this.scope,r,void 0,!0);this.symbolTable.fixExpressionNode(e,a.getReturnType()),this.symbolTable.fixCallNode(e,a)}},{key:"visitBasicDesignator",value:function(e){var t=e.getName().getName();try{var n=Vr.getVariable(this.symbolTable,this.scope,t,!0);return this.symbolTable.fixExpressionNode(e,n.getType()),void this.symbolTable.fixDesignatorNode(e,n)}catch(c){}try{var r=Vr.getConstant(this.symbolTable,t);return this.symbolTable.fixExpressionNode(e,r.getType()),void this.symbolTable.fixDesignatorNode(e,r.getType())}catch(c){}try{var a=Vr.getInterface(this.symbolTable,this.scope,t,!0,!0);return this.symbolTable.fixExpressionNode(e,a),void this.symbolTable.fixDesignatorNode(e,a)}catch(c){}try{var i=Vr.getComponent(this.symbolTable,this.scope,t,!0,!1);return this.symbolTable.fixExpressionNode(e,i),void this.symbolTable.fixDesignatorNode(e,i)}catch(c){}try{var s=Vr.getCollectionVariable(this.symbolTable,this.scope,t);return this.symbolTable.fixExpressionNode(e,s.getType()),void this.symbolTable.fixDesignatorNode(e,s)}catch(c){}try{var o=Vr.getProcedureParam(this.symbolTable,this.scope,t);return this.symbolTable.fixExpressionNode(e,o.getType()),void this.symbolTable.fixDesignatorNode(e,o)}catch(c){}throw new Error("Failed designator type lookup for '".concat(t,"'."))}},{key:"visitBasicExpressionDesignator",value:function(e){var t=e.getName().getName();try{var n=Vr.getCollectionVariable(this.symbolTable,this.scope,t);return this.symbolTable.fixExpressionNode(e,n.getType()),void this.symbolTable.fixDesignatorNode(e,n)}catch(a){}try{var r=Vr.getInterface(this.symbolTable,this.scope,t,!0,!0);return this.symbolTable.fixExpressionNode(e,r),void this.symbolTable.fixDesignatorNode(e,r)}catch(a){}throw new Error("Failed designator type lookup for '".concat(t,"'."))}},{key:"visitBaseTargetDesignator",value:function(e){var t=e.getBase(),n=e.getTarget();if(n.accept(this),t instanceof _t){var r=t.getName().getName();try{var a=Vr.getProcedure(r,this.symbolTable,this.scope,new Array(this.findType(n)),void 0,!0);return this.symbolTable.fixExpressionNode(t,a),this.symbolTable.fixDesignatorNode(e,a),void this.symbolTable.fixExpressionNode(e,a.getReturnType())}catch(s){}}t.accept(this);var i=this.findType(t);this.symbolTable.fixExpressionNode(e,i),this.symbolTable.fixDesignatorNode(e,i)}},{key:"visitDesignatorType",value:function(e){e.getDesignator().accept(this),e.getType().accept(new jr(this.symbolTable,this.scope))}}]),n}(Xn),Pr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitConstant",value:function(e){var t=e.getName().getName();e.getExpression().accept(new Fr(this.symbolTable,this.scope));var n=this.symbolTable.findExpressionType(e.getExpression().getExpression());if(void 0===n)throw new Error("".concat(t,": Unknown expression type."));this.symbolTable.registerVariable(new Or(this.scope,t,!1,n))}},{key:"visitConstantList",value:function(e){var t=this;e.getConstants().forEach((function(e){return e.accept(t)}))}}]),n}(Xn),Ar=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitVariable",value:function(e){var t=this;e.getType().accept(new jr(this.symbolTable,this.scope));var n=this.symbolTable.findTypeSymbol(e.getType());if(void 0===n)throw new Error("".concat(e.getNames()[0].getName(),": Unknown type."));e.getNames().forEach((function(e){var r=e.getName();n instanceof cr&&"TEXT"===n.getIdentifier()?t.symbolTable.registerCollectionVariable(new wr(t.scope,r,n,new Array(t.symbolTable.getBuiltIn("INTEGER")))):0!==e.getParams().length?t.symbolTable.registerCollectionVariable(new wr(t.scope,r,n,Vr.convertParamTypes(t.symbolTable,t.scope,e.getParams()))):t.symbolTable.registerVariable(new Or(t.scope,r,!0,n))}))}},{key:"visitVariableList",value:function(e){var t=this;e.getVariables().forEach((function(e){return e.accept(t)}))}}]),n}(Xn),Nr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"visitProgram",value:function(e){var t=this;e.getInterfaces().forEach((function(e){return e.accept(new Cr(t.symbolTable,t.scope))})),e.getComponents().forEach((function(e){return e.accept(new Er(t.symbolTable,t.scope))})),e.getInterfaces().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))})),e.getComponents().forEach((function(e){return e.accept(new n(t.symbolTable,t.scope))}))}},{key:"visitComponent",value:function(e){var t,r=e.getName().getName(),a=this.symbolTable.findComponent(r,this.scope,!1,!1);if(1!==a.length)throw new Error("Failed lookup for component ".concat(r,"."));null===(t=e.getBody())||void 0===t||t.accept(new n(this.symbolTable,a[0]))}},{key:"visitInterface",value:function(e){var t=e.getName().getName(),n=this.symbolTable.findInterface(t,this.scope,!1,!1);if(1!==n.length)throw new Error("Failed to lookup interface ".concat(t,"."));e.getProtocol().accept(new Sr(this.symbolTable,n[0]))}},{key:"visitProtocol",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(new Sr(this.symbolTable,this.scope))}},{key:"visitProcedure",value:function(e){var t=Vr.getProcedureFromNode(e,this.symbolTable,this.scope,!1);this.registerLayer(e.getDeclarations(),t)}},{key:"registerLayer",value:function(e,t,r,a){var i=this,s=e.filter((function(e){return e instanceof He})).map((function(e){return e})),o=e.filter((function(e){return e instanceof Qt})).map((function(e){return e})),c=e.filter((function(e){return e instanceof an})).map((function(e){return e})),u=e.filter((function(e){return e instanceof Qn})).map((function(e){return e})),l=e.filter((function(e){return e instanceof Ye})).map((function(e){return e}));o.forEach((function(e){return e.accept(new Cr(i.symbolTable,t))})),s.forEach((function(e){return e.accept(new Er(i.symbolTable,t))})),c.forEach((function(e){return e.accept(new Lr(i.symbolTable,t))})),u.forEach((function(e){return e.accept(new Ar(i.symbolTable,t))})),l.forEach((function(e){return e.accept(new Pr(i.symbolTable,t))})),void 0!==r&&r(),o.forEach((function(e){return e.accept(new n(i.symbolTable,t))})),s.forEach((function(e){return e.accept(new n(i.symbolTable,t))})),c.forEach((function(e){return e.accept(new n(i.symbolTable,t))})),void 0!==a&&a(new n(this.symbolTable,t))}},{key:"visitImplementation",value:function(e){var t=e.getName().getName();if(!(this.scope instanceof fr))throw new Error("Implementation must be in a component scope!");var n=this.symbolTable.findImplementation(t,this.scope,!1);if(1!==n.length)throw new Error("Failed to lookup interface ".concat(t,"."));this.registerLayer(e.getDeclarations(),n[0])}},{key:"visitComponentBody",value:function(e){var t=this;if(!(this.scope instanceof fr))throw new Error("Component body must be a component scope!");var n=this.scope;this.registerLayer(e.getDeclarations(),n,(function(){e.getImplementations().forEach((function(e){return e.accept(new Ir(t.symbolTable,n))}))}),(function(t){e.getImplementations().forEach((function(e){return e.accept(t)}))}))}}]),n}(Xn),Rr=function(){function e(t,n){Object(s.a)(this,e),this.symbolTable=t,this.programScope=n;var r=new cr(this.symbolTable.getGlobalScope(),"BOOLEAN"),a=new cr(this.symbolTable.getGlobalScope(),"CHARACTER"),i=new cr(this.symbolTable.getGlobalScope(),"TEXT"),o=new cr(this.symbolTable.getGlobalScope(),"INTEGER"),c=new cr(this.symbolTable.getGlobalScope(),"REAL");this.builtInTypes=new Array(r,a,i,o,c),this.constants=new Map([["TRUE",r],["FALSE",r],["PI",c]]),this.variables=new Map([["TIME",o]]),this.systemProcedures=new Array(["ASSERT",[this.symbolTable.getVoidType(),new Array(r)]],["ASSERT",[this.symbolTable.getVoidType(),new Array(r,o)]],["HALT",[this.symbolTable.getVoidType(),new Array(o)]],["INC",[this.symbolTable.getVoidType(),new Array(o)]],["INC",[this.symbolTable.getVoidType(),new Array(o,o)]],["DEC",[this.symbolTable.getVoidType(),new Array(o)]],["DEC",[this.symbolTable.getVoidType(),new Array(o,o)]],["PASSIVATE",[this.symbolTable.getVoidType(),new Array(o)]],["WRITE",[this.symbolTable.getVoidType(),new Array(i)]],["WRITE",[this.symbolTable.getVoidType(),new Array(o)]],["WRITE",[this.symbolTable.getVoidType(),new Array(c)]],["WRITE",[this.symbolTable.getVoidType(),new Array(a)]],["WRITEHEX",[this.symbolTable.getVoidType(),new Array(o)]],["WRITELINE",[this.symbolTable.getVoidType(),new Array]],["COUNT",[o,new Array(this.symbolTable.getAnyRequiredInterfaceType())]],["LENGTH",[o,new Array(i)]],["SQRT",[c,new Array(c)]],["SIN",[c,new Array(c)]],["COS",[c,new Array(c)]],["TAN",[c,new Array(c)]],["ARCSIN",[c,new Array(c)]],["ARCCOS",[c,new Array(c)]],["ARCTAN",[c,new Array(c)]],["RANDOM",[o,new Array(o,o)]],["MIN",[c,new Array(c)]],["MIN",[o,new Array(o)]],["MAX",[c,new Array(c)]],["MAX",[o,new Array(o)]],["CHARACTER",[a,new Array(o)]],["INTEGER",[o,new Array(c)]],["REAL",[c,new Array(o)]],["TEXT",[i,new Array(a)]])}return Object(o.a)(e,[{key:"register",value:function(e){this.registerBuiltIns(),e.accept(new Nr(this.symbolTable,this.programScope))}},{key:"registerBuiltIns",value:function(){this.registerBuiltInTypes(),this.registerBuiltInProcedures(),this.registerBuiltInConstants(),this.registerBuiltInVariables()}},{key:"registerBuiltInTypes",value:function(){var e=this;this.builtInTypes.forEach((function(t){return e.symbolTable.registerBuiltIns(t)}))}},{key:"registerBuiltInProcedures",value:function(){var e=this;this.systemProcedures.forEach((function(t){var n=new xr(e.symbolTable.getGlobalScope(),t[0],t[1][1],t[1][0]);e.symbolTable.registerProcedure(n)}))}},{key:"registerBuiltInConstants",value:function(){var e=this;this.constants.forEach((function(t,n){return e.symbolTable.registerConstant(new yr(n,t))}))}},{key:"registerBuiltInVariables",value:function(){var e=this;this.variables.forEach((function(t,n){return e.symbolTable.registerVariable(new Or(e.symbolTable.getGlobalScope(),n,!1,t))}))}}],[{key:"run",value:function(t,n,r){new e(t,r).register(n)}},{key:"createInterfaceDeclarationSymbol",value:function(e,t,n){var r,a=t.getName().getName(),i=e.findInterface(a,n,!0,!0);if(0===i.length)throw new Error("Interface ".concat(a," not defined."));if(i.length>1)throw new Error("Interface ".concat(a," multiple times defined."));var s=t.getCardinality();return new mr(i[0],new br(null!==(r=null===s||void 0===s?void 0:s.getMin())&&void 0!==r?r:1,null===s||void 0===s?void 0:s.getMax()))}}]),e}(),Dr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).symbolTable=e,a.scope=r,a}return Object(o.a)(n,[{key:"findCollectionVariable",value:function(e){if(e instanceof Gt||e instanceof _t){var t=e.getName().getName(),n=this.symbolTable.findCollectionVariable(t,this.scope,void 0,!1,!0);if(n.length>1)throw new Error("Found ".concat(t," multiple times."));if(n.length<1)throw new Error("Failed to find ".concat(t,"."));return n[0]}throw new Error("Not implemented yet.")}},{key:"visitProgram",value:function(e){var t=this;e.getComponents().forEach((function(e){return e.accept(t)}))}},{key:"visitComponent",value:function(e){var t,r=Vr.getComponent(this.symbolTable,this.scope,e.getName().getName(),!0,!0);null===(t=e.getBody())||void 0===t||t.accept(new n(this.symbolTable,r))}},{key:"visitComponentBody",value:function(e){var t,r,a,i=this;e.getDeclarations().forEach((function(e){return e.accept(i)})),e.getImplementations().forEach((function(e){return e.accept(i)})),null===(t=e.getBeginBlock())||void 0===t||t.accept(new n(this.symbolTable,this.scope)),null===(r=e.getActivityBlock())||void 0===r||r.accept(new n(this.symbolTable,this.scope)),null===(a=e.getFinallyBlock())||void 0===a||a.accept(new n(this.symbolTable,this.scope))}},{key:"visitImplementation",value:function(e){var t,r=this,a=Vr.getImplementation(this.symbolTable,this.scope,e.getName().getName(),!0);e.getDeclarations().forEach((function(e){return e.accept(new n(r.symbolTable,a))})),null===(t=e.getStatements())||void 0===t||t.accept(new n(this.symbolTable,a))}},{key:"visitProcedure",value:function(e){var t,r=this,a=Vr.getProcedureFromNode(e,this.symbolTable,this.scope,!0);e.getDeclarations().forEach((function(e){return e.accept(new n(r.symbolTable,a))})),null===(t=e.getStatements())||void 0===t||t.accept(new n(this.symbolTable,a))}},{key:"visitStatementSequence",value:function(e){var t=this;e.getStatements().forEach((function(e){return e.accept(new n(t.symbolTable,new ar(t.scope)))}))}},{key:"visitProcedureCall",value:function(e){var t=this,n=e.getParams().map((function(e){e.accept(new Fr(t.symbolTable,t.scope));var n=t.symbolTable.findExpressionType(e);if(void 0===n)throw new Error("Unkown expression type.");return n})),r=Vr.getProcedure(e.getName().getName(),this.symbolTable,this.scope,n,void 0,!0);this.symbolTable.fixCallNode(e,r)}},{key:"visitAssignment",value:function(e){e.getDesignator().accept(new Fr(this.symbolTable,this.scope)),e.getExpression().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitNew",value:function(e){var t=this;e.getDesignator().accept(new Fr(this.symbolTable,this.scope)),e.getArgs().forEach((function(e){return e.accept(new Fr(t.symbolTable,t.scope))}))}},{key:"visitConnect",value:function(e){e.getTo().accept(new Fr(this.symbolTable,this.scope)),e.getWhat().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitDisconnect",value:function(e){e.getWhat().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitSend",value:function(e){this.symbolTable.fixMessage(e,Vr.getMessage(e.getFrom(),e.getTarget().getName(),e.getArgs(),this.symbolTable,this.scope))}},{key:"visitReceive",value:function(e){this.symbolTable.fixMessage(e,Vr.getMessage(e.getFrom(),e.getReceiver().getName(),e.getTargets(),this.symbolTable,this.scope))}},{key:"visitDelete",value:function(e){e.getTarget().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitMove",value:function(e){e.getFrom().accept(new Fr(this.symbolTable,this.scope)),e.getTo().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitAwait",value:function(e){e.getExpression().accept(new Fr(this.symbolTable,this.scope))}},{key:"visitReturn",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(new Fr(this.symbolTable,this.scope))}},{key:"visitIf",value:function(e){var t,r=this,a=new ar(this.scope);e.getExpression().accept(new Fr(this.symbolTable,a)),e.getThen().accept(new n(this.symbolTable,a)),e.getElseIfs().forEach((function(e){return e.accept(new n(r.symbolTable,a))})),null===(t=e.getElse())||void 0===t||t.accept(new n(this.symbolTable,a))}},{key:"visitElseIf",value:function(e){var t=new ar(this.scope);e.getExpression().accept(new Fr(this.symbolTable,t)),e.getThen().accept(new n(this.symbolTable,t))}},{key:"visitWhile",value:function(e){var t=new ar(this.scope);e.getExpresssion().accept(new Fr(this.symbolTable,t)),e.getBody().accept(new n(this.symbolTable,t))}},{key:"visitRepeat",value:function(e){var t=new ar(this.scope);e.getExpresssion().accept(new Fr(this.symbolTable,t)),e.getBody().accept(new Fr(this.symbolTable,t))}},{key:"visitFor",value:function(e){var t,r=new ar(this.scope);if(e.getExpression().accept(new Fr(this.symbolTable,r)),!(e.getDesignator()instanceof _t))throw new Error("Only basic designators currently supported.");e.getDesignator().accept(new Fr(this.symbolTable,r)),e.getTo().accept(new Fr(this.symbolTable,r)),null===(t=e.getBy())||void 0===t||t.accept(new Fr(this.symbolTable,r)),e.getStatements().accept(new n(this.symbolTable,r))}},{key:"visitForeach",value:function(e){var t=this,r=new ar(this.scope);e.getOf().accept(new Fr(this.symbolTable,r));var a=this.findCollectionVariable(e.getOf());if(a.getParameters().length<e.getDesignators().length)throw new Error("Foreach designator match error.");e.getDesignators().forEach((function(e,n){if(!(e instanceof _t))throw new Error("Only basic designators supported.");t.symbolTable.registerVariable(new Or(t.scope,e.getName().getName(),!0,a.getParameters()[n])),e.accept(new Fr(t.symbolTable,r))})),e.getBody().accept(new n(this.symbolTable,r))}},{key:"visitStatementBlock",value:function(e){e.getStatements().accept(this)}}]),n}(Xn),Br=function(){function e(t,n){Object(s.a)(this,e),this.symbolTable=t,this.programScope=n}return Object(o.a)(e,[{key:"fix",value:function(e){e.accept(new Dr(this.symbolTable,this.programScope)),e.accept(new Ar(this.symbolTable,this.programScope))}}],[{key:"run",value:function(t,n,r){new e(t,r).fix(n)}}]),e}(),Vr=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"check",value:function(e,t){var n=new gr,r=new tr(n.getGlobalScope(),e);return Rr.run(n,t,r),Br.run(n,t,r),n}}],[{key:"checkNotConstantSymbol",value:function(e,t){try{t.getConstant(e)}catch(n){}}},{key:"getComponent",value:function(e,t,n,r,a){this.checkNotConstantSymbol(n,e);var i=e.findComponent(n,t,r,a);if(i.length>1)throw new Error("Component ".concat(n," defined ").concat(i.length," times in the same scope."));if(i.length<1)throw new Error("No component ".concat(n," found."));return i[0]}},{key:"getInterface",value:function(e,t,n,r,a){this.checkNotConstantSymbol(n,e);var i=e.findInterface(n,t,r,a);if(i.length>1)throw new Error("Interface ".concat(n," defined ").concat(i.length," times in the same scope."));if(i.length<1)throw new Error("No interface ".concat(n," found."));return i[0]}},{key:"getImplementation",value:function(e,t,n,r){if(this.checkNotConstantSymbol(n,e),!(t instanceof fr))throw new Error("Failed to locate ".concat(n,", must be inside a component."));var a=e.findImplementation(n,t,r);if(a.length>1)throw new Error("Implementaiton ".concat(n," defined ").concat(a.length," times in the same scope."));if(a.length<1)throw new Error("No implementation ".concat(n," found."));return a[0]}},{key:"getConstant",value:function(e,t){var n=e.findConstant(t);if(n.length>1)throw new Error("Found ".concat(t," multiple times."));if(n.length<1)throw new Error("Failed to find ".concat(t,"."));return n[0]}},{key:"getVariable",value:function(e,t,n,r){var a=e.findVariable(n,t,r);if(a.length>1)throw new Error("Found ".concat(n," multiple times."));if(a.length<1)throw new Error("Failed to find ".concat(n,"."));return a[0]}},{key:"getCollectionVariable",value:function(e,t,n){var r=e.findCollectionVariable(n,t,void 0,!1,!0);if(r.length>1)throw new Error("Found ".concat(n," multiple times."));if(r.length<1)throw new Error("Failed to find ".concat(n,"."));return r[0]}},{key:"getProcedureParam",value:function(e,t,n){for(;!(t instanceof xr)&&t instanceof nr;)t=t.getScope();if(!(t instanceof xr))throw new Error("".concat(n," is not a procedure parameter."));var r=this.getVariable(e,t,n,!1);if(!(r.getScope()instanceof xr))throw new Error("Found ".concat(n," outside procedure param."));return r}},{key:"getProcedure",value:function(e,t,n,r,a,i){this.checkNotConstantSymbol(e,t);var s=t.findProcedure(e,n,r,a,i);if(s.length>1)throw new Error("Procedure ".concat(e," defined ").concat(s.length," times in the same scope."));if(s.length<1)throw new Error("No procedure ".concat(e," found."));return s[0]}},{key:"getProcedureFromNode",value:function(t,n,r,a){var i=t.getName().getName();this.checkNotConstantSymbol(i,n);var s=n.getVoidType(),o=t.getType();if(void 0!==o){o.accept(new jr(n,r));var c=n.findTypeSymbol(o);if(void 0===c)throw new Error("Failed to find procedure ".concat(i," return type."));s=c}var u=e.convertParamTypes(n,r,t.getParams().map((function(e){return e.getParameter()})));return this.getProcedure(i,n,r,u,s,a)}},{key:"getTypeType",value:function(e,t){var n=e.findTypeSymbol(t);if(void 0===n)throw new Error("Type node type lookup failed.");return n}},{key:"convertParamTypes",value:function(e,t,n){var r=this;return n.flatMap((function(n){n.getType().accept(new jr(e,t));var a=r.getTypeType(e,n.getType());return n.getNames().map((function(){return a}))}))}},{key:"getMessageInImplentation",value:function(e,t,n,r){for(;!(n instanceof Tr);){if(n instanceof Jn)throw new Error("Failed message lookup for ".concat(e,"."));n=n.getScope()}var a=t.findMessage(e,n.getInterface(),r,!1);if(a.length>1)throw new Error("Ambiguous message lookup for ".concat(e,"."));if(a.length<1)throw new Error("Message lookup failed for ".concat(e,"."));return a[0]}},{key:"getMessage",value:function(e,t,n,r,a){var i=n.map((function(e){e.accept(new Fr(r,a));var t=r.findExpressionType(e);if(void 0===t)throw new Error("Failed argument type lookup.");return t}));if(null===e||void 0===e||e.accept(new Fr(r,a)),void 0!==e){var s=r.findExpressionType(e),o=new Array;if(s instanceof fr)o.push.apply(o,Object(u.a)(s.getGenericType().getOffered().map((function(e){return e.getInterface()})).flatMap((function(e){return r.findMessage(t,e,i,!1)}))));else{if(!(s instanceof lr))throw new Error("Failed interface lookup for ".concat(t,"."));o.push.apply(o,Object(u.a)(r.findMessage(t,s,i,!1)))}if(o.length>1)throw new Error("Ambigious message lookup for ".concat(t,"."));if(o.length<1)throw console.log(s),console.log(i),new Error("Message lookup failed for ".concat(t,"."));return o[0]}return this.getMessageInImplentation(t,r,a,i)}}]),e}(),Mr=n(0),qr=function(){function e(){Object(s.a)(this,e),this.targets=new Map,this.code=new Array}return Object(o.a)(e,[{key:"complete",value:function(){return this.fixLabels(),this.code}},{key:"createLabel",value:function(){return new Mr.k}},{key:"setLabel",value:function(e){this.targets.set(e,this.code.length)}},{key:"fixLabels",value:function(){var e=this;this.code=this.code.map((function(t,n){var r=t.getOperands();if(1===r.length&&r[0]instanceof Mr.k){var a=e.targets.get(r[0]);if(void 0===a)throw new Error("Unknown label.");var i=a-n-1;return new Mr.h(t.getOpCode(),new Mr.j(i))}return t}))}},{key:"emitLoadInteger",value:function(e){this.emit(Mr.l.LoadConstantInteger,new Mr.i(e))}},{key:"emitLoadFloat",value:function(e){this.emit(Mr.l.LoadConstantFloat,new Mr.e(e))}},{key:"emitLoadCharacter",value:function(e){this.emit(Mr.l.LoadConstantCharacter,new Mr.b(e))}},{key:"emitLoadText",value:function(e){this.emit(Mr.l.LoadConstantText,new Mr.p(e))}},{key:"emitLoadBoolean",value:function(e){this.emit(Mr.l.LoadConstantBoolean,new Mr.a(e))}},{key:"emitSysCall",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.emit.apply(this,[Mr.l.SysCall].concat(Object(u.a)(t.map((function(e){return new Mr.o(e)})))))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.code.push(Object(c.a)(Mr.h,[e].concat(n)))}}]),e}(),_r=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this)).symbols=e,i.scope=r,i.metadata=a,i.assembler=new qr,i}return Object(o.a)(n,[{key:"getInstructions",value:function(){return this.assembler.complete()}},{key:"visitBasicDesignator",value:function(e){var t=e.getName().getName(),n=this.symbols.findDesignatorSymbol(e);if(n instanceof cr&&n.getScope()===this.symbols.getGlobalScope())switch(t){case"FALSE":return void this.assembler.emitLoadBoolean(!1);case"TRUE":return void this.assembler.emitLoadBoolean(!0);case"PI":return void this.assembler.emitLoadFloat(Math.PI)}if(n instanceof Or){var r=n.getScope();if(r instanceof fr){var a=this.metadata.findComponent(r),i=this.metadata.findVariable(n);return void this.assembler.emit(Mr.l.LoadVariable,a.loadField(i))}throw Error("Global variables not yet supported.")}if(n instanceof lr)console.log("InterfaceSymbol not yet supported.");else{if(!(n instanceof wr))throw console.dir(n,{depth:null}),Error("Unsupported BasicDesignatorNode ".concat(t));console.log("CollectionVariableSymbol not yet supported.")}}},{key:"visitBaseTargetDesignator",value:function(e){var t=this.symbols.findDesignatorSymbol(e);if(void 0===t)throw new Error("Failed base target designator node lookup.");e.getTarget().accept(this),t instanceof xr?this.handleCall(t):e.getBase().accept(this)}},{key:"visitAttribute",value:function(e){switch(e.getName().getName()){case"SHARED":this.assembler.emit(Mr.l.AcquireShared);break;case"EXCLUSIVE":this.assembler.emit(Mr.l.AcquireExclusive)}}},{key:"handleLockRelease",value:function(e){switch(e.getName().getName()){case"SHARED":this.assembler.emit(Mr.l.ReleaseShared);break;case"EXCLUSIVE":this.assembler.emit(Mr.l.ReleaseExclusive)}}},{key:"visitStatementSequence",value:function(e){var t=this;e.getAttributes().forEach((function(e){return e.accept(t)})),e.getStatements().forEach((function(e){return e.accept(t)})),e.getAttributes().forEach((function(e){return t.handleLockRelease(e)}))}},{key:"handleSystemCall",value:function(e){var t=e.getIdentifier();if(e.getScope()!==this.symbols.getGlobalScope())return!1;if(0===e.getParameters().length)switch(t){case"WRITELINE":return this.assembler.emitSysCall(Mr.n.WriteLine),!0}if(1===e.getParameters().length)switch(t){case"ASSERT":return this.assembler.emitSysCall(Mr.n.Assert1),!0;case"HALT":return this.assembler.emitSysCall(Mr.n.Halt),!0;case"INC":return this.assembler.emitSysCall(Mr.n.Inc1),!0;case"DEC":return this.assembler.emitSysCall(Mr.n.Inc2),!0;case"PASSIVATE":return this.assembler.emitSysCall(Mr.n.Passivate),!0;case"WRITE":return this.assembler.emitSysCall(Mr.n.Write),!0;case"WRITEHEX":return this.assembler.emitSysCall(Mr.n.WriteHex),!0;case"COUNT":return this.assembler.emitSysCall(Mr.n.Count),!0;case"LENGTH":return this.assembler.emitSysCall(Mr.n.Length),!0;case"SQRT":return this.assembler.emitSysCall(Mr.n.Sqrt),!0;case"SIN":return this.assembler.emitSysCall(Mr.n.Sin),!0;case"COS":return this.assembler.emitSysCall(Mr.n.Cos),!0;case"TAN":return this.assembler.emitSysCall(Mr.n.Tan),!0;case"ARCSIN":return this.assembler.emitSysCall(Mr.n.ArcSin),!0;case"ARCCOS":return this.assembler.emitSysCall(Mr.n.ArcCos),!0;case"ARCTAN":return this.assembler.emitSysCall(Mr.n.ArcTan),!0;case"MIN":return this.assembler.emitSysCall(Mr.n.Min),!0;case"MAX":return this.assembler.emitSysCall(Mr.n.Max),!0;case"CHARACTER":return this.assembler.emitSysCall(Mr.n.ToCharacter),!0;case"INTEGER":return this.assembler.emitSysCall(Mr.n.ToInteger),!0;case"REAL":return this.assembler.emitSysCall(Mr.n.ToReal),!0;case"TEXT":return this.assembler.emitSysCall(Mr.n.ToText),!0}if(2===e.getParameters().length)switch(t){case"ASSERT":return this.assembler.emitSysCall(Mr.n.Assert2),!0;case"INC":return this.assembler.emitSysCall(Mr.n.Inc2),!0;case"DEC":return this.assembler.emitSysCall(Mr.n.Dec2),!0;case"RANDOM":return this.assembler.emitSysCall(Mr.n.Random),!0}return!1}},{key:"handleCall",value:function(e){this.handleSystemCall(e)||this.assembler.emit(Mr.l.ProcedureCall,this.metadata.findProcedure(e))}},{key:"visitProcedureCall",value:function(e){var t=this;e.getParams().forEach((function(e){e.accept(t)})),this.handleCall(this.symbols.getCallProcedure(e))}},{key:"visitAssignment",value:function(e){e.getDesignator().accept(this),e.getExpression().accept(this),this.assembler.emit(Mr.l.StoreVariable)}},{key:"visitNew",value:function(e){var t=this;e.getDesignator().accept(this),e.getArgs().forEach((function(e){return e.accept(t)})),this.assembler.emit(Mr.l.New)}},{key:"visitConnect",value:function(e){e.getWhat().accept(this),e.getTo().accept(this),this.assembler.emit(Mr.l.Connect)}},{key:"visitDisconnect",value:function(e){e.getWhat().accept(this),this.assembler.emit(Mr.l.Disconnect)}},{key:"visitSend",value:function(e){var t,n,r=this;e.getArgs().forEach((function(e){return e.accept(r)})),null!==(t=null===(n=e.getFrom())||void 0===n?void 0:n.accept(this))&&void 0!==t||this.assembler.emit(Mr.l.LoadThis),this.assembler.emit(Mr.l.Send)}},{key:"visitReceive",value:function(e){var t,n,r=this;e.getTargets().forEach((function(e){return e.accept(r)})),null!==(t=null===(n=e.getFrom())||void 0===n?void 0:n.accept(this))&&void 0!==t||this.assembler.emit(Mr.l.LoadThis),this.assembler.emit(Mr.l.Receive)}},{key:"visitDelete",value:function(e){e.getTarget().accept(this),this.assembler.emit(Mr.l.Delete)}},{key:"visitMove",value:function(e){e.getFrom().accept(this),e.getTo().accept(this),this.assembler.emit(Mr.l.Move)}},{key:"visitAwait",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),e.getExpression().accept(this),this.assembler.emit(Mr.l.BranchFalse,n),this.assembler.emit(Mr.l.Branch,t),this.assembler.setLabel(n)}},{key:"visitReturn",value:function(e){var t;null===(t=e.getExpression())||void 0===t||t.accept(this),this.assembler.emit(Mr.l.Return)}},{key:"visitIf",value:function(e){var t,n=this,r=this.assembler.createLabel(),a=e.getElseIfs().map((function(){return n.assembler.createLabel()})),i=this.assembler.createLabel();(e.getExpression().accept(this),e.getElseIfs().length>0&&(this.assembler.emit(Mr.l.BranchFalse,a[0]),e.getThen().accept(this),e.getElseIfs().forEach((function(t,s){n.assembler.emit(Mr.l.Branch,r),n.assembler.setLabel(a[s]),t.getExpression().accept(n),n.assembler.emit(Mr.l.BranchFalse,s+1<e.getElseIfs().length?a[s+1]:void 0!==e.getElse()?i:r),t.getThen().accept(n)}))),void 0!==e.getElse())&&(this.assembler.emit(Mr.l.BranchFalse,i),e.getThen().accept(this),this.assembler.emit(Mr.l.Branch,r),this.assembler.setLabel(i),null===(t=e.getElse())||void 0===t||t.accept(this));0===e.getElseIfs().length&&void 0===e.getElse()&&(this.assembler.emit(Mr.l.BranchFalse,r),e.getThen().accept(this)),this.assembler.setLabel(r)}},{key:"visitWhile",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),e.getExpresssion().accept(this),this.assembler.emit(Mr.l.BranchFalse,n),e.getBody().accept(this),this.assembler.emit(Mr.l.Branch,t),this.assembler.setLabel(n)}},{key:"visitRepeat",value:function(e){var t=this.assembler.createLabel(),n=this.assembler.createLabel();this.assembler.setLabel(t),e.getBody().accept(this),e.getExpresssion().accept(this),this.assembler.emit(Mr.l.BranchFalse,n),this.assembler.emit(Mr.l.Branch,t),this.assembler.setLabel(n)}},{key:"visitFor",value:function(e){var t;e.getDesignator().accept(this),e.getExpression().accept(this),e.getTo().accept(this),null===(t=e.getBy())||void 0===t||t.accept(this),e.getStatements().accept(this)}},{key:"visitForeach",value:function(e){var t=this;e.getDesignators().forEach((function(e){return e.accept(t)})),e.getOf().accept(this),e.getBody().accept(this)}},{key:"visitStatementBlock",value:function(e){e.getStatements().accept(this)}},{key:"visitUnaryExpression",value:function(e){e.getExpression().accept(this)}},{key:"visitBinaryExpression",value:function(e){switch(e.getLeft().accept(this),e.getRight().accept(this),e.getOp()){case Ze.Equal:this.assembler.emit(Mr.l.Equal);break;case Ze.Less:this.assembler.emit(Mr.l.Less);break;case Ze.LessEqual:this.assembler.emit(Mr.l.LessEqual);break;case Ze.More:this.assembler.emit(Mr.l.Greater);break;case Ze.MoreEqual:this.assembler.emit(Mr.l.GreaterEqual);break;case Ze.NotEqual:this.assembler.emit(Mr.l.NotEqual)}}},{key:"visitTypeCheck",value:function(e){e.getDesignator().accept(this),e.getType().accept(this),this.assembler.emit(Mr.l.IsType)}},{key:"visitUnaryTermNode",value:function(e){switch(e.getTerm().accept(this),e.getOp()){case st.Minus:this.assembler.emit(Mr.l.Negate)}}},{key:"visitTermChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}))}},{key:"visitRightTerm",value:function(e){switch(e.getRight().accept(this),e.getOp()){case ct.Minus:this.assembler.emit(Mr.l.Subtract);break;case ct.Or:this.assembler.emit(Mr.l.LogicOr);break;case ct.Plus:this.assembler.emit(Mr.l.Add)}}},{key:"visitFactorChain",value:function(e){var t=this;e.getLeft().accept(this),e.getRight().forEach((function(e){return e.accept(t)}))}},{key:"visitRightFactor",value:function(e){switch(e.getRight().accept(this),e.getOp()){case pt.AndText:this.assembler.emit(Mr.l.Add);break;case pt.Div:case pt.DivText:this.assembler.emit(Mr.l.Divide);break;case pt.Times:this.assembler.emit(Mr.l.Multiply);break;case pt.ModText:this.assembler.emit(Mr.l.Modulo)}}},{key:"visitUnaryFactor",value:function(e){switch(e.getFactor().accept(this),e.getPrefix()){case mt.Not:this.assembler.emit(Mr.l.Not)}}},{key:"visitExpressionFactor",value:function(e){e.getExpression().accept(this)}},{key:"visitIntegerNumber",value:function(e){this.assembler.emitLoadInteger(e.getValue())}},{key:"visitRealNumber",value:function(e){this.assembler.emitLoadFloat(e.getValue())}},{key:"visitConstantCharacter",value:function(e){this.assembler.emitLoadCharacter(e.getCharacter())}},{key:"visitText",value:function(e){this.assembler.emitLoadText(e.getText())}},{key:"visitReceiveTest",value:function(e){var t;null===(t=e.getDesignator())||void 0===t||t.accept(this);e.getPattern();this.assembler.emit(Mr.l.CheckReceive)}},{key:"visitFunctionCall",value:function(e){var t=this;e.getArguments().forEach((function(e){return e.accept(t)})),this.handleCall(this.symbols.getCallProcedure(e))}}]),n}(Xn),Gr=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this)).symbol=e,i.metadata=r,i.symbols=a,i}return Object(o.a)(n,[{key:"visitComponentBody",value:function(e){var t,n,r,a,i,s,o=this.metadata.findComponent(this.symbol),c=new _r(this.symbols,this.symbol,this.metadata);null===(t=e.getBeginBlock())||void 0===t||t.accept(c),(n=o.getBeginCode().getInstructions()).push.apply(n,Object(u.a)(c.getInstructions())),c=new _r(this.symbols,this.symbol,this.metadata),null===(r=e.getActivityBlock())||void 0===r||r.accept(c),(a=o.getActivityCode().getInstructions()).push.apply(a,Object(u.a)(c.getInstructions())),c=new _r(this.symbols,this.symbol,this.metadata),null===(i=e.getFinallyBlock())||void 0===i||i.accept(c),(s=o.getFinallyCode().getInstructions()).push.apply(s,Object(u.a)(c.getInstructions()))}}]),n}(Xn),Ur=function(){function e(){Object(s.a)(this,e),this.componentMapping=new Map,this.implementationMapping=new Map,this.procedureMapping=new Map,this.variableToIndex=new Map,this.globalDescriptor=new Mr.d("@@__GLOBAL_COMPONENT__@@")}return Object(o.a)(e,[{key:"getGlobalComponent",value:function(){return this.globalDescriptor}},{key:"pushComponent",value:function(e,t){this.componentMapping.set(e,t)}},{key:"findComponent",value:function(e){var t=this.componentMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Component Mapping.");return t}},{key:"pushImplementation",value:function(e,t){this.implementationMapping.set(e,t)}},{key:"findImplementation",value:function(e){var t=this.implementationMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Component Mapping.");return t}},{key:"pushProcedure",value:function(e,t){this.procedureMapping.set(e,t)}},{key:"findProcedure",value:function(e){var t=this.procedureMapping.get(e);if(void 0===t)throw new Error("Unkknown Symbol <-> Component Mapping.");return t}},{key:"pushVariable",value:function(e,t){this.variableToIndex.set(e,t)}},{key:"findVariable",value:function(e){var t=this.variableToIndex.get(e);if(void 0===t)throw console.dir(e,{depth:null}),console.dir(this.variableToIndex,{depth:null}),new Error("Unkknown Variable <-> Index Mapping.");return t}}]),e}(),Wr=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"generate",value:function(e){var t=this,n=new Mr.f,r=this.generateMetadata(e);return e.getComponents().forEach((function(a){return t.generateComponent(a,e,n,r)})),n}},{key:"generateMetadata",value:function(e){var t=new Ur;return e.getSystemProcedures().forEach((function(e){return t.pushProcedure(e,new Mr.m(e.getIdentifier(),t.getGlobalComponent(),new Array(e.getParameters().length)))})),e.getComponents().forEach((function(n){var r=new Mr.d(n.getIdentifier());t.pushComponent(n,r),e.getVariables(n).forEach((function(e){var n=e.getIdentifier(),a=e instanceof wr?new Mr.c(n):new Mr.q(n),i=r.pushField(a);t.pushVariable(e,i)})),e.getImplementations(n).forEach((function(e){return t.pushImplementation(e,new Mr.g(e.getInterface().getIdentifier(),r))})),e.getProcedures(n).forEach((function(e){return t.pushProcedure(e,new Mr.m(e.getIdentifier(),r,new Array(e.getParameters().length)))}))})),t}},{key:"generateComponent",value:function(e,t,n,r){var a,i=t.findDeclarationNode(e);if(void 0===i||!(i instanceof He))throw new Error("Failed node lookup for component ".concat(e.getIdentifier()));null===(a=i.getBody())||void 0===a||a.accept(new Gr(e,r,t));var s=r.findComponent(e);n.pushComponent(s),this.isEntryPoint(e)&&n.pushEntry(s)}},{key:"isEntryPoint",value:function(e){var t=this;if(!(e.getScope()instanceof tr))return!1;var n=e.getGenericType().getRequired();return 0===n.length||n.map((function(e){return t.isSystemInterface(e.getInterface().getIdentifier())})).reduce((function(e,t){return e&&t}),!0)}},{key:"isSystemInterface",value:function(e){switch(e){case"SystemTime":case"FileSystem":case"GraphicView":return!0;default:return!1}}}]),e}(),Hr=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,[{key:"compile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,o,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new De,i=new Me(r,t,n),s=new Yn(r,i),o=s.parse(),!r.hasErrors()){e.next=7;break}throw r.print(console.log),new Error("Error during Lexing and/or Parsing. See console.log.");case 7:return c=new Vr,u=c.check(t,o),l=new Wr,e.abrupt("return",l.generate(u));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Qr=n(11),Xr=self,zr=!1;function Yr(e){zr=e,Xr.postMessage({output:"",running:zr})}function Kr(e){zr=!1,Xr.postMessage({output:"\n!!! ".concat(e," !!!\n\n"),running:zr})}var $r=new(function(){function e(t,n){Object(s.a)(this,e),this.out=t,this.runningUpdate=n,this.compiler=new Hr}return Object(o.a)(e,[{key:"run",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qr.a.getInstance().reset(),Qr.a.getInstance().changeOutput(this.out),Qr.a.getInstance().isRunningUpdate(this.runningUpdate),e.next=5,this.compiler.compile(t,n);case 5:return r=e.sent,e.next=8,Qr.a.getInstance().execute(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qr.a.getInstance().reset();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}())(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){void 0!==e&&Xr.postMessage({output:e,running:zr})}))}.bind(Xr),Yr.bind(Xr));Xr.onmessage=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("run"!==t.data.fn){e.next=10;break}return e.prev=1,Yr(!0),e.next=5,$r.run(t.data.uri,t.data.code);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Kr(e.t0.message);case 10:if("stop"!==t.data.fn){e.next=19;break}return e.prev=11,e.next=14,$r.stop();case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(11),Kr(e.t1.message);case 19:case"end":return e.stop()}}),e,null,[[1,7],[11,16]])})));return function(t){return e.apply(this,arguments)}}();t.default=Xr}]);
//# sourceMappingURL=system.worker.330edea8.worker.js.map